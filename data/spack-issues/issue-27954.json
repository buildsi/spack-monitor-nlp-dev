{
    "body": "### Steps to reproduce the issue\r\n\r\n`ascent@0.7.1 +cuda cuda_arch=80` build fails during cmake phase:\r\n\r\nUsing:\r\n* `spack@develop` (98c3cbda9cb7714ca02ec575a1cd3640884fa71b from `Fri Dec 10 15:35:09 2021 -0800`)\r\n* Ubuntu 20.04, GCC 9.3.0, X86_64\r\n* CUDA 11.5.1\r\n\r\n**Concrete spec:** [ascent.spec.json.txt](https://github.com/spack/spack/files/7704808/ascent.spec.json.txt)\r\n\r\n**Concretization**\r\n```\r\nascent@0.7.1%gcc@9.3.0~adios~adios2~babelflow+cuda~doc~dray~fides+fortran~ipo~mfem+mpi+openmp~python+serial~shared+test+vtkh build_type=RelWithDebInfo cuda_arch=80 arch=linux-ubuntu20.04-x86_64\r\n    ^cmake@3.21.4%gcc@9.3.0~doc+ncurses+openssl+ownlibs~qt build_type=Release arch=linux-ubuntu20.04-x86_64\r\n        ^ncurses@6.2%gcc@9.3.0~symlinks+termlib abi=none arch=linux-ubuntu20.04-x86_64\r\n            ^pkgconf@1.8.0%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n        ^openssl@1.1.1l%gcc@9.3.0~docs certs=system arch=linux-ubuntu20.04-x86_64\r\n            ^perl@5.34.0%gcc@9.3.0+cpanm+shared+threads arch=linux-ubuntu20.04-x86_64\r\n                ^berkeley-db@18.1.40%gcc@9.3.0+cxx~docs+stl patches=b231fcc4d5cff05e5c3a4814f6a5af0e9a966428dc2176540d2c05aff41de522 arch=linux-ubuntu20.04-x86_64\r\n                ^bzip2@1.0.8%gcc@9.3.0~debug~pic+shared arch=linux-ubuntu20.04-x86_64\r\n                    ^diffutils@3.8%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n                        ^libiconv@1.16%gcc@9.3.0 libs=shared,static arch=linux-ubuntu20.04-x86_64\r\n                ^gdbm@1.19%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n                    ^readline@8.1%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n                ^zlib@1.2.11%gcc@9.3.0+optimize+pic+shared arch=linux-ubuntu20.04-x86_64\r\n    ^conduit@0.7.2%gcc@9.3.0~adios~doc~doxygen+fortran+hdf5+hdf5_compat~ipo+mpi~parmetis~python+shared~silo+test~zfp build_type=RelWithDebInfo patches=89d1829ad52f503f6179e43efddf998c239a95c14ca1f248463a3f61ad7d5cf7 arch=linux-ubuntu20.04-x86_64\r\n        ^hdf5@1.8.22%gcc@9.3.0~cxx+fortran+hl~ipo~java+mpi+shared~szip~threadsafe+tools api=v18 build_type=RelWithDebInfo arch=linux-ubuntu20.04-x86_64\r\n            ^mpich@3.4.2%gcc@9.3.0~argobots+fortran+hwloc+hydra+libxml2+pci+romio~slurm~two_level_namespace~verbs~wrapperrpath device=ch4 netmod=ofi pmi=pmi arch=linux-ubuntu20.04-x86_64\r\n                ^findutils@4.8.0%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n                ^hwloc@2.6.0%gcc@9.3.0~cairo~cuda~gl~libudev+libxml2~netloc~nvml~opencl+pci~rocm+shared arch=linux-ubuntu20.04-x86_64\r\n                    ^libpciaccess@0.16%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n                        ^libtool@2.4.6%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n                            ^m4@1.4.19%gcc@9.3.0+sigsegv patches=9dc5fbd0d5cb1037ab1e6d0ecc74a30df218d0a94bdd5a02759a97f62daca573,bfdffa7c2eb01021d5849b36972c069693654ad826c1a20b53534009a4ec7a89 arch=linux-ubuntu20.04-x86_64\r\n                                ^libsigsegv@2.13%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n                        ^util-macros@1.19.3%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n                    ^libxml2@2.9.12%gcc@9.3.0~python arch=linux-ubuntu20.04-x86_64\r\n                        ^xz@5.2.5%gcc@9.3.0+pic libs=shared,static arch=linux-ubuntu20.04-x86_64\r\n                ^libfabric@1.14.0%gcc@9.3.0~debug~kdreg fabrics=rxm,sockets,tcp,udp arch=linux-ubuntu20.04-x86_64\r\n            ^numactl@2.0.14%gcc@9.3.0 patches=4e1d78cbbb85de625bad28705e748856033eaafab92a66dffd383a3d7e00cc94,62fc8a8bf7665a60e8f4c93ebbd535647cebf74198f7afafec4c085a8825c006,ff37630df599cfabf0740518b91ec8daaf18e8f288b19adaae5364dc1f6b2296 arch=linux-ubuntu20.04-x86_64\r\n                ^autoconf@2.69%gcc@9.3.0 patches=35c449281546376449766f92d49fc121ca50e330e60fefcfc9be2af3253082c2,7793209b33013dc0f81208718c68440c5aae80e7a1c4b8d336e382525af791a7,a49dd5bac3b62daa0ff688ab4d508d71dbd2f4f8d7e2a02321926346161bf3ee arch=linux-ubuntu20.04-x86_64\r\n                ^automake@1.16.3%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n    ^cuda@11.5.1%gcc@9.3.0~dev arch=linux-ubuntu20.04-x86_64\r\n    ^vtk-h@0.7.1%gcc@9.3.0~contourtree+cuda~logging+mpi+openmp+serial~shared cuda_arch=80 arch=linux-ubuntu20.04-x86_64\r\n        ^vtk-m@1.6.0%gcc@9.3.0~64bitids+ascent_types+cuda+doubleprecision~hip~ipo~logging+mpi+openmp+rendering~shared~tbb~virtuals amdgpu_target=none build_type=Release cuda_arch=80 arch=linux-ubuntu20.04-x86_64\r\n```\r\n\r\n**Install**\r\n```\r\n$> spack install -f ./ascent.spec.json\r\n...\r\n==> Installing ascent-0.7.1-p35jlljuds2dsr73nanqgfdz63dbyxrp\r\n==> No binary for ascent-0.7.1-p35jlljuds2dsr73nanqgfdz63dbyxrp found: installing from source\r\n==> No patches needed for ascent\r\n==> ascent: Executing phase: 'hostconfig'\r\n==> ascent: Executing phase: 'cmake'\r\n==> Error: ProcessError: Command exited with status 1:\r\n    'cmake' '-G' 'Unix Makefiles' '-DCMAKE_INSTALL_PREFIX:STRING=/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/ascent-0.7.1-p35jlljuds2dsr73nanqgfdz63dbyxrp' '-DCMAKE_BUILD_TYPE:STRING=RelWithDebInfo' '-DCMAKE_INTERPROCEDURAL_OPTIMIZATION:BOOL=OFF' '-DCMAKE_VERBOSE_MAKEFILE:BOOL=ON' '-DCMAKE_INSTALL_RPATH_USE_LINK_PATH:BOOL=OFF' '-DCMAKE_INSTALL_RPATH:STRING=/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/ascent-0.7.1-p35jlljuds2dsr73nanqgfdz63dbyxrp/lib;/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/ascent-0.7.1-p35jlljuds2dsr73nanqgfdz63dbyxrp/lib64;/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/conduit-0.7.2-7fynwd6a5kett2mkqnw3n2pcyjh37ivc/lib;/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/hdf5-1.8.22-tw37vr7cr2i7ngaxenqmsllb7lklwkbn/lib;/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/mpich-3.4.2-da2intlyhnltoebtrcvfl7qeffmwwzp6/lib;/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/hwloc-2.6.0-bivhc36xulak7wjqfzshvzhioqs3ki77/lib;/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/libpciaccess-0.16-4jbn7mznw664dc4mlseouzovsfx6sor5/lib;/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/libxml2-2.9.12-xlbi5rk675mptoyjnuff4q3e2lajs2wr/lib;/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/libiconv-1.16-zth4ohvj7y3p532iqjw7fptg3kkn3ixv/lib;/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/xz-5.2.5-mq4ikt5q4zttamuxqkqe66jlftjbvkf4/lib;/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/zlib-1.2.11-ufqpqnpj5gjkfx5sd2o3twwveuowcz2b/lib;/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/ncurses-6.2-nxjjphalwbf2ywlxpn74nsfcsrq2bbtd/lib;/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/libfabric-1.14.0-ohufqpc3kq5sd32tcn2pp3t636knmxxd/lib;/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/numactl-2.0.14-e3evcwcbrfcfnv4j2h55y6n6dciu37wi/lib;/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/vtk-h-0.7.1-gft4xh6nmiqaso27gapxbkepgdtdwov4/lib;/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/vtk-m-1.6.0-bw4uneohn2lqe3j36pjsju6fuqwseg2h/lib;/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/cuda-11.5.1-7zovxzh23daik22jdh4kb5l4gobp5ojt/lib64' '-DCMAKE_PREFIX_PATH:STRING=/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/vtk-h-0.7.1-gft4xh6nmiqaso27gapxbkepgdtdwov4;/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/vtk-m-1.6.0-bw4uneohn2lqe3j36pjsju6fuqwseg2h;/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/cuda-11.5.1-7zovxzh23daik22jdh4kb5l4gobp5ojt;/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/conduit-0.7.2-7fynwd6a5kett2mkqnw3n2pcyjh37ivc;/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/hdf5-1.8.22-tw37vr7cr2i7ngaxenqmsllb7lklwkbn;/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/numactl-2.0.14-e3evcwcbrfcfnv4j2h55y6n6dciu37wi;/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/mpich-3.4.2-da2intlyhnltoebtrcvfl7qeffmwwzp6;/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/libfabric-1.14.0-ohufqpc3kq5sd32tcn2pp3t636knmxxd;/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/hwloc-2.6.0-bivhc36xulak7wjqfzshvzhioqs3ki77;/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/libxml2-2.9.12-xlbi5rk675mptoyjnuff4q3e2lajs2wr;/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/xz-5.2.5-mq4ikt5q4zttamuxqkqe66jlftjbvkf4;/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/libpciaccess-0.16-4jbn7mznw664dc4mlseouzovsfx6sor5;/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/cmake-3.21.4-55vqjfj2bk55ga4fj3erj5tpzugh3t3b;/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/zlib-1.2.11-ufqpqnpj5gjkfx5sd2o3twwveuowcz2b;/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/libiconv-1.16-zth4ohvj7y3p532iqjw7fptg3kkn3ixv;/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/ncurses-6.2-nxjjphalwbf2ywlxpn74nsfcsrq2bbtd' '-C' '/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/ascent-0.7.1-p35jlljuds2dsr73nanqgfdz63dbyxrp/aa27eb0bff37-linux-ubuntu20.04-x86_64-gcc@9.3.0-ascent-p35jlljuds2dsr73nanqgfdz63dbyxrp.cmake' '../spack-src/src/' '/tmp/root/spack-stage/spack-stage-ascent-0.7.1-p35jlljuds2dsr73nanqgfdz63dbyxrp/spack-src'\r\n\r\n2 errors found in build log:\r\n     170    -- Looking for VTKm using VTKM_DIR = /spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/vtk-m-1.6.0-bw4uneohn2lqe3j36pjsju6fuqwseg2h\r\n     171    -- Looking for VTKh using VTKH_DIR = /spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/vtk-h-0.7.1-gft4xh6nmiqaso27gapxbkepgdtdwov4\r\n     172    -- VTKh using provided path  VTKM_DIR: /spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/vtk-m-1.6.0-bw4uneohn2lqe3j36pjsju6fuqwseg2h\r\n     173    -- Found VTKh include dirs: /spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/vtk-h-0.7.1-gft4xh6nmiqaso27gapxbkepgdtdwov4/include\r\n     174    -- Looking for HDF5 using HDF5_DIR = /spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/hdf5-1.8.22-tw37vr7cr2i7ngaxenqmsllb7lklwkbn\r\n     175    -- Tests are enabled (ENABLE_TESTS=ON)\r\n  >> 176    CMake Error at cmake/VTKmDeviceSymbols.cmake:27 (get_target_property):\r\n     177      get_target_property() called with non-existent target \"vtkmdiympi_nompi\".\r\n     178    Call Stack (most recent call first):\r\n     179      ascent/CMakeLists.txt:339 (source_objects)\r\n     180\r\n     181\r\n  >> 182    CMake Error at cmake/VTKmDeviceSymbols.cmake:27 (get_target_property):\r\n     183      get_target_property() called with non-existent target \"vtkmdiympi_nompi\".\r\n     184    Call Stack (most recent call first):\r\n     185      ascent/CMakeLists.txt:463 (source_objects)\r\n     186\r\n     187\r\n     188    -- Adding vtk-h lib unit tests\r\n```\r\n\r\n### Information on your system\r\n\r\n* **Spack:** 0.17.0-477-98c3cbda9c\r\n* **Python:** 3.8.10\r\n* **Platform:** linux-ubuntu20.04-cascadelake\r\n* **Concretizer:** clingo\r\n\r\n### Additional information\r\n\r\n[spack-build-env.txt](https://github.com/spack/spack/files/7704827/spack-build-env.txt)\r\n[spack-build-out.txt](https://github.com/spack/spack/files/7704828/spack-build-out.txt)\r\n[spack-build-02-cmake-out.txt](https://github.com/spack/spack/files/7704836/spack-build-02-cmake-out.txt)\r\n\r\n@cyrush\r\n\r\n### General information\r\n\r\n- [X] I have run `spack debug report` and reported the version of Spack/Python/Platform\r\n- [X] I have run `spack maintainers <name-of-the-package>` and **@mentioned** any maintainers\r\n- [X] I have uploaded the build log and environment files\r\n- [X] I have searched the issues of this repo and believe this is not a duplicate",
    "user": "eugeneswalker",
    "url": "https://api.github.com/repos/spack/spack/issues/27954",
    "updated_at": "2021-12-13 16:05:14",
    "created_at": "2021-12-13 15:20:15",
    "closed_at": "None",
    "state": "open",
    "title": "ascent +cuda build fails: VTKmDeviceSymbols.cmake:27: get_target_property() called with non-existent target \"vtkmdiympi_nompi\"",
    "number": 27954,
    "milestone": null,
    "labels": [
        "build-error",
        "cuda",
        "e4s"
    ],
    "id": 1078658600,
    "html_url": "https://github.com/spack/spack/issues/27954",
    "assignees": [],
    "comments": 0
}