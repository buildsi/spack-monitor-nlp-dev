{
    "body": "\r\nOn my Fedora 27 system, `spack install py-matplotlib` from a clean Spack clone fails. Spack installs all the Matplotlib dependencies, but then `py-matplotlib` itself fails during its build phase.\r\n\r\nIt looks like Matplotlib is failing to find FreeType, even though this package was installed.\r\n\r\n### Expected Result\r\n\r\n`py-matplotlib` is installed.\r\n\r\n### Actual Result\r\n\r\nBuild log:\r\n```\r\n==> Executing phase: 'build'\r\n==> '/home/francois/spack/opt/spack/linux-fedora27-x86_64/gcc-7.3.1/python-2.7.14-belgizkwgkpujlt5kj2ukdfemba65kpf/bin/python2.7' '-s' 'setup.py' '--no-user-cfg' 'build'\r\n============================================================================\r\nEdit setup.cfg to change the build options\r\n\r\nBUILDING MATPLOTLIB\r\n            matplotlib: yes [2.2.2]\r\n                python: yes [2.7.14 (default, Apr 20 2018, 18:36:46)  [GCC\r\n                        7.3.1 20180303 (Red Hat 7.3.1-5)]]\r\n              platform: yes [linux2]\r\n\r\nREQUIRED DEPENDENCIES AND EXTENSIONS\r\n                 numpy: yes [version 1.13.3]\r\n      install_requires: yes [handled by setuptools]\r\n                libagg: yes [pkg-config information for 'libagg' could not\r\n                        be found. Using local copy.]\r\n              freetype: no  [The C/C++ header for freetype2 (ft2build.h)\r\n                        could not be found.  You may need to install the\r\n                        development package.]\r\n                   png: yes [version 1.6.34]\r\n                 qhull: yes [pkg-config information for 'libqhull' could not\r\n                        be found. Using local copy.]\r\n\r\nOPTIONAL SUBPACKAGES\r\n           sample_data: yes [installing]\r\n              toolkits: yes [installing]\r\n                 tests: no  [skipping due to configuration]\r\n        toolkits_tests: no  [skipping due to configuration]\r\n\r\nOPTIONAL BACKEND EXTENSIONS\r\n                macosx: no  [Mac OS-X only]\r\n                qt5agg: no  [PySide2 not found; PyQt5 not found]\r\n                qt4agg: no  [PySide not found; PyQt4 not found]\r\n               gtk3agg: no  [Requires pygobject to be installed.]\r\n             gtk3cairo: no  [Requires cairocffi or pycairo to be installed.]\r\n                gtkagg: no  [Requires pygtk]\r\n                 tkagg: yes [installing; run-time loading from Python Tcl /\r\n                        Tk]\r\n                 wxagg: no  [requires wxPython]\r\n                   gtk: no  [Requires pygtk]\r\n                   agg: yes [installing]\r\n                 cairo: no  [cairocffi or pycairo not found]\r\n             windowing: no  [Microsoft Windows only]\r\n\r\nOPTIONAL LATEX DEPENDENCIES\r\n                dvipng: yes [version 1.15]\r\n           ghostscript: yes [version 9.22]\r\n                 latex: yes [version 3.14159265]\r\n               pdftops: yes [version 0.57.0]\r\n\r\nOPTIONAL PACKAGE DATA\r\n                  dlls: no  [skipping due to configuration]\r\n\r\n============================================================================\r\n                        * The following required packages can not be built:\r\n                        * freetype\r\n                        * Try installing freetype with `dnf install\r\n                        * freetype-devel` and pkg-config with `dnf install\r\n                        * pkg-config`\r\n```\r\n\r\n### Steps to reproduce the issue\r\n\r\n```console\r\n$ git clone https://github.com/llnl/spack.git\r\n$ spack/bin/spack install py-matplotlib\r\n```\r\n\r\nThis is using today's `develop`, i.e. c8e3c94c6\r\n\r\n### Information on your system\r\n\r\n 1. `$ spack arch` reports `linux-fedora27-x86_64`\r\n 2. `packages.yaml` sets the default compiler to `gcc`, BLAS/LAPACK to `openblas`, OpenSSL to system\r\n 3. The system's package manager provides `freetype-devel`.",
    "user": "fmahebert",
    "url": "https://api.github.com/repos/spack/spack/issues/7855",
    "updated_at": "2019-02-13 23:38:15",
    "created_at": "2018-04-21 02:52:26",
    "closed_at": "2019-02-13 23:38:15",
    "state": "closed",
    "title": "py-matplotlib build fails on Fedora",
    "number": 7855,
    "milestone": null,
    "labels": [
        "build-error"
    ],
    "id": 316455448,
    "html_url": "https://github.com/spack/spack/issues/7855",
    "assignees": [
        "scheibelp"
    ],
    "comments": 26
}