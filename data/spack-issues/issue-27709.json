{
    "body": "@rscohn2\r\n\r\n### Steps to reproduce the issue\r\n\r\nsummary:\r\n`spack install curl@7.80.0 %intel@2021.4.0`\r\n\r\ndetailed:\r\n```\r\n(base) [myoder96@sh03-05n69 /scratch/users/myoder96/spack_dev/base] (job 39691869) $ spack env create curl2\r\n==> Updating view at /scratch/users/myoder96/spack_dev/base/spack/var/spack/environments/curl2/.spack-env/view\r\n==> Created environment 'curl2' in /scratch/users/myoder96/spack_dev/base/spack/var/spack/environments/curl2\r\n==> You can activate this environment with:\r\n==>   spack env activate curl2\r\n(base) [myoder96@sh03-05n69 /scratch/users/myoder96/spack_dev/base] (job 39691869) $ spack env activate curl2\r\nbash: unalias: despacktivate: not found\r\n(base) [myoder96@sh03-05n69 /scratch/users/myoder96/spack_dev/base] (job 39691869) $ spack add curl@7.80.0 %intel@2021.4.0\r\n(base) [myoder96@sh03-05n69 /scratch/users/myoder96/spack_dev/base] (job 39691869) $ spack concretize --force\r\n==> Starting concretization\r\n==> Environment concretized in 10.35 seconds.\r\n==> Concretized curl@7.80.0%intel@2021.4.0\r\n -   wmkg47t  curl@7.80.0%intel@2021.4.0 fflags=\"-fallow-argument-mismatch\" ~gssapi~ldap~libidn2~librtmp~libssh~libssh2~nghttp2 patches=bb330614c0d3e046348308fa5dc12132a21a834df2887354fb142516e911d6ba tls=openssl arch=linux-centos7-zen2\r\n[+]  snc5qbt      ^openssl@1.1.1l%intel@2021.4.0 fflags=\"-fallow-argument-mismatch\" ~docs certs=system arch=linux-centos7-zen2\r\n[+]  clrzgmh          ^perl@5.34.0%intel@2021.4.0 fflags=\"-fallow-argument-mismatch\" +cpanm+shared+threads arch=linux-centos7-zen2\r\n[+]  v2znlhh              ^berkeley-db@18.1.40%intel@2021.4.0 fflags=\"-fallow-argument-mismatch\" +cxx~docs+stl patches=b231fcc4d5cff05e5c3a4814f6a5af0e9a966428dc2176540d2c05aff41de522 arch=linux-centos7-zen2\r\n[+]  cr3pw7v              ^bzip2@1.0.8%intel@2021.4.0 fflags=\"-fallow-argument-mismatch\" ~debug~pic+shared arch=linux-centos7-zen2\r\n[+]  656g2tf                  ^diffutils@3.8%intel@2021.4.0 fflags=\"-fallow-argument-mismatch\"  arch=linux-centos7-zen2\r\n[+]  zcaujfu                      ^libiconv@1.16%intel@2021.4.0 fflags=\"-fallow-argument-mismatch\"  libs=shared,static arch=linux-centos7-zen2\r\n[+]  3b6vpfg              ^gdbm@1.19%intel@2021.4.0 fflags=\"-fallow-argument-mismatch\"  arch=linux-centos7-zen2\r\n[+]  miykdke                  ^readline@8.1%intel@2021.4.0 fflags=\"-fallow-argument-mismatch\"  arch=linux-centos7-zen2\r\n[+]  rhs4bbi                      ^ncurses@6.2%intel@2021.4.0 fflags=\"-fallow-argument-mismatch\" ~symlinks+termlib abi=none arch=linux-centos7-zen2\r\n[+]  5bxrapa                          ^pkgconf@1.8.0%intel@2021.4.0 fflags=\"-fallow-argument-mismatch\"  arch=linux-centos7-zen2\r\n[+]  e6kgsmc              ^zlib@1.2.11%intel@2021.4.0 fflags=\"-fallow-argument-mismatch\" +optimize+pic+shared arch=linux-centos7-zen2\r\n\r\n==> Updating view at /scratch/users/myoder96/spack_dev/base/spack/var/spack/environments/curl2/.spack-env/view\r\n(base) [myoder96@sh03-05n69 /scratch/users/myoder96/spack_dev/base] (job 39691869) $ spack install\r\n==> Installing environment curl2\r\n[+] /scratch/users/myoder96/spack_dev/base/spack/opt/spack/linux-centos7-zen2/intel-2021.4.0/berkeley-db-18.1.40-v2znlhhcxz6bnphocoyhdlhxpkfb624a\r\n[+] /scratch/users/myoder96/spack_dev/base/spack/opt/spack/linux-centos7-zen2/intel-2021.4.0/libiconv-1.16-zcaujfug2vr3vfeddn7kqxyy275mxijd\r\n[+] /scratch/users/myoder96/spack_dev/base/spack/opt/spack/linux-centos7-zen2/intel-2021.4.0/pkgconf-1.8.0-5bxrapabrixdg3ub6uoeqrq35sz6dqg5\r\n[+] /scratch/users/myoder96/spack_dev/base/spack/opt/spack/linux-centos7-zen2/intel-2021.4.0/zlib-1.2.11-e6kgsmcspij4iwnmz2ncgl34qv4p56wh\r\n[+] /scratch/users/myoder96/spack_dev/base/spack/opt/spack/linux-centos7-zen2/intel-2021.4.0/diffutils-3.8-656g2tfnx2ctb5ev6bkwfrtpke6vrhqp\r\n[+] /scratch/users/myoder96/spack_dev/base/spack/opt/spack/linux-centos7-zen2/intel-2021.4.0/ncurses-6.2-rhs4bbiv63eqpebeoly7igd4z552t4qa\r\n[+] /scratch/users/myoder96/spack_dev/base/spack/opt/spack/linux-centos7-zen2/intel-2021.4.0/bzip2-1.0.8-cr3pw7vvsjueevceokwlnflwa65dccca\r\n[+] /scratch/users/myoder96/spack_dev/base/spack/opt/spack/linux-centos7-zen2/intel-2021.4.0/readline-8.1-miykdkeo4emwqvxr7litxxf2ina7h4hi\r\n[+] /scratch/users/myoder96/spack_dev/base/spack/opt/spack/linux-centos7-zen2/intel-2021.4.0/gdbm-1.19-3b6vpfgwczcfsapaciwnlyfvtpdwb4ao\r\n[+] /scratch/users/myoder96/spack_dev/base/spack/opt/spack/linux-centos7-zen2/intel-2021.4.0/perl-5.34.0-clrzgmhzqbf6n7jehotu5laecfnpko2c\r\n[+] /scratch/users/myoder96/spack_dev/base/spack/opt/spack/linux-centos7-zen2/intel-2021.4.0/openssl-1.1.1l-snc5qbtylltrdy2zl7ahb5vz5ympk5jv\r\n==> Installing curl-7.80.0-wmkg47t77tun2ui5wzrufz72x2x5xfqp\r\n==> No binary for curl-7.80.0-wmkg47t77tun2ui5wzrufz72x2x5xfqp found: installing from source\r\n==> Warning: Intel's compilers may or may not optimize to the same degree for non-Intel microprocessors for optimizations that are not unique to Intel microprocessors\r\n==> Using cached archive: /scratch/users/myoder96/spack_dev/base/spack/var/spack/cache/_source-cache/archive/dd/dd0d150e49cd950aff35e16b628edf04927f0289df42883750cf952bb858189c.tar.bz2\r\n==> Applied patch /scratch/users/myoder96/spack_dev/base/spack/var/spack/repos/builtin/packages/curl/curl_7_78_0_configure_ac.diff\r\n==> curl: Executing phase: 'autoreconf'\r\n==> curl: Executing phase: 'configure'\r\n==> Error: ProcessError: Command exited with status 1:\r\n    '/scratch/users/myoder96/spack-build_stage/spack-stage-curl-7.80.0-wmkg47t77tun2ui5wzrufz72x2x5xfqp/spack-src/configure' '--prefix=/scratch/users/myoder96/spack_dev/base/spack/opt/spack/linux-centos7-zen2/intel-2021.4.0/curl-7.80.0-wmkg47t77tun2ui5wzrufz72x2x5xfqp' '--with-zlib=/scratch/users/myoder96/spack_dev/base/spack/opt/spack/linux-centos7-zen2/intel-2021.4.0/zlib-1.2.11-e6kgsmcspij4iwnmz2ncgl34qv4p56wh' '--without-brotli' '--without-libgsasl' '--without-libpsl' '--without-zstd' '--without-ca-bundle' '--without-ca-path' '--with-ca-fallback' '--without-gssapi' '--without-gnutls' '--without-mbedtls' '--without-nss' '--with-openssl=/scratch/users/myoder96/spack_dev/base/spack/opt/spack/linux-centos7-zen2/intel-2021.4.0/openssl-1.1.1l-snc5qbtylltrdy2zl7ahb5vz5ympk5jv' '--without-secure-transport' '--without-libidn2' '--without-librtmp' '--without-nghttp2' '--without-libssh2' '--without-libssh' '--disable-ldap'\r\n\r\n1 error found in build log:\r\n     130    configure: compiler options added: -O2\r\n     131    checking if compiler accepts strict warning options... yes\r\n     132    configure: compiler options added: -Wno-system-headers -Wenum-conversion\r\n     133    checking if compiler halts on compilation errors... yes\r\n     134    checking if compiler halts on negative sized arrays... yes\r\n     135    checking if compiler halts on function prototype mismatch... no\r\n  >> 136    configure: error: compiler does not halt on function prototype mismatch.\r\n\r\nSee build log for details:\r\n  /scratch/users/myoder96/spack-build_stage/spack-stage-curl-7.80.0-wmkg47t77tun2ui5wzrufz72x2x5xfqp/spack-build-out.txt\r\n\r\n(base) [myoder96@sh03-05n69 /scratch/users/myoder96/spack_dev/base] (job 39691869) $ \r\n\r\n```\r\n\r\n### Information on your system\r\n\r\nStanford's Sherlock HPC:\r\nLinux, CentOS-7\r\n\r\n(base) [myoder96@sh03-05n69 /scratch/users/myoder96/spack_dev/base] (job 39691869) $ spack debug report\r\n* **Spack:** 0.17.0-270-c263b64\r\n* **Python:** 3.8.8\r\n* **Platform:** linux-centos7-zen2\r\n* **Concretizer:** clingo\r\n\r\n### Additional information\r\n\r\n[spack-build-env.txt](https://github.com/spack/spack/files/7622261/spack-build-env.txt)\r\n[spack-build-out.txt](https://github.com/spack/spack/files/7622263/spack-build-out.txt)\r\n\r\nComments: The package builds with gcc; this appears to be, fundamentally, a bug with `icc` and a ticket should be opened with Intel (which I should be able to do from my end).\r\n\r\n We can successfully work around the problem by modifying the `configure.ac`, removing CURL_CHECK_COMPILER_PROTOTYPE_MISMATCH  (or writing a patch to do so).\r\n \r\n My thought is to patch the package for the short term, and push up a ticket to Intel for the long term?\r\n\r\n\r\n### General information\r\n\r\n- [X] I have run `spack debug report` and reported the version of Spack/Python/Platform\r\n- [X] I have run `spack maintainers <name-of-the-package>` and **@mentioned** any maintainers\r\n- [X] I have uploaded the build log and environment files\r\n- [X] I have searched the issues of this repo and believe this is not a duplicate",
    "user": "markyoder",
    "url": "https://api.github.com/repos/spack/spack/issues/27709",
    "updated_at": "2021-12-06 17:50:16",
    "created_at": "2021-11-30 01:51:25",
    "closed_at": "None",
    "state": "open",
    "title": "Installation issue: curl does not configure/build with Intel compilers spa",
    "number": 27709,
    "milestone": null,
    "labels": [
        "build-error"
    ],
    "id": 1066693410,
    "html_url": "https://github.com/spack/spack/issues/27709",
    "assignees": [
        "scheibelp"
    ],
    "comments": 12
}