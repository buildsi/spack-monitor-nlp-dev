{
    "body": "### Steps to reproduce the issue\r\n\r\n`mesa18@18.3.6` build fails using:\r\n* `spack@develop` (997dba8ffdc01d50dff3ebae791aff3d0145c818 from `Mon Jan 3 18:22:48 2022 +0100`)\r\n* Ubuntu 20.04, x86_64\r\n* GCC 9.3.0\r\n\r\nConcrete spec: [mesa18-d7eiib.spec.yaml.txt](https://github.com/spack/spack/files/7804161/mesa18-d7eiib.spec.yaml.txt)\r\n\r\nConcretization:\r\n```\r\n -   mesa18@18.3.6%gcc@9.3.0+glx~llvm~opengles+osmesa patches=55a5611ca9fcbe8324c4d68a07b338134954ff12c5b122dc78ff376f012a1414 swr=none arch=linux-ubuntu20.04-x86_64\r\n[+]      ^autoconf@2.69%gcc@9.3.0 patches=35c449281546376449766f92d49fc121ca50e330e60fefcfc9be2af3253082c2,7793209b33013dc0f81208718c68440c5aae80e7a1c4b8d336e382525af791a7,a49dd5bac3b62daa0ff688ab4d508d71dbd2f4f8d7e2a02321926346161bf3ee arch=linux-ubuntu20.04-x86_64\r\n[+]          ^m4@1.4.19%gcc@9.3.0+sigsegv patches=9dc5fbd0d5cb1037ab1e6d0ecc74a30df218d0a94bdd5a02759a97f62daca573,bfdffa7c2eb01021d5849b36972c069693654ad826c1a20b53534009a4ec7a89 arch=linux-ubuntu20.04-x86_64\r\n[+]              ^libsigsegv@2.13%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n[+]          ^perl@5.34.0%gcc@9.3.0+cpanm+shared+threads arch=linux-ubuntu20.04-x86_64\r\n[+]              ^berkeley-db@18.1.40%gcc@9.3.0+cxx~docs+stl patches=b231fcc4d5cff05e5c3a4814f6a5af0e9a966428dc2176540d2c05aff41de522 arch=linux-ubuntu20.04-x86_64\r\n[+]              ^bzip2@1.0.8%gcc@9.3.0~debug~pic+shared arch=linux-ubuntu20.04-x86_64\r\n[+]                  ^diffutils@3.8%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n[+]                      ^libiconv@1.16%gcc@9.3.0 libs=shared,static arch=linux-ubuntu20.04-x86_64\r\n[+]              ^gdbm@1.19%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n[+]                  ^readline@8.1%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n[+]                      ^ncurses@6.2%gcc@9.3.0~symlinks+termlib abi=none arch=linux-ubuntu20.04-x86_64\r\n[+]                          ^pkgconf@1.8.0%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n[+]              ^zlib@1.2.11%gcc@9.3.0+optimize+pic+shared arch=linux-ubuntu20.04-x86_64\r\n[+]      ^automake@1.16.3%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n[+]      ^binutils@2.36.1%gcc@9.3.0~gas+gold+headers~interwork+ld+libiberty~lto~nls+plugins libs=shared,static patches=a51b7bf4607645235be01683a3e2deb3a87d767cc124ea4ef6febf9f32abf4a7 arch=linux-ubuntu20.04-x86_64\r\n[+]      ^bison@3.8.2%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n[+]      ^expat@2.4.1%gcc@9.3.0+libbsd arch=linux-ubuntu20.04-x86_64\r\n[+]          ^libbsd@0.11.3%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n[+]              ^libmd@1.0.3%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n[+]      ^flex@2.6.3%gcc@9.3.0+lex~nls arch=linux-ubuntu20.04-x86_64\r\n[+]          ^findutils@4.8.0%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n[+]      ^gettext@0.21%gcc@9.3.0+bzip2+curses+git~libunistring+libxml2+tar+xz arch=linux-ubuntu20.04-x86_64\r\n[+]          ^libxml2@2.9.12%gcc@9.3.0~python arch=linux-ubuntu20.04-x86_64\r\n[+]              ^xz@5.2.5%gcc@9.3.0+pic libs=shared,static arch=linux-ubuntu20.04-x86_64\r\n[+]          ^tar@1.34%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n[+]      ^glproto@1.4.17%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n[+]          ^util-macros@1.19.3%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n[+]      ^libtool@2.4.6%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n[+]      ^libx11@1.7.0%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n[+]          ^inputproto@2.3.2%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n[+]          ^kbproto@1.0.7%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n[+]          ^libxcb@1.14%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n[+]              ^libpthread-stubs@0.4%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n[+]              ^libxau@1.0.8%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n[+]                  ^xproto@7.0.31%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n[+]              ^libxdmcp@1.1.2%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n[+]              ^xcb-proto@1.14.1%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n[+]          ^xextproto@7.3.0%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n[+]          ^xtrans@1.3.5%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n[+]      ^libxext@1.3.3%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n[+]      ^py-mako@1.1.5%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n[+]          ^py-markupsafe@2.0.1%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n[+]              ^py-setuptools@59.4.0%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n[+]                  ^python@3.9.9%gcc@9.3.0+bz2+ctypes+dbm~debug+libxml2+lzma~nis~optimizations+pic+pyexpat+pythoncmd+readline+shared+sqlite3+ssl~tix~tkinter~ucs4+uuid+zlib patches=0d98e93189bc278fbc37a50ed7f183bd8aaf249a8e1670a465f0db6bb4f8cf87,4c2457325f2b608b1b6a2c63087df8c26e07db3e3d493caf36a56f0ecf6fb768,f2fd060afc4b4618fe8104c4c5d771f36dc55b1db5a4623785a4ea707ec72fb4 arch=linux-ubuntu20.04-x86_64\r\n[+]                      ^libffi@3.3%gcc@9.3.0 patches=26f26c6f29a7ce9bf370ad3ab2610f99365b4bdd7b82e7c31df41a3370d685c0 arch=linux-ubuntu20.04-x86_64\r\n[+]                      ^openssl@1.1.1l%gcc@9.3.0~docs certs=system arch=linux-ubuntu20.04-x86_64\r\n[+]                      ^sqlite@3.36.0%gcc@9.3.0+column_metadata+fts~functions~rtree arch=linux-ubuntu20.04-x86_64\r\n[+]                      ^util-linux-uuid@2.36.2%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n```\r\n\r\nError reproduced with entirely cached dependencies using:\r\n* Docker container image = `ecpe4s/ubuntu20.04-runner-x86_64:2021-11-01`\r\n\r\n```\r\n$> spack mirror add E4S https://cache.e4s.io\r\n$> spack buildcache keys -it\r\n\r\n$> spack install --cache-only --include-build-deps --only dependencies -f ./mesa18-d7eiib.spec.yaml\r\nOK\r\n\r\n$> spack install --no-cache -f ./mesa18-d7eiib.spec.yaml\r\n...\r\n==> Installing mesa18-18.3.6-3kdtnixd32klhqamkwvzaveg5pj6ue5q\r\n==> Applied patch /spack/var/spack/repos/builtin/packages/mesa18/autotools-x11-nodri.patch\r\n==> mesa18: Executing phase: 'autoreconf'\r\n==> mesa18: Executing phase: 'configure'\r\n==> mesa18: Executing phase: 'build'\r\n==> Error: ProcessError: Command exited with status 2:\r\n    'make' '-j16' 'V=1'\r\n\r\n21 errors found in build log:\r\n     13     libtoolize: copying file 'm4/ltsugar.m4'\r\n     14     libtoolize: copying file 'm4/ltversion.m4'\r\n     15     libtoolize: copying file 'm4/lt~obsolete.m4'\r\n     16     autoreconf: running: /spack/opt/spack/__spack_path_placeholder__/__spack_path_placeholder__/__spack_path_placeholder__/__spack_path_placeholder__/__spack_path_placeholder__/__spack_\r\n            path_placeholder__/__spack_path_placeholder__/__spack_path_placeholder__/__spack_path_placeholde/linux-ubuntu20.04-x86_64/gcc-9.3.0/autoconf-2.69-4wefch2dqfia5xr4oxseyr73xo7p7dav/bi\r\n            n/autoconf --force\r\n     17     autoreconf: configure.ac: not using Autoheader\r\n     18     autoreconf: running: automake --add-missing --copy --force-missing\r\n  >> 19     configure.ac:61: installing 'bin/ar-lib'\r\n  >> 20     configure.ac:61: installing 'bin/compile'\r\n  >> 21     configure.ac:45: installing 'bin/config.guess'\r\n  >> 22     configure.ac:45: installing 'bin/config.sub'\r\n  >> 23     configure.ac:46: installing 'bin/install-sh'\r\n  >> 24     configure.ac:46: installing 'bin/missing'\r\n     25     src/Makefile.am: installing 'bin/depcomp'\r\n     26     parallel-tests: installing 'bin/test-driver'\r\n     27     autoreconf: Leaving directory `.'\r\n     28     ==> mesa18: Executing phase: 'configure'\r\n     29     ==> [2022-01-03-13:40:09.388008] '/tmp/root/spack-stage/spack-stage-mesa18-18.3.6-3kdtnixd32klhqamkwvzaveg5pj6ue5q/spack-src/configure' '--prefix=/spack/opt/spack/[padded-to-256-cha\r\n            rs]/linux-ubuntu20.04-x86_64/gcc-9.3.0/mesa18-18.3.6-3kdtnixd32klhqamkwvzaveg5pj6ue5q' 'LDFLAGS=-L/spack/opt/spack/[padded-to-256-chars]/linux-ubuntu20.04-x86_64/gcc-9.3.0/ncurses-6\r\n            .2-nxjjphalwbf2ywlxpn74nsfcsrq2bbtd/lib' '--enable-shared' '--disable-static' '--disable-libglvnd' '--disable-nine' '--disable-omx-bellagio' '--disable-omx-tizonia' '--disable-openc\r\n            l' '--disable-opencl-icd' '--disable-va' '--disable-vdpau' '--disable-xa' '--disable-xvmc' '--disable-osmesa' '--with-vulkan-drivers=' '--disable-egl' '--disable-gbm' '--disable-dri\r\n            ' '--enable-opengl' '--enable-gallium-osmesa' '--enable-glx=gallium-xlib' '--disable-gles1' '--disable-gles2' '--enable-shared-glapi' '--disable-llvm' '--with-platforms=x11' '--with\r\n            -gallium-drivers=swrast' '--with-dri-drivers='\r\n     30     checking build system type... x86_64-pc-linux-gnu\r\n\r\n     ...\r\n\r\n     670        self.process_element(file_name, doc)\r\n     671      File \"/tmp/root/spack-stage/spack-stage-mesa18-18.3.6-3kdtnixd32klhqamkwvzaveg5pj6ue5q/spack-src/src/mapi/glapi/gen/./../../../../src/mapi/glapi/gen/gl_XML.py\", line 914, in proce\r\n            ss_element\r\n     672        self.process_OpenGLAPI(file_name, element)\r\n     673      File \"/tmp/root/spack-stage/spack-stage-mesa18-18.3.6-3kdtnixd32klhqamkwvzaveg5pj6ue5q/spack-src/src/mapi/glapi/gen/./../../../../src/mapi/glapi/gen/gl_XML.py\", line 919, in proce\r\n            ss_OpenGLAPI\r\n     674        for child in element.getchildren():\r\n     675    AttributeError: 'xml.etree.ElementTree.Element' object has no attribute 'getchildren'\r\n  >> 676    make[3]: *** [Makefile:939: ../../../../src/mesa/main/marshal_generated.c] Error 1\r\n     677    make[3]: *** Waiting for unfinished jobs....\r\n     678    Traceback (most recent call last):\r\n     679      File \"/tmp/root/spack-stage/spack-stage-mesa18-18.3.6-3kdtnixd32klhqamkwvzaveg5pj6ue5q/spack-src/src/mapi/glapi/gen/./gl_table.py\", line 207, in <module>\r\n     680        main()\r\n     681      File \"/tmp/root/spack-stage/spack-stage-mesa18-18.3.6-3kdtnixd32klhqamkwvzaveg5pj6ue5q/spack-src/src/mapi/glapi/gen/./gl_table.py\", line 196, in main\r\n     682        api = gl_XML.parse_GL_API(args.file_name)\r\n\r\n     ...\r\n\r\n     686        self.process_element(file_name, doc)\r\n     687      File \"/tmp/root/spack-stage/spack-stage-mesa18-18.3.6-3kdtnixd32klhqamkwvzaveg5pj6ue5q/spack-src/src/mapi/glapi/gen/gl_XML.py\", line 914, in process_element\r\n     688        self.process_OpenGLAPI(file_name, element)\r\n     689      File \"/tmp/root/spack-stage/spack-stage-mesa18-18.3.6-3kdtnixd32klhqamkwvzaveg5pj6ue5q/spack-src/src/mapi/glapi/gen/gl_XML.py\", line 919, in process_OpenGLAPI\r\n     690        for child in element.getchildren():\r\n     691    AttributeError: 'xml.etree.ElementTree.Element' object has no attribute 'getchildren'\r\n  >> 692    make[3]: *** [Makefile:942: ../../../../src/mesa/main/marshal_generated.h] Error 1\r\n     693    Traceback (most recent call last):\r\n     694      File \"/tmp/root/spack-stage/spack-stage-mesa18-18.3.6-3kdtnixd32klhqamkwvzaveg5pj6ue5q/spack-src/src/mapi/glapi/gen/./gl_table.py\", line 207, in <module>\r\n     695    Traceback (most recent call last):\r\n     696      File \"/tmp/root/spack-stage/spack-stage-mesa18-18.3.6-3kdtnixd32klhqamkwvzaveg5pj6ue5q/spack-src/src/mapi/glapi/gen/./gl_procs.py\", line 190, in <module>\r\n     697        main()\r\n     698      File \"/tmp/root/spack-stage/spack-stage-mesa18-18.3.6-3kdtnixd32klhqamkwvzaveg5pj6ue5q/spack-src/src/mapi/glapi/gen/./gl_table.py\", line 196, in main\r\n\r\n     ...\r\n\r\n     771        for child in element.getchildren():\r\n     772    AttributeError: 'xml.etree.ElementTree.Element' object has no attribute 'getchildren'\r\n     773        self.process_OpenGLAPI(file_name, element)\r\n     774      File \"/tmp/root/spack-stage/spack-stage-mesa18-18.3.6-3kdtnixd32klhqamkwvzaveg5pj6ue5q/spack-src/src/mapi/glapi/gen/gl_XML.py\", line 919, in process_OpenGLAPI\r\n     775        for child in element.getchildren():\r\n     776    AttributeError: 'xml.etree.ElementTree.Element' object has no attribute 'getchildren'\r\n  >> 777    make[3]: *** [Makefile:904: ../../../../src/mapi/glapi/glapi_mapi_tmp.h] Error 1\r\n  >> 778    make[3]: *** [Makefile:945: ../../../../src/mesa/main/dispatch.h] Error 1\r\n  >> 779    make[3]: *** [Makefile:914: ../../../../src/mapi/glapi/glapitable.h] Error 1\r\n  >> 780    make[3]: *** [Makefile:948: ../../../../src/mesa/main/remap_helper.h] Error 1\r\n  >> 781    make[3]: *** [Makefile:908: ../../../../src/mapi/glapi/glprocs.h] Error 1\r\n  >> 782    make[3]: *** [Makefile:925: ../../../../src/mapi/glapi/glapi_x86-64.S] Error 1\r\n  >> 783    make[3]: *** [Makefile:936: ../../../../src/mesa/main/api_exec.c] Error 1\r\n  >> 784    make[3]: *** [Makefile:911: ../../../../src/mapi/glapi/glapitemp.h] Error 1\r\n     785    Traceback (most recent call last):\r\n     786      File \"/tmp/root/spack-stage/spack-stage-mesa18-18.3.6-3kdtnixd32klhqamkwvzaveg5pj6ue5q/spack-src/src/mapi/glapi/gen/./glX_proto_size.py\", line 699, in <module>\r\n     787        main()\r\n     788      File \"/tmp/root/spack-stage/spack-stage-mesa18-18.3.6-3kdtnixd32klhqamkwvzaveg5pj6ue5q/spack-src/src/mapi/glapi/gen/./glX_proto_size.py\", line 693, in main\r\n     789        api = gl_XML.parse_GL_API(args.filename, glX_XML.glx_item_factory())\r\n     790      File \"/tmp/root/spack-stage/spack-stage-mesa18-18.3.6-3kdtnixd32klhqamkwvzaveg5pj6ue5q/spack-src/src/mapi/glapi/gen/gl_XML.py\", line 44, in parse_GL_API\r\n\r\n     ...\r\n\r\n     849        self.process_OpenGLAPI(file_name, element)\r\n     850      File \"/tmp/root/spack-stage/spack-stage-mesa18-18.3.6-3kdtnixd32klhqamkwvzaveg5pj6ue5q/spack-src/src/mapi/glapi/gen/gl_XML.py\", line 919, in process_OpenGLAPI\r\n     851        for child in element.getchildren():\r\n     852    AttributeError: 'xml.etree.ElementTree.Element' object has no attribute 'getchildren'\r\n     853        for child in element.getchildren():\r\n     854    AttributeError: 'xml.etree.ElementTree.Element' object has no attribute 'getchildren'\r\n  >> 855    make[3]: *** [Makefile:960: ../../../../src/glx/indirect_init.c] Error 1\r\n  >> 856    make[3]: *** [Makefile:957: ../../../../src/glx/indirect.h] Error 1\r\n     857    make[3]: Leaving directory '/tmp/root/spack-stage/spack-stage-mesa18-18.3.6-3kdtnixd32klhqamkwvzaveg5pj6ue5q/spack-src/src/mapi/glapi/gen'\r\n  >> 858    make[2]: *** [Makefile:895: all-recursive] Error 1\r\n     859    make[2]: Leaving directory '/tmp/root/spack-stage/spack-stage-mesa18-18.3.6-3kdtnixd32klhqamkwvzaveg5pj6ue5q/spack-src/src'\r\n  >> 860    make[1]: *** [Makefile:680: all] Error 2\r\n     861    make[1]: Leaving directory '/tmp/root/spack-stage/spack-stage-mesa18-18.3.6-3kdtnixd32klhqamkwvzaveg5pj6ue5q/spack-src/src'\r\n  >> 862    make: *** [Makefile:694: all-recursive] Error 1\r\n```\r\n\r\n### Information on your system\r\n\r\n* **Spack:** 0.17.1-697-997dba8ffd\r\n* **Python:** 3.8.10\r\n* **Platform:** linux-ubuntu20.04-cascadelake\r\n* **Concretizer:** clingo\r\n\r\n### Additional information\r\n\r\n[spack-configure-args.txt](https://github.com/spack/spack/files/7804175/spack-configure-args.txt)\r\n[spack-build-env.txt](https://github.com/spack/spack/files/7804176/spack-build-env.txt)\r\n[spack-build-02-configure-out.txt](https://github.com/spack/spack/files/7804177/spack-build-02-configure-out.txt)\r\n[spack-build-out.txt](https://github.com/spack/spack/files/7804171/spack-build-out.txt)\r\n\r\n@ChristianTackeGSI \r\n@chuckatkins\r\n@v-dobrev\r\n\r\n### General information\r\n\r\n- [X] I have run `spack debug report` and reported the version of Spack/Python/Platform\r\n- [X] I have run `spack maintainers <name-of-the-package>` and **@mentioned** any maintainers\r\n- [X] I have uploaded the build log and environment files\r\n- [X] I have searched the issues of this repo and believe this is not a duplicate",
    "user": "eugeneswalker",
    "url": "https://api.github.com/repos/spack/spack/issues/28219",
    "updated_at": "2022-01-17 08:50:45",
    "created_at": "2022-01-03 22:10:42",
    "closed_at": "2022-01-17 08:50:45",
    "state": "closed",
    "title": "mesa18@18.3.6 build fails: AttributeError: 'xml.etree.ElementTree.Element' object has no attribute 'getchildren'",
    "number": 28219,
    "milestone": null,
    "labels": [
        "build-error",
        "e4s",
        "ROCm/hip"
    ],
    "id": 1092855054,
    "html_url": "https://github.com/spack/spack/issues/28219",
    "assignees": [],
    "comments": 14
}