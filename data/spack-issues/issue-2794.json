{
    "body": "@BarrySmith @tgamblin \r\n\r\nI'm testing the xsdk install using the barry/xsdk branch on NERSC's edison and ran into the following issue.  My connection to edison died during the trilinos build, so I logged back in and tried to resume.\r\n\r\n```\r\namklinv@edison10:~/edison/spack/bin> ./spack -vd install xsdk arch=cray-CNL-ivybridge\r\n==> Reading config file /global/u1/a/amklinv/edison/spack/etc/spack/defaults/packages.yaml\r\n==> Reading config file /global/homes/a/amklinv/.spack/cray/packages.yaml\r\n==> READ LOCK: /global/homes/a/amklinv/.spack/cache/providers/.builtin-index.yaml.lock[0:0] [Acquiring]\r\n==> READ LOCK: /global/homes/a/amklinv/.spack/cache/providers/.builtin-index.yaml.lock[0:0] [Released]\r\n==> '/usr/bin/ibv_devices'\r\n==> '/opt/modules/3.2.10.4/bin/modulecmd' 'python' 'show' 'cray-mpich/7.4.1'\r\n==> '/opt/modules/3.2.10.4/bin/modulecmd' 'python' 'show' 'cray-mpich/7.4.1'\r\n==> '/opt/modules/3.2.10.4/bin/modulecmd' 'python' 'show' 'cray-mpich/7.4.1'\r\n==> '/opt/modules/3.2.10.4/bin/modulecmd' 'python' 'show' 'cray-hdf5-parallel/1.8.12'\r\n==> '/opt/modules/3.2.10.4/bin/modulecmd' 'python' 'show' 'cray-mpich/7.4.1'\r\n==> '/opt/modules/3.2.10.4/bin/modulecmd' 'python' 'show' 'cray-hdf5-parallel/1.8.12'\r\n==> Reading config file /global/homes/a/amklinv/.spack/cray/compilers.yaml\r\n==> '/opt/modules/3.2.10.4/bin/modulecmd' 'python' 'show' 'cray-mpich/7.4.1'\r\n==> '/opt/modules/3.2.10.4/bin/modulecmd' 'python' 'show' 'cray-hdf5-parallel/1.8.12'\r\n==> '/opt/modules/3.2.10.4/bin/modulecmd' 'python' 'show' 'cray-mpich/7.4.1'\r\n==> '/opt/modules/3.2.10.4/bin/modulecmd' 'python' 'show' 'cray-hdf5-parallel/1.8.12'\r\n==> '/opt/modules/3.2.10.4/bin/modulecmd' 'python' 'show' 'PrgEnv-gnu'\r\n==> '/opt/modules/3.2.10.4/bin/modulecmd' 'python' 'unload' 'PrgEnv'\r\n==> '/opt/modules/3.2.10.4/bin/modulecmd' 'python' 'unload' 'PrgEnv-x1'\r\n==> '/opt/modules/3.2.10.4/bin/modulecmd' 'python' 'unload' 'PrgEnv-x2'\r\n==> '/opt/modules/3.2.10.4/bin/modulecmd' 'python' 'unload' 'PrgEnv-cray'\r\n==> '/opt/modules/3.2.10.4/bin/modulecmd' 'python' 'unload' 'PrgEnv-intel'\r\n==> '/opt/modules/3.2.10.4/bin/modulecmd' 'python' 'unload' 'PrgEnv-pgi'\r\n==> '/opt/modules/3.2.10.4/bin/modulecmd' 'python' 'unload' 'PrgEnv-pathscale'\r\n==> '/opt/modules/3.2.10.4/bin/modulecmd' 'python' 'load' 'PrgEnv-gnu'\r\n==> '/opt/modules/3.2.10.4/bin/modulecmd' 'python' 'show' 'gcc/6.1.0'\r\n==> '/opt/modules/3.2.10.4/bin/modulecmd' 'python' 'unload' 'gcc'\r\n==> '/opt/modules/3.2.10.4/bin/modulecmd' 'python' 'unload' 'gcc-cross-aarch64'\r\n==> '/opt/modules/3.2.10.4/bin/modulecmd' 'python' 'load' 'gcc/6.1.0'\r\n==> '/opt/modules/3.2.10.4/bin/modulecmd' 'python' 'show' 'cray-mpich/7.4.1'\r\n==> '/opt/modules/3.2.10.4/bin/modulecmd' 'python' 'show' 'PrgEnv-gnu'\r\n==> '/opt/modules/3.2.10.4/bin/modulecmd' 'python' 'unload' 'PrgEnv'\r\n==> '/opt/modules/3.2.10.4/bin/modulecmd' 'python' 'unload' 'PrgEnv-x1'\r\n==> '/opt/modules/3.2.10.4/bin/modulecmd' 'python' 'unload' 'PrgEnv-x2'\r\n==> '/opt/modules/3.2.10.4/bin/modulecmd' 'python' 'unload' 'PrgEnv-cray'\r\n==> '/opt/modules/3.2.10.4/bin/modulecmd' 'python' 'unload' 'PrgEnv-intel'\r\n==> '/opt/modules/3.2.10.4/bin/modulecmd' 'python' 'unload' 'PrgEnv-pgi'\r\n==> '/opt/modules/3.2.10.4/bin/modulecmd' 'python' 'unload' 'PrgEnv-pathscale'\r\n==> '/opt/modules/3.2.10.4/bin/modulecmd' 'python' 'load' 'PrgEnv-gnu'\r\n==> '/opt/modules/3.2.10.4/bin/modulecmd' 'python' 'show' 'gcc/6.1.0'\r\n==> '/opt/modules/3.2.10.4/bin/modulecmd' 'python' 'unload' 'gcc'\r\n==> '/opt/modules/3.2.10.4/bin/modulecmd' 'python' 'unload' 'gcc-cross-aarch64'\r\n==> '/opt/modules/3.2.10.4/bin/modulecmd' 'python' 'load' 'gcc/6.1.0'\r\n==> '/opt/modules/3.2.10.4/bin/modulecmd' 'python' 'show' 'cray-hdf5-parallel/1.8.12'\r\n==> READ LOCK: /global/u1/a/amklinv/edison/spack/opt/spack/.spack-db/prefix_lock[6653323931864697468:1] [Acquiring]\r\n==> READ LOCK: /global/u1/a/amklinv/edison/spack/opt/spack/.spack-db/prefix_lock[6653323931864697468:1] [Released]\r\n==> Installing xsdk\r\n==> READ LOCK: /global/u1/a/amklinv/edison/spack/opt/spack/.spack-db/prefix_lock[2794471412757580533:1] [Acquiring]\r\n==> hypre is already installed in /global/u1/a/amklinv/edison/spack/opt/spack/cray-CNL-ivybridge/gcc-6.1.0/hypre-develop-jwh6ty3izsk6ukytgs2i23qxgo3i4lrq\r\n==> READ LOCK: /global/u1/a/amklinv/edison/spack/opt/spack/.spack-db/lock[0:0] [Acquiring]\r\n==> READ LOCK: /global/u1/a/amklinv/edison/spack/opt/spack/.spack-db/lock[0:0] [Released]\r\n==> READ LOCK: /global/u1/a/amklinv/edison/spack/opt/spack/.spack-db/prefix_lock[2794471412757580533:1] [Released]\r\n==> READ LOCK: /global/u1/a/amklinv/edison/spack/opt/spack/.spack-db/prefix_lock[840206737987988608:1] [Acquiring]\r\n==> superlu-dist is already installed in /global/u1/a/amklinv/edison/spack/opt/spack/cray-CNL-ivybridge/gcc-6.1.0/superlu-dist-develop-c5jaojzxkpmqdyxz7xts4crqshkhaxd4\r\n==> READ LOCK: /global/u1/a/amklinv/edison/spack/opt/spack/.spack-db/prefix_lock[840206737987988608:1] [Released]\r\n==> READ LOCK: /global/u1/a/amklinv/edison/spack/opt/spack/.spack-db/prefix_lock[4617400482960019937:1] [Acquiring]\r\n==> trilinos is already installed in /global/u1/a/amklinv/edison/spack/opt/spack/cray-CNL-ivybridge/gcc-6.1.0/trilinos-develop-qaujvdhjder4h77x3td7z7jkfi27rcop\r\n==> READ LOCK: /global/u1/a/amklinv/edison/spack/opt/spack/.spack-db/lock[0:0] [Acquiring]\r\n==> READ LOCK: /global/u1/a/amklinv/edison/spack/opt/spack/.spack-db/lock[0:0] [Released]\r\n==> READ LOCK: /global/u1/a/amklinv/edison/spack/opt/spack/.spack-db/prefix_lock[4617400482960019937:1] [Released]\r\nTraceback (most recent call last):\r\n  File \"./spack\", line 212, in <module>\r\n    main(sys.argv)\r\n  File \"./spack\", line 208, in main\r\n    _main(args, unknown)\r\n  File \"./spack\", line 174, in _main\r\n    return_val = command(parser, args)\r\n  File \"/global/u1/a/amklinv/edison/spack/lib/spack/spack/cmd/install.py\", line 346, in install\r\n    package.do_install(**kwargs)\r\n  File \"/global/u1/a/amklinv/edison/spack/lib/spack/spack/package.py\", line 1185, in do_install\r\n    **kwargs\r\n  File \"/global/u1/a/amklinv/edison/spack/lib/spack/spack/package.py\", line 1157, in do_install\r\n    rec = spack.store.db.get_record(self.spec)\r\n  File \"/global/u1/a/amklinv/edison/spack/lib/spack/spack/database.py\", line 81, in converter\r\n    return function(self, spec_like, *args, **kwargs)\r\n  File \"/global/u1/a/amklinv/edison/spack/lib/spack/spack/database.py\", line 554, in get_record\r\n    key = self._get_matching_spec_key(spec, **kwargs)\r\n  File \"/global/u1/a/amklinv/edison/spack/lib/spack/spack/database.py\", line 549, in _get_matching_spec_key\r\n    raise KeyError(\"No such spec in database! %s\" % spec)\r\nKeyError: 'No such spec in database! trilinos@develop%gcc@6.1.0+boost~debug+hdf5+hypre+metis~mumps~python+shared~suite-sparse~superlu+superlu-dist+xsdkflags arch=cray-CNL-ivybridge^boost@1.63.0%gcc@6.1.0+atomic+chrono+date_time~debug+filesystem~graph~icu+iostreams+locale+log+math~mpi+multithreaded+program_options~python+random+regex+serialization+shared+signals~singlethreaded+system~taggedlayout+test+thread+timer+wave arch=cray-CNL-ivybridge^bzip2@1.0.6%gcc@6.1.0 arch=cray-CNL-ivybridge^cmake@3.7.1%gcc@6.1.0~doc+ncurses+openssl+ownlibs~qt arch=cray-CNL-ivybridge^glm@0.9.7.1%gcc@6.1.0 arch=cray-CNL-ivybridge^hdf5@1.8.12%gcc@6.1.0+cxx~debug+fortran+mpi+pic+shared~szip~threadsafe arch=cray-CNL-ivybridge^hypre@develop%gcc@6.1.0~internal-superlu+shared arch=cray-CNL-ivybridge^libsigsegv@2.10%gcc@6.1.0 arch=cray-CNL-ivybridge^m4@1.4.17%gcc@6.1.0+sigsegv arch=cray-CNL-ivybridge^matio@1.5.9%gcc@6.1.0+hdf5+zlib arch=cray-CNL-ivybridge^metis@5.1.0%gcc@6.1.0~debug~gdb~idx64~real64+shared arch=cray-CNL-ivybridge^mpich@7.4.1%gcc@6.1.0+hydra+pmi+romio~verbs arch=cray-CNL-ivybridge^ncurses@6.0%gcc@6.1.0 arch=cray-CNL-ivybridge^netcdf@4.4.1%gcc@6.1.0~cdmremote~dap~hdf4 maxdims=1024 maxvars=8192+mpi~parallel-netcdf+shared arch=cray-CNL-ivybridge^openblas@0.2.19%gcc@6.1.0~openmp+pic+shared arch=cray-CNL-ivybridge^openssl@1.0.2j%gcc@6.1.0 arch=cray-CNL-ivybridge^parmetis@4.0.3%gcc@6.1.0~debug~gdb+shared arch=cray-CNL-ivybridge^superlu-dist@develop%gcc@6.1.0 arch=cray-CNL-ivybridge^zlib@1.2.10%gcc@6.1.0+pic arch=cray-CNL-ivybridge'\r\n```\r\n\r\nspack thinks trilinos is already installed.  But if I try to uninstall it...\r\n```\r\namklinv@edison10:~/edison/spack/bin> ./spack uninstall trilinos\r\n==> Error: trilinos does not match any installed packages.\r\n==> Error: You can either:\r\n    a) Use a more specific spec, or\r\n    b) use spack uninstall -a to uninstall ALL matching specs.\r\n```\r\n\r\nOr if I do spack find...\r\n```\r\namklinv@edison10:~/edison/spack/bin> ./spack find\r\n==> 16 installed packages.\r\n-- cray-CNL-ivybridge / gcc@6.1.0 -------------------------------\r\nboost@1.63.0  cmake@3.7.1  hypre@develop    m4@1.4.17    metis@5.1.0  netcdf@4.4.1     openssl@1.0.2j  superlu-dist@develop\r\nbzip2@1.0.6   glm@0.9.7.1  libsigsegv@2.10  matio@1.5.9  ncurses@6.0  openblas@0.2.19  parmetis@4.0.3  zlib@1.2.10\r\n```\r\n\r\nThis wouldn't be a big deal for most packages, but trilinos is big and takes a while to install, so the chance of that getting interrupted is non-negligible.",
    "user": "amklinv",
    "url": "https://api.github.com/repos/spack/spack/issues/2794",
    "updated_at": "2017-06-13 16:15:52",
    "created_at": "2017-01-10 16:25:49",
    "closed_at": "2017-06-13 16:15:52",
    "state": "closed",
    "title": "spack unable to resume interrupted trilinos build",
    "number": 2794,
    "milestone": null,
    "labels": [
        "bug",
        "xSDK"
    ],
    "id": 199867358,
    "html_url": "https://github.com/spack/spack/issues/2794",
    "assignees": [
        "tgamblin"
    ],
    "comments": 1
}