{
    "body": "Hi, \r\nI am trying to use spack and to show it to my local research group as an alternative for package management. When doing spack install lmod , if gets stuck when it is downloading libxml2 and its resources.  In particular, it tries to download xmlts-2.9.9.tar.gz, reaches 99.9% , stops there for a while, and then throws an error about an error downloading the package.\r\n\r\n### Steps to reproduce the issue\r\n\r\n```console\r\n$ spack install libxml2\r\n```\r\n\r\n### Error Message\r\n\r\n==> Installing libxml2\r\n==> Searching for binary cache of libxml2\r\n==> Finding buildcaches in /mirror/build_cache\r\n==> No binary for libxml2 found: installing from source\r\n==> Fetching file:///mirror/libxml2/libxml2-2.9.9.tar.gz\r\ncurl: (37) Couldn't open file /mirror/libxml2/libxml2-2.9.9.tar.gz\r\n==> Fetching from file:///mirror/libxml2/libxml2-2.9.9.tar.gz failed.\r\n==> Fetching http://xmlsoft.org/sources/libxml2-2.9.9.tar.gz\r\n######################################################################## 100.0%\r\n==> Fetching file:///mirror/libxml2/xmlts-2.9.9.tar.gz\r\ncurl: (37) Couldn't open file /mirror/libxml2/xmlts-2.9.9.tar.gz\r\n==> Fetching from file:///mirror/libxml2/xmlts-2.9.9.tar.gz failed.\r\n==> Fetching http://www.w3.org/XML/Test/xmlts20080827.tar.gz\r\n#######################################################################   99.9% # IT STAYS HERE FOR A MINUTE AND THEN IT GIVES THE FOLLOWING\r\ncurl: (18) transfer closed with 430 bytes remaining to read\r\n==> Fetching from http://www.w3.org/XML/Test/xmlts20080827.tar.gz failed.\r\n==> Error: FetchError: All fetchers failed for resource-xmlts-ltda6wduib2vz72whtguvzh4qiul5xxk\r\n\r\n/root/repos/spack/lib/spack/spack/package.py:1064, in do_fetch:\r\n       1061                raise FetchError(\"Will not fetch %s\" %\r\n       1062                                 self.spec.format('{name}{@version}'), ck_msg)\r\n       1063\r\n  >>   1064        self.stage.create()\r\n       1065        self.stage.fetch(mirror_only)\r\n       1066        self._fetch_time = time.time() - start_time\r\n       1067\r\n\r\nIf I try curl on that file, it works\r\nroot@darkstar:~/repos/spack# curl https://www.w3.org/XML/Test/xmlts20080827.tar.gz -o xmlts-2.9.9.tar.gz\r\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\r\n                                 Dload  Upload   Total   Spent    Left  Speed\r\n100  623k  100  623k    0     0   333k      0  0:00:01  0:00:01 --:--:--  333k\r\nOr with wget it also downloads. If I put the curl or wget downloaded file in the mirror directory everything works:\r\n==> Fetching file:///mirror/libxml2/xmlts-2.9.9.tar.gz\r\n######################################################################## 100.0%\r\n==> Staging archive: /tmp/root/spack-stage/libxml2-2.9.9-ltda6wduib2vz72whtguvzh4qiul5xxk/libxml2-2.9.9.tar.gz\r\n==> Created stage in /tmp/root/spack-stage/libxml2-2.9.9-ltda6wduib2vz72whtguvzh4qiul5xxk\r\n==> Staging archive: /tmp/root/spack-stage/resource-xmlts-ltda6wduib2vz72whtguvzh4qiul5xxk/xmlts20080827.tar.gz\r\n==> Created stage in /tmp/root/spack-stage/resource-xmlts-ltda6wduib2vz72whtguvzh4qiul5xxk\r\n==> Moving resource stage\r\n        source : /tmp/root/spack-stage/resource-xmlts-ltda6wduib2vz72whtguvzh4qiul5xxk/spack-src/\r\n        destination : /tmp/root/spack-stage/libxml2-2.9.9-ltda6wduib2vz72whtguvzh4qiul5xxk/spack-src/xmlconf\r\n==> No patches needed for libxml2\r\n==> Building libxml2 [AutotoolsPackage]\r\n==> Executing phase: 'autoreconf'\r\n==> Executing phase: 'configure'\r\n==> Executing phase: 'build'\r\n==> Executing phase: 'install'\r\n==> Successfully installed libxml2\r\n  Fetch: 2.62s.  Build: 29.04s.  Total: 31.66s.\r\n[+] /root/repos/spack/opt/spack/linux-slackware14-nehalem/gcc-5.5.0/libxml2-2.9.9-ltda6wduib2vz72whtguvzh4qiul5xxk\r\n\r\nSo there is something related with spack and its curl invocation.\r\n\r\nPS: I am behind a proxy and I tested all this under the same environment using both http_proxy and https_proxy vars, and setting the proxy inside ~/.curlrc .  \r\n\r\nI am running slackware 14.2 64 bits.\r\n\r\nThanks in advance for any guidance\r\n",
    "user": "iluvatar1",
    "url": "https://api.github.com/repos/spack/spack/issues/12988",
    "updated_at": "2019-10-08 20:34:12",
    "created_at": "2019-10-01 01:40:45",
    "closed_at": "2019-10-08 20:33:51",
    "state": "closed",
    "title": "Spack stuck installing libxml2 (curl does not download xmlts)",
    "number": 12988,
    "milestone": null,
    "labels": [
        "bug",
        "fetching"
    ],
    "id": 500610643,
    "html_url": "https://github.com/spack/spack/issues/12988",
    "assignees": [],
    "comments": 5
}