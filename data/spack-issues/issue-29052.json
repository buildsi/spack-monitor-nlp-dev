{
    "body": "### Steps to reproduce the issue\n\n`kokkos +sycl std=17 %dpcpp` build fails using:\r\n* `spack@develop` (783615cacfdec7bd712cd903d409bcef6fc7cef4 from `Mon Feb 14 21:23:35 2022 +0100`)\r\n* Ubuntu 20.04, x86_64\r\n* Intel DPCPP 2022.0.0 from the latest Intel OneAPI Toolkit\r\n\r\nCompiler entry for `dpcpp`\r\n```\r\n- compiler:\r\n    spec: dpcpp@2022.0.0\r\n    paths:\r\n      cc: /opt/intel/oneapi/compiler/2022.0.1/linux/bin/icx\r\n      cxx: /opt/intel/oneapi/compiler/2022.0.1/linux/bin/dpcpp\r\n      f77: /opt/intel/oneapi/compiler/2022.0.1/linux/bin/ifx\r\n      fc: /opt/intel/oneapi/compiler/2022.0.1/linux/bin/ifx\r\n    flags: {}\r\n    operating_system: ubuntu20.04\r\n    target: x86_64\r\n    modules:\r\n    - compiler/2022.0.1\r\n    environment: {}\r\n    extra_rpaths: []\r\n```\r\n\r\n**Concrete spec:** [kokkos.spec.json.txt](https://github.com/spack/spack/files/8092402/kokkos.spec.json.txt)\r\n\r\n**Concretization**\r\n```\r\n -   camgkdo  kokkos@3.5.00%dpcpp@2022.0.0~aggressive_vectorization~compiler_warnings~cuda~cuda_constexpr~cuda_lambda~cuda_ldg_intrinsic~cuda_relocatable_device_code~cuda_uvm~debug~debug_bounds_check~debug_dualview_modify_check~deprecated_code~examples~explicit_instantiation~hpx~hpx_async_dispatch~hwloc~ipo~memkind~numactl~openmp~pic+profiling~profiling_load_print~pthread~qthread~rocm+serial+shared+sycl~tests~tuning~wrapper build_type=RelWithDebInfo std=17 arch=linux-ubuntu20.04-x86_64\r\n[+]  4oedsu6      ^cmake@3.22.2%gcc@9.3.0~doc+ncurses+openssl+ownlibs~qt build_type=Release arch=linux-ubuntu20.04-x86_64\r\n[+]  nxjjpha          ^ncurses@6.2%gcc@9.3.0~symlinks+termlib abi=none arch=linux-ubuntu20.04-x86_64\r\n[+]  osgk6q3              ^pkgconf@1.8.0%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n[+]  qej6s6n          ^openssl@1.1.1m%gcc@9.3.0~docs certs=system arch=linux-ubuntu20.04-x86_64\r\n[+]  mdh4pnq              ^perl@5.34.0%gcc@9.3.0+cpanm+shared+threads arch=linux-ubuntu20.04-x86_64\r\n[+]  hhpgpwj                  ^berkeley-db@18.1.40%gcc@9.3.0+cxx~docs+stl patches=b231fcc4d5cff05e5c3a4814f6a5af0e9a966428dc2176540d2c05aff41de522 arch=linux-ubuntu20.04-x86_64\r\n[+]  acrm735                  ^bzip2@1.0.8%gcc@9.3.0~debug~pic+shared arch=linux-ubuntu20.04-x86_64\r\n[+]  4rwlz7r                      ^diffutils@3.8%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n[+]  zth4ohv                          ^libiconv@1.16%gcc@9.3.0 libs=shared,static arch=linux-ubuntu20.04-x86_64\r\n[+]  6zhwknl                  ^gdbm@1.19%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n[+]  uo5pdkn                      ^readline@8.1%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n[+]  ufqpqnp                  ^zlib@1.2.11%gcc@9.3.0+optimize+pic+shared arch=linux-ubuntu20.04-x86_64\r\n```\r\n\r\n**Install output**\r\n```\r\n$> . /opt/intel/oneapi/setvars.sh\r\n\r\n$> spack install --dirty -f ./kokkos.spec.json\r\n...\r\n==> Installing kokkos-3.5.00-camgkdordkdph2gcf4pwyipbogzef4rd\r\n==> No binary for kokkos-3.5.00-camgkdordkdph2gcf4pwyipbogzef4rd found: installing from source\r\n==> Warning: microarchitecture specific optimizations are not supported yet on mixed compiler toolchains [check dpcpp@2022.0.0 for further details]\r\n==> Using cached archive: /spack/var/spack/cache/_source-cache/archive/74/748f06aed63b1e77e3653cd2f896ef0d2c64cb2e2d896d9e5a57fec3ff0244ff.tar.gz\r\n==> No patches needed for kokkos\r\n==> kokkos: Executing phase: 'cmake'\r\n==> kokkos: Executing phase: 'build'\r\n...\r\n     1792    In file included from /tmp/root/spack-stage/spack-stage-kokkos-3.5.00-camgkdordkdph2gcf4pwyipbogzef4rd/spack-src/core/src/Kokkos_Atomics_Desul_Wrapper.hpp:6:\r\n     1793    In file included from /tmp/root/spack-stage/spack-stage-kokkos-3.5.00-camgkdordkdph2gcf4pwyipbogzef4rd/spack-src/core/src/desul/atomics.hpp:14:\r\n     1794    In file included from /tmp/root/spack-stage/spack-stage-kokkos-3.5.00-camgkdordkdph2gcf4pwyipbogzef4rd/spack-src/core/src/desul/atomics/Atomic_Ref.hpp:17:\r\n     1795    In file included from /tmp/root/spack-stage/spack-stage-kokkos-3.5.00-camgkdordkdph2gcf4pwyipbogzef4rd/spack-src/core/src/desul/atomics/Generic.hpp:16:\r\n     1796    In file included from /tmp/root/spack-stage/spack-stage-kokkos-3.5.00-camgkdordkdph2gcf4pwyipbogzef4rd/spack-src/core/src/desul/atomics/Compare_Exchange.hpp:33:\r\n     1797    In file included from /tmp/root/spack-stage/spack-stage-kokkos-3.5.00-camgkdordkdph2gcf4pwyipbogzef4rd/spack-src/core/src/desul/atomics/Compare_Exchange_SYCL.hpp:12:\r\n  >> 1798    /tmp/root/spack-stage/spack-stage-kokkos-3.5.00-camgkdordkdph2gcf4pwyipbogzef4rd/spack-src/core/src/desul/atomics/SYCLConversions.hpp:37:20: error: no member named 'ON\r\n             EAPI' in namespace 'sycl'\r\n     1799      static constexpr DESUL_SYCL_NAMESPACE::memory_order value = DESUL_SYCL_NAMESPACE::memory_order::relaxed;\r\n     1800                       ^~~~~~~~~~~~~~~~~~~~\r\n     1801    /tmp/root/spack-stage/spack-stage-kokkos-3.5.00-camgkdordkdph2gcf4pwyipbogzef4rd/spack-src/core/src/desul/atomics/Macros.hpp:38:36: note: expanded from macro 'DESUL_SY\r\n             CL_NAMESPACE'\r\n     1802    #define DESUL_SYCL_NAMESPACE sycl::ONEAPI\r\n     1803                                 ~~~~~~^\r\n     1804    In file included from /tmp/root/spack-stage/spack-stage-kokkos-3.5.00-camgkdordkdph2gcf4pwyipbogzef4rd/spack-src/core/src/impl/Kokkos_HostSpace.cpp:102:\r\n\r\n     ...\r\n\r\n     1806    In file included from /tmp/root/spack-stage/spack-stage-kokkos-3.5.00-camgkdordkdph2gcf4pwyipbogzef4rd/spack-src/core/src/Kokkos_Atomics_Desul_Wrapper.hpp:6:\r\n     1807    In file included from /tmp/root/spack-stage/spack-stage-kokkos-3.5.00-camgkdordkdph2gcf4pwyipbogzef4rd/spack-src/core/src/desul/atomics.hpp:14:\r\n     1808    In file included from /tmp/root/spack-stage/spack-stage-kokkos-3.5.00-camgkdordkdph2gcf4pwyipbogzef4rd/spack-src/core/src/desul/atomics/Atomic_Ref.hpp:17:\r\n     1809    In file included from /tmp/root/spack-stage/spack-stage-kokkos-3.5.00-camgkdordkdph2gcf4pwyipbogzef4rd/spack-src/core/src/desul/atomics/Generic.hpp:16:\r\n     1810    In file included from /tmp/root/spack-stage/spack-stage-kokkos-3.5.00-camgkdordkdph2gcf4pwyipbogzef4rd/spack-src/core/src/desul/atomics/Compare_Exchange.hpp:33:\r\n     1811    In file included from /tmp/root/spack-stage/spack-stage-kokkos-3.5.00-camgkdordkdph2gcf4pwyipbogzef4rd/spack-src/core/src/desul/atomics/Compare_Exchange_SYCL.hpp:12:\r\n  >> 1812    /tmp/root/spack-stage/spack-stage-kokkos-3.5.00-camgkdordkdph2gcf4pwyipbogzef4rd/spack-src/core/src/desul/atomics/SYCLConversions.hpp:29:63: error: no member named 'ON\r\n             EAPI' in namespace 'sycl'\r\n     1813      static constexpr DESUL_SYCL_NAMESPACE::memory_order value = DESUL_SYCL_NAMESPACE::memory_order::release;\r\n     1814                                                                  ^~~~~~~~~~~~~~~~~~~~\r\n     1815    /tmp/root/spack-stage/spack-stage-kokkos-3.5.00-camgkdordkdph2gcf4pwyipbogzef4rd/spack-src/core/src/desul/atomics/Macros.hpp:38:36: note: expanded from macro 'DESUL_SY\r\n             CL_NAMESPACE'\r\n     1816    #define DESUL_SYCL_NAMESPACE sycl::ONEAPI\r\n     1817                                 ~~~~~~^\r\n     1818    In file included from /tmp/root/spack-stage/spack-stage-kokkos-3.5.00-camgkdordkdph2gcf4pwyipbogzef4rd/spack-src/core/src/impl/Kokkos_SharedAlloc.cpp:45:\r\n...\r\n  >> 2945    /tmp/root/spack-stage/spack-stage-kokkos-3.5.00-camgkdordkdph2gcf4pwyipbogzef4rd/spack-src/core/src/desul/atomics/Compare_Exchange_SYCL.hpp:22:3: error: no member name\r\n             d 'ONEAPI' in namespace 'sycl'\r\n     2946      DESUL_SYCL_NAMESPACE::atomic_fence(DesulToSYCLMemoryOrder<MemoryOrder>::value,\r\n     2947      ^~~~~~~~~~~~~~~~~~~~\r\n     2948    /tmp/root/spack-stage/spack-stage-kokkos-3.5.00-camgkdordkdph2gcf4pwyipbogzef4rd/spack-src/core/src/desul/atomics/Macros.hpp:38:36: note: expanded from macro 'DESUL_SY\r\n             CL_NAMESPACE'\r\n     2949    #define DESUL_SYCL_NAMESPACE sycl::ONEAPI\r\n     2950                                 ~~~~~~^\r\n     2951    20 errors generated.\r\n  >> 2952    make[2]: *** [core/src/CMakeFiles/kokkoscore.dir/build.make:233: core/src/CMakeFiles/kokkoscore.dir/impl/Kokkos_Profiling.cpp.o] Error 1\r\n     2953    In file included from /tmp/root/spack-stage/spack-stage-kokkos-3.5.00-camgkdordkdph2gcf4pwyipbogzef4rd/spack-src/core/src/impl/Kokkos_ExecPolicy.cpp:45:\r\n     2954    In file included from /tmp/root/spack-stage/spack-stage-kokkos-3.5.00-camgkdordkdph2gcf4pwyipbogzef4rd/spack-src/core/src/Kokkos_Core.hpp:56:\r\n     2955    In file included from /tmp/root/spack-stage/spack-stage-kokkos-3.5.00-camgkdordkdph2gcf4pwyipbogzef4rd/spack-build-camgkdo/KokkosCore_Config_DeclareBackend.hpp:47:\r\n     2956    In file included from /tmp/root/spack-stage/spack-stage-kokkos-3.5.00-camgkdordkdph2gcf4pwyipbogzef4rd/spack-src/core/src/decl/Kokkos_Declare_SERIAL.hpp:49:\r\n     2957    In file included from /tmp/root/spack-stage/spack-stage-kokkos-3.5.00-camgkdordkdph2gcf4pwyipbogzef4rd/spack-src/core/src/Kokkos_Serial.hpp:59:\r\n     2958    In file included from /tmp/root/spack-stage/spack-stage-kokkos-3.5.00-camgkdordkdph2gcf4pwyipbogzef4rd/spack-src/core/src/Kokkos_Parallel.hpp:54:\r\n\r\n     ...\r\n\r\n     2962    In file included from /tmp/root/spack-stage/spack-stage-kokkos-3.5.00-camgkdordkdph2gcf4pwyipbogzef4rd/spack-src/core/src/Kokkos_Atomic.hpp:77:\r\n     2963    In file included from /tmp/root/spack-stage/spack-stage-kokkos-3.5.00-camgkdordkdph2gcf4pwyipbogzef4rd/spack-src/core/src/Kokkos_Atomics_Desul_Wrapper.hpp:6:\r\n     2964    In file included from /tmp/root/spack-stage/spack-stage-kokkos-3.5.00-camgkdordkdph2gcf4pwyipbogzef4rd/spack-src/core/src/desul/atomics.hpp:14:\r\n     2965    In file included from /tmp/root/spack-stage/spack-stage-kokkos-3.5.00-camgkdordkdph2gcf4pwyipbogzef4rd/spack-src/core/src/desul/atomics/Atomic_Ref.hpp:17:\r\n     2966    In file included from /tmp/root/spack-stage/spack-stage-kokkos-3.5.00-camgkdordkdph2gcf4pwyipbogzef4rd/spack-src/core/src/desul/atomics/Generic.hpp:16:\r\n     2967    In file included from /tmp/root/spack-stage/spack-stage-kokkos-3.5.00-camgkdordkdph2gcf4pwyipbogzef4rd/spack-src/core/src/desul/atomics/Compare_Exchange.hpp:33:\r\n  >> 2968    /tmp/root/spack-stage/spack-stage-kokkos-3.5.00-camgkdordkdph2gcf4pwyipbogzef4rd/spack-src/core/src/desul/atomics/Compare_Exchange_SYCL.hpp:30:3: error: no member name\r\n             d 'ONEAPI' in namespace 'sycl'\r\n     2969      DESUL_SYCL_NAMESPACE::atomic_ref<\r\n     2970      ^~~~~~~~~~~~~~~~~~~~\r\n     2971    /tmp/root/spack-stage/spack-stage-kokkos-3.5.00-camgkdordkdph2gcf4pwyipbogzef4rd/spack-src/core/src/desul/atomics/Macros.hpp:38:36: note: expanded from macro 'DESUL_SY\r\n             CL_NAMESPACE'\r\n     2972    #define DESUL_SYCL_NAMESPACE sycl::ONEAPI\r\n     2973                                 ~~~~~~^\r\n     2974    fatal error: too many errors emitted, stopping now [-ferror-limit=]\r\n  >> 2975    make[2]: *** [core/src/CMakeFiles/kokkoscore.dir/build.make:163: core/src/CMakeFiles/kokkoscore.dir/impl/Kokkos_HostSpace_deepcopy.cpp.o] Error 1\r\n     2976    20 errors generated.\r\n     2977    20 errors generated.\r\n  >> 2978    make[2]: *** [core/src/CMakeFiles/kokkoscore.dir/build.make:247: core/src/CMakeFiles/kokkoscore.dir/impl/Kokkos_Serial.cpp.o] Error 1\r\n  >> 2979    make[2]: *** [core/src/CMakeFiles/kokkoscore.dir/build.make:93: core/src/CMakeFiles/kokkoscore.dir/impl/Kokkos_Core.cpp.o] Error 1\r\n     2980    20 errors generated.\r\n  >> 2981    make[2]: *** [core/src/CMakeFiles/kokkoscore.dir/build.make:275: core/src/CMakeFiles/kokkoscore.dir/impl/Kokkos_SharedAlloc.cpp.o] Error 1\r\n     2982    20 errors generated.\r\n  >> 2983    make[2]: *** [core/src/CMakeFiles/kokkoscore.dir/build.make:121: core/src/CMakeFiles/kokkoscore.dir/impl/Kokkos_ExecPolicy.cpp.o] Error 1\r\n     2984    make[2]: Leaving directory '/tmp/root/spack-stage/spack-stage-kokkos-3.5.00-camgkdordkdph2gcf4pwyipbogzef4rd/spack-build-camgkdo'\r\n  >> 2985    make[1]: *** [CMakeFiles/Makefile2:956: core/src/CMakeFiles/kokkoscore.dir/all] Error 2\r\n     2986    make[1]: Leaving directory '/tmp/root/spack-stage/spack-stage-kokkos-3.5.00-camgkdordkdph2gcf4pwyipbogzef4rd/spack-build-camgkdo'\r\n  >> 2987    make: *** [Makefile:149: all] Error 2\r\n\r\nSee build log for details:\r\n  /tmp/root/spack-stage/spack-stage-kokkos-3.5.00-camgkdordkdph2gcf4pwyipbogzef4rd/spack-build-out.txt\r\n```\r\n\r\n\r\n\r\n\n\n### Error message\n\n<details><summary>Error message</summary><pre>\r\nSee above\r\n</pre></details>\r\n\n\n### Information on your system\n\n* **Spack:** 0.17.1-1177-783615cacf\r\n* **Python:** 3.9.7\r\n* **Platform:** linux-ubuntu20.04-broadwell\r\n* **Concretizer:** clingo\n\n### Additional information\n\n[spack-configure-args.txt](https://github.com/spack/spack/files/8092396/spack-configure-args.txt)\r\n[spack-build-env.txt](https://github.com/spack/spack/files/8092397/spack-build-env.txt)\r\n[spack-build-out.txt](https://github.com/spack/spack/files/8092398/spack-build-out.txt)\r\n\r\n@crtrott\r\n@janciesko\r\n@masterleinad\r\n@DavidPoliakoff \r\n@wspear \n\n### General information\n\n- [X] I have run `spack debug report` and reported the version of Spack/Python/Platform\n- [X] I have run `spack maintainers <name-of-the-package>` and **@mentioned** any maintainers\n- [X] I have uploaded the build log and environment files\n- [X] I have searched the issues of this repo and believe this is not a duplicate",
    "user": "eugeneswalker",
    "url": "https://api.github.com/repos/spack/spack/issues/29052",
    "updated_at": "2022-02-18 22:33:59",
    "created_at": "2022-02-17 21:47:43",
    "closed_at": "2022-02-18 22:33:59",
    "state": "closed",
    "title": "kokkos@3.5.00 +sycl build fails: Kokkos_SYCL_Team.hpp:112:17: error: no member named 'group_broadcast' in namespace 'sycl'",
    "number": 29052,
    "milestone": null,
    "labels": [
        "build-error",
        "e4s",
        "sycl"
    ],
    "id": 1141931714,
    "html_url": "https://github.com/spack/spack/issues/29052",
    "assignees": [],
    "comments": 4
}