{
    "body": "### Steps to reproduce the issue\r\n\r\n```console\r\n$ spack spec -l --reuse  py-tensorflow~cuda~nccl^mpich\r\nInput spec\r\n--------------------------------\r\npy-tensorflow~cuda~nccl\r\n    ^mpich\r\n\r\nConcretized\r\n--------------------------------\r\ngus7lzs  py-tensorflow@2.4.1%gcc@8.5.0~android~aws~computecpp~cuda~dynamic_kernels~gcp~gdr~hdfs~ignite~ios~jemalloc~kafka~mkl~monolithic~mpi~nccl~ngraph~numa~opencl~rocm~tensorrt~verbs~xla arch=linux-centos8-skylake_avx512\r\nocvloor      ^bazel@3.7.2%gcc@8.5.0+nodepfail patches=0f6940d1cb5dc44630c9e845704da6d5188683eb706e280dafc84f5f0f76999e,3e6448a0dde42bbd72568d29c5646d370dd62ca300cdd10a630908c086844167,604423c717a5e58cdd76ba8a9ce1d313faf13885be838f4e33dd37845b3940cb,dbbf38bd17c63aa923f2433a2013d302739f8043ca427c816e8737dab05ac528 arch=linux-centos8-skylake_avx512\r\n4abfd4g          ^openjdk@11.0.12_7%gcc@8.5.0 arch=linux-centos8-skylake_avx512\r\ntr5gsof          ^python@3.9.9%gcc@8.5.0+bz2+ctypes+dbm~debug+libxml2+lzma~nis~optimizations+pic+pyexpat+pythoncmd+readline+shared+sqlite3+ssl~tix~tkinter~ucs4+uuid+zlib patches=0d98e93189bc278fbc37a50ed7f183bd8aaf249a8e1670a465f0db6bb4f8cf87,4c2457325f2b608b1b6a2c63087df8c26e07db3e3d493caf36a56f0ecf6fb768,f2fd060afc4b4618fe8104c4c5d771f36dc55b1db5a4623785a4ea707ec72fb4 arch=linux-centos8-skylake_avx512\r\nrw4vhmy              ^bzip2@1.0.6%gcc@8.5.0~debug~pic+shared arch=linux-centos8-skylake_avx512\r\ng2ufnm3              ^expat@2.4.1%gcc@8.5.0+libbsd arch=linux-centos8-skylake_avx512\r\nysw6qfw                  ^libbsd@0.11.3%gcc@8.5.0 arch=linux-centos8-skylake_avx512\r\n7jbwhjp                      ^libmd@1.0.3%gcc@8.5.0 arch=linux-centos8-skylake_avx512\r\nlmp7fbd              ^gdbm@1.21%gcc@8.5.0 arch=linux-centos8-skylake_avx512\r\n7gdv6yl                  ^readline@8.1%gcc@8.5.0 arch=linux-centos8-skylake_avx512\r\nqn5hgoy                      ^ncurses@6.1.20180224%gcc@8.5.0~symlinks+termlib abi=6 arch=linux-centos8-skylake_avx512\r\nux5fqh6              ^gettext@0.21%gcc@8.5.0+bzip2+curses+git~libunistring+libxml2+tar+xz arch=linux-centos8-skylake_avx512\r\nysmxtkj                  ^libiconv@1.16%gcc@8.5.0 libs=shared,static arch=linux-centos8-skylake_avx512\r\nnfww7wt                  ^libxml2@2.9.12%gcc@8.5.0~python arch=linux-centos8-skylake_avx512\r\nfyvxmdw                      ^xz@5.2.4%gcc@8.5.0~pic libs=shared,static arch=linux-centos8-skylake_avx512\r\n3c6bs4y                      ^zlib@1.2.11%gcc@8.5.0+optimize+pic+shared arch=linux-centos8-skylake_avx512\r\nsaz7hgv                  ^tar@1.30%gcc@8.5.0 arch=linux-centos8-skylake_avx512\r\nsb2que5              ^libffi@3.3%gcc@8.5.0 patches=26f26c6f29a7ce9bf370ad3ab2610f99365b4bdd7b82e7c31df41a3370d685c0 arch=linux-centos8-skylake_avx512\r\ngqh6ofg              ^openssl@1.1.1l%gcc@8.5.0~docs certs=system arch=linux-centos8-skylake_avx512\r\njffhmjc              ^sqlite@3.36.0%gcc@8.5.0+column_metadata+fts~functions~rtree arch=linux-centos8-skylake_avx512\r\njxcbiki              ^util-linux-uuid@2.36.2%gcc@8.5.0 arch=linux-centos8-skylake_avx512\r\ntnof2u2          ^zip@3.0%gcc@8.5.0 patches=14dc88014812a896e5697553025f451435f69b1b541743f853b8dcae6b4dfe27,3bc30bafdfd29f1d26d1e0c4c7217def2ff5b37a715e482f83c5fefa2aa0ecb6,5068e7cb188e520da3cced095292ace13ad5e8321419127bf2ca095e148ab65a,51f48db588b17790aaf6b901d6ca737abdb20124210cf8def17d81841c013d13,66ab4ce03f342c6624aa14be5fa43b90e5608a4f6babcc9c3680828f2c246a74,a92fc4e4f59aa2ca3e8059c6b355ecce8c8c7802cb4f118756bf06eb51455549,a95ed93de9284ff68e835387ddb9ff62414712f9b95ec8e120f02cef8f26faca,eb83fc886ded7101ad8ddf10c025b1bd4d33b594766816cce65397d4f5c6a7b9,f7d0bc42e1db9564732ae0aa1ad238b7278a3e68eb0b05e16f1cb6507df2668d,fa8312c722a1cf774af588d5534745f2231130da0f40a44bba5b394eb13a5c64 arch=linux-centos8-skylake_avx512\r\nh3djhpp      ^flatbuffers@1.12.0%gcc@8.5.0~ipo+python+shared build_type=RelWithDebInfo arch=linux-centos8-skylake_avx512\r\nbypmp2b      ^hdf5@1.10.8%gcc@8.5.0~cxx~fortran+hl~ipo~java~mpi+shared~szip~threadsafe+tools api=default build_type=RelWithDebInfo arch=linux-centos8-skylake_avx512\r\nodrym52          ^pkgconf@1.4.2%gcc@8.5.0 arch=linux-centos8-skylake_avx512\r\ng5aoeo7      ^protobuf@3.18.0%gcc@8.5.0+shared build_type=Release arch=linux-centos8-skylake_avx512\r\n4div3nf      ^py-absl-py@0.13.0%gcc@8.5.0 arch=linux-centos8-skylake_avx512\r\nija4k5s          ^py-six@1.15.0%gcc@8.5.0 arch=linux-centos8-skylake_avx512\r\ns7zukah      ^py-astunparse@1.6.3%gcc@8.5.0 arch=linux-centos8-skylake_avx512\r\nx6od5ld          ^py-wheel@0.37.0%gcc@8.5.0 arch=linux-centos8-skylake_avx512\r\n2agcinf              ^py-setuptools@59.4.0%gcc@8.5.0 arch=linux-centos8-skylake_avx512\r\nyndqsoe      ^py-gast@0.3.3%gcc@8.5.0 arch=linux-centos8-skylake_avx512\r\nwaundln      ^py-google-pasta@0.2.0%gcc@8.5.0 arch=linux-centos8-skylake_avx512\r\nxasyl5c      ^py-grpcio@1.32.0%gcc@8.5.0 arch=linux-centos8-skylake_avx512\r\nicxltrn          ^c-ares@1.15.0%gcc@8.5.0~ipo build_type=RelWithDebInfo arch=linux-centos8-skylake_avx512\r\n7ivkunz          ^re2@2021-06-01%gcc@8.5.0~ipo+pic+shared build_type=RelWithDebInfo arch=linux-centos8-skylake_avx512\r\nnamatsl      ^py-h5py@2.10.0%gcc@8.5.0~mpi arch=linux-centos8-skylake_avx512\r\n5nxj7bc          ^py-numpy@1.19.5%gcc@8.5.0+blas+lapack patches=8a9d5d1b3f145c043b8b04869e7d46c6ff95c3f486d84f69693017c7e6190c7d arch=linux-centos8-skylake_avx512\r\n2bniubn              ^intel-oneapi-mkl@2022.0.1%gcc@8.5.0+cluster~ilp64+shared arch=linux-centos8-skylake_avx512\r\nzazrm3e                  ^intel-oneapi-tbb@2021.5.0%gcc@8.5.0 arch=linux-centos8-skylake_avx512\r\ngjuhtlo                  ^mpich@3.4.2%gcc@8.5.0~argobots+fortran+hwloc+hydra+libxml2+pci+romio~slurm~two_level_namespace~verbs+wrapperrpath device=ch4 netmod=ucx pmi=pmi arch=linux-centos8-skylake_avx512\r\njca73c4                      ^hwloc@2.2.0%gcc@8.5.0~cairo~cuda~gl~libudev+libxml2~netloc~nvml~opencl+pci~rocm+shared arch=linux-centos8-skylake_avx512\r\njf74kkw                      ^libpciaccess@0.16%gcc@8.5.0 arch=linux-centos8-skylake_avx512\r\nkenuzio                      ^ucx@1.11.0%gcc@8.5.0~assertions~cm~cma~cuda~dc~debug~dm~gdrcopy~ib-hw-tm~java~knem~logging~mlx5-dv+optimizations~parameter_checking+pic~rc~rocm~thread_multiple~ud~xpmem arch=linux-centos8-skylake_avx512\r\ndx7ttyt      ^py-keras-preprocessing@1.1.2%gcc@8.5.0 arch=linux-centos8-skylake_avx512\r\ngcg3jue      ^py-opt-einsum@3.3.0%gcc@8.5.0 arch=linux-centos8-skylake_avx512\r\nvsgz5sj      ^py-protobuf@3.17.3%gcc@8.5.0~cpp arch=linux-centos8-skylake_avx512\r\n4qmrzfl      ^py-termcolor@1.1.0%gcc@8.5.0 arch=linux-centos8-skylake_avx512\r\nvpvrci7      ^py-typing-extensions@3.7.4.3%gcc@8.5.0 arch=linux-centos8-skylake_avx512\r\nysta6id      ^py-wrapt@1.12.1%gcc@8.5.0 arch=linux-centos8-skylake_avx512\r\nu4pirvw      ^swig@4.0.2%gcc@8.5.0 arch=linux-centos8-skylake_avx512\r\nprs7qcn          ^pcre@8.44%gcc@8.5.0~jit+multibyte+utf arch=linux-centos8-skylake_avx512\r\n```\r\n\r\n\r\n### Error message\r\n\r\n<details><summary>Error message</summary>\r\n\r\n```console\r\n$ spack install --reuse  py-tensorflow~cuda~nccl^mpich\r\n[+] /pkg/spack-devel/opt/spack/linux-centos8-skylake_avx512/gcc-8.5.0/openjdk-11.0.12_7-4abfd4gz6warecdb25qs6chdfzsyopsm\r\n[+] /usr (external bzip2-1.0.6-rw4vhmyxpvkqctvg3lxld5jvnrf2qycu)\r\n[+] /pkg/spack-devel/opt/spack/linux-centos8-skylake_avx512/gcc-8.5.0/libmd-1.0.3-7jbwhjphctficzfhnfau4vojmyvmjvqt\r\n[+] /usr (external ncurses-6.1.20180224-qn5hgoyoai4inkvuzo5tfn57xnxetk45)\r\n[+] /pkg/spack-devel/opt/spack/linux-centos8-skylake_avx512/gcc-8.5.0/libiconv-1.16-ysmxtkjp6q3ms4z6mpjqfcyrjp6r55nr\r\n[+] /usr (external xz-5.2.4-fyvxmdw2cuaik3irtj5tidrlzchllcha)\r\n[+] /pkg/spack-devel/opt/spack/linux-centos8-skylake_avx512/gcc-8.5.0/zlib-1.2.11-3c6bs4ymmw5jrk25bfytaz2fxrd46z3c\r\n[+] /usr (external tar-1.30-saz7hgv7gnzalibu7nmsn7yxsgaz6m7q)\r\n[+] /pkg/spack-devel/opt/spack/linux-centos8-skylake_avx512/gcc-8.5.0/libffi-3.3-sb2que53wrgx7rcvesgrere4jcslwqb3\r\n[+] /pkg/spack-devel/opt/spack/linux-centos8-skylake_avx512/gcc-8.5.0/util-linux-uuid-2.36.2-jxcbiki2u3a7oiux4ix6cydrcfat3ipe\r\n[+] /usr (external pkgconf-1.4.2-odrym52v5kri73nhtczdmeojx63p4ryt)\r\n[+] /pkg/spack-devel/opt/spack/linux-centos8-skylake_avx512/gcc-8.5.0/c-ares-1.15.0-icxltrng6hh5ctc6wflyqoxeuyzzncny\r\n[+] /pkg/spack-devel/opt/spack/linux-centos8-skylake_avx512/gcc-8.5.0/re2-2021-06-01-7ivkunzkuke6jxuhxbbj3hr3t756z2z6\r\n[+] /pkg/spack-devel/opt/spack/linux-centos8-skylake_avx512/gcc-8.5.0/intel-oneapi-tbb-2021.5.0-zazrm3e2l5ujoaq7w2ftmiwgyhivhbr6\r\n[+] /usr (external hwloc-2.2.0-jca73c4crjx3hj6rozonrwabqpvwlhty)\r\n[+] /pkg/spack-devel/opt/spack/linux-centos8-skylake_avx512/gcc-8.5.0/libpciaccess-0.16-jf74kkwogvjr46ziyz7hr6tsbwfqs3eu\r\n[+] /usr (external ucx-1.11.0-kenuziopupdvgycbdzmsz4e554sv65kt)\r\n[+] /pkg/spack-devel/opt/spack/linux-centos8-skylake_avx512/gcc-8.5.0/pcre-8.44-prs7qcnpgmzwjtcsflkvbhpjq7gkrolr\r\n[+] /pkg/spack-devel/opt/spack/linux-centos8-skylake_avx512/gcc-8.5.0/zip-3.0-tnof2u2zf44sjukcv7lzjjbeuhkatdwp\r\n[+] /pkg/spack-devel/opt/spack/linux-centos8-skylake_avx512/gcc-8.5.0/libbsd-0.11.3-ysw6qfwvc7isxgtao27wgpjsdv3cuqzk\r\n[+] /pkg/spack-devel/opt/spack/linux-centos8-skylake_avx512/gcc-8.5.0/readline-8.1-7gdv6ylmqqsurcqme5fuexamhljsiks6\r\n[+] /pkg/spack-devel/opt/spack/linux-centos8-skylake_avx512/gcc-8.5.0/libxml2-2.9.12-nfww7wt55fonj4qvp25ply4daqden6pd\r\n[+] /pkg/spack-devel/opt/spack/linux-centos8-skylake_avx512/gcc-8.5.0/openssl-1.1.1l-gqh6ofgvnbcsac6khxoamb64uwogn5t5\r\n[+] /pkg/spack-devel/opt/spack/linux-centos8-skylake_avx512/gcc-8.5.0/protobuf-3.18.0-g5aoeo7fldoevii5qvusbtd2cssbooso\r\n[+] /pkg/spack-devel/opt/spack/linux-centos8-skylake_avx512/gcc-8.5.0/hdf5-1.10.8-bypmp2bbaubj74rfusnfcknd26fp6rxn\r\n[+] /pkg/spack-devel/opt/spack/linux-centos8-skylake_avx512/gcc-8.5.0/swig-4.0.2-u4pirvw3isndz6s7txmpptvkqfib3h7j\r\n[+] /pkg/spack-devel/opt/spack/linux-centos8-skylake_avx512/gcc-8.5.0/expat-2.4.1-g2ufnm36xfvm5xbm7cpeduqaanheiggc\r\n[+] /pkg/spack-devel/opt/spack/linux-centos8-skylake_avx512/gcc-8.5.0/gdbm-1.21-lmp7fbdqq5mzbtdsjsp5mzdi6pbmdz47\r\n[+] /pkg/spack-devel/opt/spack/linux-centos8-skylake_avx512/gcc-8.5.0/sqlite-3.36.0-jffhmjc44yx4w26uzab6ejzvxobwk5fo\r\n[+] /pkg/spack-devel/opt/spack/linux-centos8-skylake_avx512/gcc-8.5.0/mpich-3.4.2-gjuhtlo53leug3tx3u5ppzyghim34pp6\r\n[+] /pkg/spack-devel/opt/spack/linux-centos8-skylake_avx512/gcc-8.5.0/gettext-0.21-ux5fqh6atlrzidkvj6h7qipci37couaa\r\n[+] /pkg/spack-devel/opt/spack/linux-centos8-skylake_avx512/gcc-8.5.0/intel-oneapi-mkl-2022.0.1-2bniubnjfaohy2p4wewsaw7odhh2oce3\r\n[+] /pkg/spack-devel/opt/spack/linux-centos8-skylake_avx512/gcc-8.5.0/python-3.9.9-tr5gsofm5zpgjr7fswsajfcfpieukaxy\r\n[+] /pkg/spack-devel/opt/spack/linux-centos8-skylake_avx512/gcc-8.5.0/py-setuptools-59.4.0-2agcinfr6dghul3or5y2jgsqk7n525xd\r\n[+] /pkg/spack-devel/opt/spack/linux-centos8-skylake_avx512/gcc-8.5.0/py-six-1.15.0-ija4k5sumhkxgcczbuqtsixp75el5fc3\r\n[+] /pkg/spack-devel/opt/spack/linux-centos8-skylake_avx512/gcc-8.5.0/bazel-3.7.2-ocvloor5f2ljuc5eolhno5ouaftfwi2e\r\n[+] /pkg/spack-devel/opt/spack/linux-centos8-skylake_avx512/gcc-8.5.0/flatbuffers-1.12.0-h3djhppk35kdqk5taoktxbm2e2u4wwkf\r\n[+] /pkg/spack-devel/opt/spack/linux-centos8-skylake_avx512/gcc-8.5.0/py-typing-extensions-3.7.4.3-vpvrci7t6csbc4wm3e7plmzlzy6n2xvt\r\n[+] /pkg/spack-devel/opt/spack/linux-centos8-skylake_avx512/gcc-8.5.0/py-gast-0.3.3-yndqsoeej3djmsm4jipfybdhbty6islq\r\n[+] /pkg/spack-devel/opt/spack/linux-centos8-skylake_avx512/gcc-8.5.0/py-termcolor-1.1.0-4qmrzfl2lfqsilnboyhag4igll2ze37s\r\n[+] /pkg/spack-devel/opt/spack/linux-centos8-skylake_avx512/gcc-8.5.0/py-wrapt-1.12.1-ysta6idg2p3v5hlcs7c2kbmv2cyrn5cc\r\n[+] /pkg/spack-devel/opt/spack/linux-centos8-skylake_avx512/gcc-8.5.0/py-wheel-0.37.0-x6od5ldl6to6i7bvva3ptx6tbkvccagh\r\n[+] /pkg/spack-devel/opt/spack/linux-centos8-skylake_avx512/gcc-8.5.0/py-numpy-1.19.5-5nxj7bczh3gtzvtpboaysyaj6wqztiqg\r\n[+] /pkg/spack-devel/opt/spack/linux-centos8-skylake_avx512/gcc-8.5.0/py-protobuf-3.17.3-vsgz5sjghqjmif36jloks4obxm3imc6i\r\n[+] /pkg/spack-devel/opt/spack/linux-centos8-skylake_avx512/gcc-8.5.0/py-google-pasta-0.2.0-waundln5u7lszbvzow3s2ymxtcq7annc\r\n[+] /pkg/spack-devel/opt/spack/linux-centos8-skylake_avx512/gcc-8.5.0/py-absl-py-0.13.0-4div3nffr7ca2osebrcbgqnr7waeiy7i\r\n[+] /pkg/spack-devel/opt/spack/linux-centos8-skylake_avx512/gcc-8.5.0/py-grpcio-1.32.0-xasyl5ccaduepaoft2wtbearm4nafiti\r\n[+] /pkg/spack-devel/opt/spack/linux-centos8-skylake_avx512/gcc-8.5.0/py-astunparse-1.6.3-s7zukahuvpidy67liiyku77o46wtgvch\r\n[+] /pkg/spack-devel/opt/spack/linux-centos8-skylake_avx512/gcc-8.5.0/py-opt-einsum-3.3.0-gcg3juesleuaaodcpbm3rm4izo7voasi\r\n[+] /pkg/spack-devel/opt/spack/linux-centos8-skylake_avx512/gcc-8.5.0/py-h5py-2.10.0-namatslgd2ejackcrx65de2vcbkgjtk5\r\n[+] /pkg/spack-devel/opt/spack/linux-centos8-skylake_avx512/gcc-8.5.0/py-keras-preprocessing-1.1.2-dx7ttytxwzlvp4bbc2siyiwgjhw7ybof\r\n==> Installing py-tensorflow-2.4.1-gus7lzsme2tr6ism52vws7fzcwclqgs3\r\n==> No binary for py-tensorflow-2.4.1-gus7lzsme2tr6ism52vws7fzcwclqgs3 found: installing from source\r\n==> Using cached archive: /pkg/spack-devel/var/spack/cache/_source-cache/archive/f6/f681331f8fc0800883761c7709d13cda11942d4ad5ff9f44ad855e9dc78387e0.tar.gz\r\n==> Ran patch() for py-tensorflow\r\n==> py-tensorflow: Executing phase: 'configure'\r\n==> py-tensorflow: Executing phase: 'build'\r\n==> Error: ProcessError: Command exited with status 1:\r\n    'bazel' '--nohome_rc' '--nosystem_rc' '--output_user_root=/tmp/spack9gceh2c0' 'build' '--color=no' '--jobs=16' '--config=opt' '--verbose_failures' '--subcommands=pretty_print' '--explain=explainlogfile.txt' '--verbose_explanations' '--config=noaws' '--config=nogcp' '--config=nohdfs' '--config=nonccl' '--config=v2' '//tensorflow/tools/pip_package:build_pip_package'\r\n\r\n11 errors found in build log:\r\n     53        Loading: 0 packages loaded\r\n     54        Loading: 0 packages loaded\r\n     55        Loading: 0 packages loaded\r\n     56        Loading: 0 packages loaded\r\n     57        DEBUG: Rule 'io_bazel_rules_go' indicated that a canonical repro\r\n               ducible form can be obtained by modifying arguments shallow_sinc\r\n               e = \"1557349968 -0400\"\r\n     58        DEBUG: Repository io_bazel_rules_go instantiated at:\r\n  >> 59        /tmp/vastdata/spack-stage/spack-stage-py-tensorflow-2.4.1-gus7lz\r\n               sme2tr6ism52vws7fzcwclqgs3/spack-src/WORKSPACE:37:30: in <toplev\r\n               el>\r\n  >> 60          /tmp/spack9gceh2c0/522229e8c405f4306a6fb771a154a936/external/b\r\n               azel_toolchains/repositories/repositories.bzl:55:23: in reposito\r\n               ries\r\n     61        Repository rule git_repository defined at:\r\n  >> 62          /tmp/spack9gceh2c0/522229e8c405f4306a6fb771a154a936/external/b\r\n               azel_tools/tools/build_defs/repo/git.bzl:199:33: in <toplevel>\r\n     63        Loading: 0 packages loaded\r\n     64        Analyzing: target //tensorflow/tools/pip_package:build_pip_packa\r\n               ge (1 packages loaded, 0 targets configured)\r\n     65        Analyzing: target //tensorflow/tools/pip_package:build_pip_packa\r\n               ge (51 packages loaded, 14 targets configured)\r\n     66        Analyzing: target //tensorflow/tools/pip_package:build_pip_packa\r\n               ge (215 packages loaded, 4009 targets configured)\r\n     67        DEBUG: Rule 'io_bazel_rules_docker' indicated that a canonical r\r\n               eproducible form can be obtained by modifying arguments shallow_\r\n               since = \"1556410077 -0400\"\r\n     68        DEBUG: Repository io_bazel_rules_docker instantiated at:\r\n  >> 69        /tmp/vastdata/spack-stage/spack-stage-py-tensorflow-2.4.1-gus7lz\r\n               sme2tr6ism52vws7fzcwclqgs3/spack-src/WORKSPACE:37:30: in <toplev\r\n               el>\r\n  >> 70          /tmp/spack9gceh2c0/522229e8c405f4306a6fb771a154a936/external/b\r\n               azel_toolchains/repositories/repositories.bzl:37:23: in reposito\r\n               ries\r\n     71        Repository rule git_repository defined at:\r\n  >> 72          /tmp/spack9gceh2c0/522229e8c405f4306a6fb771a154a936/external/b\r\n               azel_tools/tools/build_defs/repo/git.bzl:199:33: in <toplevel>\r\n     73        Analyzing: target //tensorflow/tools/pip_package:build_pip_packa\r\n               ge (221 packages loaded, 4028 targets configured)\r\n     74        Analyzing: target //tensorflow/tools/pip_package:build_pip_packa\r\n               ge (222 packages loaded, 4028 targets configured)\r\n     75        Analyzing: target //tensorflow/tools/pip_package:build_pip_packa\r\n               ge (222 packages loaded, 4028 targets configured)\r\n     76        Analyzing: target //tensorflow/tools/pip_package:build_pip_packa\r\n               ge (223 packages loaded, 4028 targets configured)\r\n     77        Analyzing: target //tensorflow/tools/pip_package:build_pip_packa\r\n               ge (388 packages loaded, 19757 targets configured)\r\n     78        Analyzing: target //tensorflow/tools/pip_package:build_pip_packa\r\n               ge (388 packages loaded, 19762 targets configured)\r\n\r\n     ...\r\n\r\n     246650        '-D__TIMESTAMP__=\"redacted\"' \\\r\n     246651        '-D__TIME__=\"redacted\"' \\\r\n     246652        -c \\\r\n     246653        tensorflow/core/kernels/quantize_down_and_shrink_range.cc \\\r\n     246654        -o \\\r\n     246655        bazel-out/host/bin/tensorflow/core/kernels/_objs/quantized_o\r\n               ps/quantize_down_and_shrink_range.pic.o)\r\n  >> 246656    ERROR: /tmp/vastdata/spack-stage/spack-stage-py-tensorflow-2.4.1\r\n               -gus7lzsme2tr6ism52vws7fzcwclqgs3/spack-src/tensorflow/core/kern\r\n               els/BUILD:4391:18: C++ compilation of rule '//tensorflow/core/ke\r\n               rnels:example_parsing_ops' failed (Exit 1): gcc failed: error ex\r\n               ecuting command\r\n     246657      (cd /tmp/spack9gceh2c0/522229e8c405f4306a6fb771a154a936/execro\r\n               ot/org_tensorflow && \\\r\n     246658      exec env - \\\r\n     246659        PATH=/pkg/spack-devel/opt/spack/linux-centos8-skylake_avx512\r\n               /gcc-8.5.0/swig-4.0.2-u4pirvw3isndz6s7txmpptvkqfib3h7j/bin:/pkg/\r\n               spack-devel/opt/spack/linux-centos8-skylake_avx512/gcc-8.5.0/py-\r\n               numpy-1.19.5-5nxj7bczh3gtzvtpboaysyaj6wqztiqg/bin:/pkg/spack-dev\r\n               el/opt/spack/linux-centos8-skylake_avx512/gcc-8.5.0/py-wheel-0.3\r\n               7.0-x6od5ldl6to6i7bvva3ptx6tbkvccagh/bin:/pkg/spack-devel/opt/sp\r\n               ack/linux-centos8-skylake_avx512/gcc-8.5.0/protobuf-3.18.0-g5aoe\r\n               o7fldoevii5qvusbtd2cssbooso/bin:/pkg/spack-devel/opt/spack/linux\r\n               -centos8-skylake_avx512/gcc-8.5.0/hdf5-1.10.8-bypmp2bbaubj74rfus\r\n               nfcknd26fp6rxn/bin:/pkg/spack-devel/opt/spack/linux-centos8-skyl\r\n               ake_avx512/gcc-8.5.0/flatbuffers-1.12.0-h3djhppk35kdqk5taoktxbm2\r\n               e2u4wwkf/bin:/pkg/spack-devel/opt/spack/linux-centos8-skylake_av\r\n               x512/gcc-8.5.0/bazel-3.7.2-ocvloor5f2ljuc5eolhno5ouaftfwi2e/bin:\r\n               /pkg/spack-devel/opt/spack/linux-centos8-skylake_avx512/gcc-8.5.\r\n               0/zip-3.0-tnof2u2zf44sjukcv7lzjjbeuhkatdwp/bin:/pkg/spack-devel/\r\n               opt/spack/linux-centos8-skylake_avx512/gcc-8.5.0/python-3.9.9-tr\r\n               5gsofm5zpgjr7fswsajfcfpieukaxy/bin:/pkg/spack-devel/opt/spack/li\r\n               nux-centos8-skylake_avx512/gcc-8.5.0/python-3.9.9-tr5gsofm5zpgjr\r\n               7fswsajfcfpieukaxy/bin:/pkg/spack-devel/opt/spack/linux-centos8-\r\n               skylake_avx512/gcc-8.5.0/openjdk-11.0.12_7-4abfd4gz6warecdb25qs6\r\n               chdfzsyopsm/bin:/pkg/spack-devel/lib/spack/env/gcc:/pkg/spack-de\r\n               vel/lib/spack/env/case-insensitive:/pkg/spack-devel/lib/spack/en\r\n               v:/pkg/spack-devel/bin:/home/vastdata/.local/bin:/home/vastdata/\r\n               bin:.:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin \\\r\n     246660        PWD=/proc/self/cwd \\\r\n     246661        SPACK_CC=/usr/bin/gcc \\\r\n     246662        SPACK_CC_RPATH_ARG=-Wl,-rpath, \\\r\n\r\n     ...\r\n\r\n     246684      /pkg/spack-devel/lib/spack/env/gcc/gcc -U_FORTIFY_SOURCE -fsta\r\n               ck-protector -Wall -Wunused-but-set-parameter -Wno-free-nonheap-\r\n               object -fno-omit-frame-pointer -g0 -O2 '-D_FORTIFY_SOURCE=1' -DN\r\n               DEBUG -ffunction-sections -fdata-sections '-std=c++0x' -MD -MF b\r\n               azel-out/host/bin/tensorflow/core/kernels/_objs/example_parsing_\r\n               ops/example_parsing_ops.pic.d '-frandom-seed=bazel-out/host/bin/\r\n               tensorflow/core/kernels/_objs/example_parsing_ops/example_parsin\r\n               g_ops.pic.o' -fPIC -DHAVE_SYS_UIO_H -DTF_USE_SNAPPY -DEIGEN_MPL2\r\n               _ONLY '-DEIGEN_MAX_ALIGN_BYTES=64' '-DEIGEN_HAS_TYPE_TRAITS=0' -\r\n               D__CLANG_SUPPORT_DYN_ANNOTATION__ -iquote . -iquote bazel-out/ho\r\n               st/bin -iquote external/com_google_absl -iquote bazel-out/host/b\r\n               in/external/com_google_absl -iquote external/nsync -iquote bazel\r\n               -out/host/bin/external/nsync -iquote external/eigen_archive -iqu\r\n               ote bazel-out/host/bin/external/eigen_archive -iquote external/g\r\n               if -iquote bazel-out/host/bin/external/gif -iquote external/libj\r\n               peg_turbo -iquote bazel-out/host/bin/external/libjpeg_turbo -iqu\r\n               ote external/com_google_protobuf -iquote bazel-out/host/bin/exte\r\n               rnal/com_google_protobuf -iquote external/com_googlesource_code_\r\n               re2 -iquote bazel-out/host/bin/external/com_googlesource_code_re\r\n               2 -iquote external/farmhash_archive -iquote bazel-out/host/bin/e\r\n               xternal/farmhash_archive -iquote external/fft2d -iquote bazel-ou\r\n               t/host/bin/external/fft2d -iquote external/highwayhash -iquote b\r\n               azel-out/host/bin/external/highwayhash -iquote external/zlib -iq\r\n               uote bazel-out/host/bin/external/zlib -iquote external/double_co\r\n               nversion -iquote bazel-out/host/bin/external/double_conversion -\r\n               iquote external/snappy -iquote bazel-out/host/bin/external/snapp\r\n               y -isystem external/nsync/public -isystem bazel-out/host/bin/ext\r\n               ernal/nsync/public -isystem external/eigen_archive -isystem baze\r\n               l-out/host/bin/external/eigen_archive -isystem external/gif -isy\r\n               stem bazel-out/host/bin/external/gif -isystem external/farmhash_\r\n               archive/src -isystem bazel-out/host/bin/external/farmhash_archiv\r\n               e/src -isystem external/zlib -isystem bazel-out/host/bin/externa\r\n               l/zlib -isystem external/double_conversion -isystem bazel-out/ho\r\n               st/bin/external/double_conversion -g0 -w '-march=skylake-avx512'\r\n                '-mtune=skylake-avx512' -g0 '-std=c++14' -DEIGEN_AVOID_STL_ARRA\r\n               Y -Iexternal/gemmlowp -Wno-sign-compare '-ftemplate-depth=900' -\r\n               fno-exceptions -msse3 -pthread -fno-canonical-system-headers -Wn\r\n               o-builtin-macro-redefined '-D__DATE__=\"redacted\"' '-D__TIMESTAMP\r\n               __=\"redacted\"' '-D__TIME__=\"redacted\"' -c tensorflow/core/kernel\r\n               s/example_parsing_ops.cc -o bazel-out/host/bin/tensorflow/core/k\r\n               ernels/_objs/example_parsing_ops/example_parsing_ops.pic.o)\r\n     246685    Execution platform: @local_execution_config_platform//:platform\r\n     246686    In file included from ./tensorflow/core/framework/numeric_op_bas\r\n               e.h:19,\r\n     246687                     from ./tensorflow/core/framework/numeric_op.h:1\r\n               8,\r\n     246688                     from tensorflow/core/kernels/example_parsing_op\r\n               s.cc:27:\r\n     246689    tensorflow/core/kernels/example_parsing_ops.cc: In member functi\r\n               on 'virtual void tensorflow::DecodeJSONExampleOp::Compute(tensor\r\n               flow::OpKernelContext*)':\r\n  >> 246690    tensorflow/core/kernels/example_parsing_ops.cc:1221:57: error: '\r\n               class google::protobuf::util::status_internal::Status' has no me\r\n               mber named 'error_message'; did you mean 'error_message_'?\r\n     246691                                               string(status.error_m\r\n               essage())));\r\n     246692                                                             ^~~~~~~\r\n               ~~~~~~\r\n     246693    ./tensorflow/core/framework/op_requires.h:45:46: note: in defini\r\n               tion of macro 'OP_REQUIRES'\r\n     246694           (CTX)->CtxFailure(__FILE__, __LINE__, (STATUS));    \\\r\n     246695                                                  ^~~~~~\r\n     246696    Target //tensorflow/tools/pip_package:build_pip_package failed t\r\n               o build\r\n  >> 246697    ERROR: /tmp/vastdata/spack-stage/spack-stage-py-tensorflow-2.4.1\r\n               -gus7lzsme2tr6ism52vws7fzcwclqgs3/spack-src/tensorflow/python/to\r\n               ols/BUILD:99:10 C++ compilation of rule '//tensorflow/core/kerne\r\n               ls:example_parsing_ops' failed (Exit 1): gcc failed: error execu\r\n               ting command\r\n     246698      (cd /tmp/spack9gceh2c0/522229e8c405f4306a6fb771a154a936/execro\r\n               ot/org_tensorflow && \\\r\n     246699      exec env - \\\r\n     246700        PATH=/pkg/spack-devel/opt/spack/linux-centos8-skylake_avx512\r\n               /gcc-8.5.0/swig-4.0.2-u4pirvw3isndz6s7txmpptvkqfib3h7j/bin:/pkg/\r\n               spack-devel/opt/spack/linux-centos8-skylake_avx512/gcc-8.5.0/py-\r\n               numpy-1.19.5-5nxj7bczh3gtzvtpboaysyaj6wqztiqg/bin:/pkg/spack-dev\r\n               el/opt/spack/linux-centos8-skylake_avx512/gcc-8.5.0/py-wheel-0.3\r\n               7.0-x6od5ldl6to6i7bvva3ptx6tbkvccagh/bin:/pkg/spack-devel/opt/sp\r\n               ack/linux-centos8-skylake_avx512/gcc-8.5.0/protobuf-3.18.0-g5aoe\r\n               o7fldoevii5qvusbtd2cssbooso/bin:/pkg/spack-devel/opt/spack/linux\r\n               -centos8-skylake_avx512/gcc-8.5.0/hdf5-1.10.8-bypmp2bbaubj74rfus\r\n               nfcknd26fp6rxn/bin:/pkg/spack-devel/opt/spack/linux-centos8-skyl\r\n               ake_avx512/gcc-8.5.0/flatbuffers-1.12.0-h3djhppk35kdqk5taoktxbm2\r\n               e2u4wwkf/bin:/pkg/spack-devel/opt/spack/linux-centos8-skylake_av\r\n               x512/gcc-8.5.0/bazel-3.7.2-ocvloor5f2ljuc5eolhno5ouaftfwi2e/bin:\r\n               /pkg/spack-devel/opt/spack/linux-centos8-skylake_avx512/gcc-8.5.\r\n               0/zip-3.0-tnof2u2zf44sjukcv7lzjjbeuhkatdwp/bin:/pkg/spack-devel/\r\n               opt/spack/linux-centos8-skylake_avx512/gcc-8.5.0/python-3.9.9-tr\r\n               5gsofm5zpgjr7fswsajfcfpieukaxy/bin:/pkg/spack-devel/opt/spack/li\r\n               nux-centos8-skylake_avx512/gcc-8.5.0/python-3.9.9-tr5gsofm5zpgjr\r\n               7fswsajfcfpieukaxy/bin:/pkg/spack-devel/opt/spack/linux-centos8-\r\n               skylake_avx512/gcc-8.5.0/openjdk-11.0.12_7-4abfd4gz6warecdb25qs6\r\n               chdfzsyopsm/bin:/pkg/spack-devel/lib/spack/env/gcc:/pkg/spack-de\r\n               vel/lib/spack/env/case-insensitive:/pkg/spack-devel/lib/spack/en\r\n               v:/pkg/spack-devel/bin:/home/vastdata/.local/bin:/home/vastdata/\r\n               bin:.:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin \\\r\n     246701        PWD=/proc/self/cwd \\\r\n     246702        SPACK_CC=/usr/bin/gcc \\\r\n     246703        SPACK_CC_RPATH_ARG=-Wl,-rpath, \\\r\n\r\n     ...\r\n\r\n     246723        SPACK_SYSTEM_DIRS=/bin:/usr/bin:/usr/local/bin:/bin64:/usr/b\r\n               in64:/usr/local/bin64:/include:/usr/include:/usr/local/include:/\r\n               lib:/usr/lib:/usr/local/lib:/lib64:/usr/lib64:/usr/local/lib64:/\r\n               :/usr:/usr/local \\\r\n     246724        SPACK_TARGET_ARGS='-march=skylake-avx512 -mtune=skylake-avx5\r\n               12' \\\r\n     246725      /pkg/spack-devel/lib/spack/env/gcc/gcc -U_FORTIFY_SOURCE -fsta\r\n               ck-protector -Wall -Wunused-but-set-parameter -Wno-free-nonheap-\r\n               object -fno-omit-frame-pointer -g0 -O2 '-D_FORTIFY_SOURCE=1' -DN\r\n               DEBUG -ffunction-sections -fdata-sections '-std=c++0x' -MD -MF b\r\n               azel-out/host/bin/tensorflow/core/kernels/_objs/example_parsing_\r\n               ops/example_parsing_ops.pic.d '-frandom-seed=bazel-out/host/bin/\r\n               tensorflow/core/kernels/_objs/example_parsing_ops/example_parsin\r\n               g_ops.pic.o' -fPIC -DHAVE_SYS_UIO_H -DTF_USE_SNAPPY -DEIGEN_MPL2\r\n               _ONLY '-DEIGEN_MAX_ALIGN_BYTES=64' '-DEIGEN_HAS_TYPE_TRAITS=0' -\r\n               D__CLANG_SUPPORT_DYN_ANNOTATION__ -iquote . -iquote bazel-out/ho\r\n               st/bin -iquote external/com_google_absl -iquote bazel-out/host/b\r\n               in/external/com_google_absl -iquote external/nsync -iquote bazel\r\n               -out/host/bin/external/nsync -iquote external/eigen_archive -iqu\r\n               ote bazel-out/host/bin/external/eigen_archive -iquote external/g\r\n               if -iquote bazel-out/host/bin/external/gif -iquote external/libj\r\n               peg_turbo -iquote bazel-out/host/bin/external/libjpeg_turbo -iqu\r\n               ote external/com_google_protobuf -iquote bazel-out/host/bin/exte\r\n               rnal/com_google_protobuf -iquote external/com_googlesource_code_\r\n               re2 -iquote bazel-out/host/bin/external/com_googlesource_code_re\r\n               2 -iquote external/farmhash_archive -iquote bazel-out/host/bin/e\r\n               xternal/farmhash_archive -iquote external/fft2d -iquote bazel-ou\r\n               t/host/bin/external/fft2d -iquote external/highwayhash -iquote b\r\n               azel-out/host/bin/external/highwayhash -iquote external/zlib -iq\r\n               uote bazel-out/host/bin/external/zlib -iquote external/double_co\r\n               nversion -iquote bazel-out/host/bin/external/double_conversion -\r\n               iquote external/snappy -iquote bazel-out/host/bin/external/snapp\r\n               y -isystem external/nsync/public -isystem bazel-out/host/bin/ext\r\n               ernal/nsync/public -isystem external/eigen_archive -isystem baze\r\n               l-out/host/bin/external/eigen_archive -isystem external/gif -isy\r\n               stem bazel-out/host/bin/external/gif -isystem external/farmhash_\r\n               archive/src -isystem bazel-out/host/bin/external/farmhash_archiv\r\n               e/src -isystem external/zlib -isystem bazel-out/host/bin/externa\r\n               l/zlib -isystem external/double_conversion -isystem bazel-out/ho\r\n               st/bin/external/double_conversion -g0 -w '-march=skylake-avx512'\r\n                '-mtune=skylake-avx512' -g0 '-std=c++14' -DEIGEN_AVOID_STL_ARRA\r\n               Y -Iexternal/gemmlowp -Wno-sign-compare '-ftemplate-depth=900' -\r\n               fno-exceptions -msse3 -pthread -fno-canonical-system-headers -Wn\r\n               o-builtin-macro-redefined '-D__DATE__=\"redacted\"' '-D__TIMESTAMP\r\n               __=\"redacted\"' '-D__TIME__=\"redacted\"' -c tensorflow/core/kernel\r\n               s/example_parsing_ops.cc -o bazel-out/host/bin/tensorflow/core/k\r\n               ernels/_objs/example_parsing_ops/example_parsing_ops.pic.o)\r\n     246726    Execution platform: @local_execution_config_platform//:platform\r\n     246727    INFO: Elapsed time: 531.149s, Critical Path: 100.64s\r\n     246728    INFO: 3164 processes: 598 internal, 2566 local.\r\n  >> 246729    FAILED: Build did NOT complete successfully\r\n  >> 246730    FAILED: Build did NOT complete successfully\r\n\r\nSee build log for details:\r\n  /tmp/vastdata/spack-stage/spack-stage-py-tensorflow-2.4.1-gus7lzsme2tr6ism52vws7fzcwclqgs3/spack-build-out.txt\r\n```\r\n\r\n</details>\r\n\r\n\r\n### Information on your system\r\n\r\n* **Spack:** 0.17.1-681-fc9bfe5317\r\n* **Python:** 3.6.8\r\n* **Platform:** linux-centos8-cascadelake\r\n* **Concretizer:** clingo\r\n\r\n\r\n### Additional information\r\n\r\n[spack-build-out.txt](https://github.com/spack/spack/files/8170365/spack-build-out.txt)\r\n[spack-build-env.txt](https://github.com/spack/spack/files/8170367/spack-build-env.txt)\r\n[spack-build-02-build-out.txt](https://github.com/spack/spack/files/8170368/spack-build-02-build-out.txt)\r\n[spack-build-01-configure-out.txt](https://github.com/spack/spack/files/8170372/spack-build-01-configure-out.txt)\r\n[spack-build-env-mods.txt](https://github.com/spack/spack/files/8170375/spack-build-env-mods.txt)\r\n\r\n@adamjstewart and @aweits I have looked at similar issues in the past and the solutions suggested at the spack command line level do not seem to work. Other cases that have failed:\r\n```\r\nspack install --reuse  py-tensorflow~cuda+jemalloc+mkl~nccl+ngraph+numa+xla^mpich\r\nspack install --reuse  py-tensorflow~cuda+jemalloc+mkl~nccl+numa+xla^mpich\r\nspack install --reuse  py-tensorflow~cuda+jemalloc+mkl~nccl+numa+xla^mpich^bazel@0.29.1\r\n```\r\n\r\n\r\n### General information\r\n\r\n- [X] I have run `spack debug report` and reported the version of Spack/Python/Platform\r\n- [X] I have run `spack maintainers <name-of-the-package>` and **@mentioned** any maintainers\r\n- [X] I have uploaded the build log and environment files\r\n- [X] I have searched the issues of this repo and believe this is not a duplicate",
    "user": "ce107",
    "url": "https://api.github.com/repos/spack/spack/issues/29292",
    "updated_at": "2022-03-03 21:03:51",
    "created_at": "2022-03-02 14:55:18",
    "closed_at": "None",
    "state": "open",
    "title": "Installation issue: py-tensorflow on x86_64 and RHEL8 with cpu-only",
    "number": 29292,
    "milestone": null,
    "labels": [
        "build-error"
    ],
    "id": 1157305204,
    "html_url": "https://github.com/spack/spack/issues/29292",
    "assignees": [
        "adamjstewart"
    ],
    "comments": 0
}