{
    "body": "<!-- Thanks for taking the time to report this build failure. To proceed with the report please:\r\n\r\n1. Title the issue \"Installation issue: <name-of-the-package>\".\r\n2. Provide the information required below.\r\n\r\nWe encourage you to try, as much as possible, to reduce your problem to the minimal example that still reproduces the issue. That would help us a lot in fixing it quickly and effectively! -->\r\n\r\n### Steps to reproduce the issue\r\n\r\n<!-- Fill in the exact spec you are trying to build and the relevant part of the error message -->\r\n\r\n```console\r\n$ spack spec hypre\r\nInput spec\r\n--------------------------------\r\nhypre\r\n\r\nConcretized\r\n--------------------------------\r\nhypre@2.20.0%oneapi@2021.2.0~complex~cuda~debug~int64~internal-superlu~mixedint+mpi~openmp+shared~superlu-dist cuda_arch=none patches=6e3336b1d62155f6350dfe42b0f9ea25d4fa0af60c7e540959139deb93a26059 arch=linux-opensuse_leap15-cascadelake\r\n    ^mpich@3.3.2%oneapi@2021.2.0~argobots+fortran+hwloc+hydra+libxml2+pci+romio~slurm~verbs~wrapperrpath device=ch4 netmod=ofi patches=eb982de3366d48cbc55eb5e0df43373a45d9f51df208abf0835a72dc6c0b4774 pmi=pmi arch=linux-opensuse_leap15-cascadelake\r\n    ^openblas@0.3.10%oneapi@2021.2.0~consistent_fpcsr~ilp64+locking+pic+shared patches=865703b4f405543bbd583413fdeff2226dfda908be33639276c06e5aa7ae2cae threads=none arch=linux-opensuse_leap15-cascadelake\r\n$ spack install hypre\r\n\r\n```\r\n\r\n### Information on your system\r\n\r\n<!-- Please include the output of `spack debug report` -->\r\n* **Spack:** 0.16.1-1521-b56d65fce5\r\n* **Python:** 3.6.12\r\n* **Platform:** linux-opensuse_leap15-zen2\r\n* **Concretizer:** original\r\n\r\n<!-- If you have any relevant configuration detail (custom `packages.yaml` or `modules.yaml`, etc.) you can add that here as well. -->\r\n\r\nUsing this environment:\r\n[spack.yaml.txt](https://github.com/spack/spack/files/6229932/spack.yaml.txt)\r\n\r\nAnd this compiler stanza:\r\n\r\n```\r\n- compiler:\r\n    spec: oneapi@2021.2.0\r\n    paths:\r\n      cc: /soft/<full path hidden per NDA>/oneapi/bin/icx\r\n      cxx: /soft/<full path hidden per NDA>/oneapi/bin/icpx\r\n      f77: /soft/<full path hidden per NDA>/oneapi/bin/ifx\r\n      fc: /soft/<full path hidden per NDA>/oneapi/bin/ifx\r\n    flags: {}\r\n    operating_system: opensuse_leap15\r\n    target: x86_64\r\n    modules:\r\n    - /soft/<full path hidden per NDA>/aurora_mpich/icc-sockets-debug/39.2\r\n    environment: \r\n      append_path:\r\n        LD_LIBRARY_PATH: /soft/<full path hidden per NDA>/compiler/20210130/linux/compiler/lib/intel64_lin\r\n    extra_rpaths: []\r\n```\r\n\r\nHere is the offending piece from the configure log. Autoconf 2.69 causes the erroneous -loopopt=0 option to be generated, 2.70 does not:\r\n\r\n```\r\nconfigure:6510: /soft/<full path hidden per NDA>/mpich-ofi-sockets-icc-debug-gen9-drop39/bin/mpicc -o conftest -g -O2   conftest.c   -loopopt=0 -L/soft/restricted/CNDA/sdk/2020.12.15.1-ats/oneapi/compiler/20210130/linux/compiler/lib/intel64_lin -L/soft/<full path hidden per NDA>/oneapi/compiler/20210130/linux/lib -L/soft/packaging/spack-builds/linux-rhel7-x86_64/gcc-9.3.0/gcc-9.3.0-qfmcwfbuvnpn47zxjzfjvodzjl6reerh/lib/gcc/x86_64-pc-linux-gnu/9.3.0/../../../../lib64 -L/soft/packaging/spack-builds/linux-rhel7-x86_64/gcc-9.3.0/gcc-9.3.0-qfmcwfbuvnpn47zxjzfjvodzjl6reerh/lib/gcc/x86_64-pc-linux-gnu/9.3.0/../../../../lib64/ -L/lib/../lib64 -L/lib/../lib64/ -L/usr/lib/../lib64 -L/usr/lib/../lib64/ -L/soft/packaging/spack-builds/linux-rhel7-x86_64/gcc-9.3.0/binutils-2.34-rnwhrdgiqluqiypg5palnxdxviv3mynt/lib/../x86_64-pc-linux-gnu/lib/ -L/soft/packaging/spack-builds/linux-rhel7-x86_64/gcc-9.3.0/gcc-9.3.0-qfmcwfbuvnpn47zxjzfjvodzjl6reerh/lib/gcc/x86_64-pc-linux-gnu/9.3.0/../../../ -L/lib64 -L/lib/ -L/usr/lib64 -L/usr/lib -lifport -lifcoremt -limf -lsvml -lm -lipgo -lirc -lpthread -lirc_s -ldl >&5\r\n/soft/packaging/spack-builds/linux-rhel7-x86_64/gcc-9.3.0/binutils-2.34-rnwhrdgiqluqiypg5palnxdxviv3mynt/bin/ld: cannot find -loopopt=0\r\nclang-12: error: linker command failed with exit code 1 (use -v to see invocation)\r\n```\r\n\r\n### Additional information\r\n\r\nThe issue is described on an Intel forum, and updating to autoconf 2.70 is the recommended fix:\r\n\r\nhttps://community.intel.com/t5/Intel-Fortran-Compiler/ifx-2021-1-beta04-HPC-Toolkit-build-error-with-loopopt/m-p/1235375#M153121\r\n\r\n<!-- Please upload the following files. They should be present in the stage directory of the failing build. Also upload any config.log or similar file if one exists. -->\r\n* [spack-build-out.txt]()\r\n* [spack-build-env.txt]()\r\nThese files contain NDA info and cannot be shared, however the above excerpt captures the issue.\r\n\r\n<!-- Some packages have maintainers who have volunteered to debug build failures. Run `spack maintainers <name-of-the-package>` and @mention them here if they exist. -->\r\nmaintainers: @balay @osborn9 @ulrikeyang\r\n\r\n### General information\r\n\r\n<!-- These boxes can be checked by replacing [ ] with [x] or by clicking them after submitting the issue. -->\r\n- [x] I have run `spack debug report` and reported the version of Spack/Python/Platform\r\n- [x] I have run `spack maintainers <name-of-the-package>` and @mentioned any maintainers\r\n- [*] I have uploaded the build log and environment files\r\n- [x] I have searched the issues of this repo and believe this is not a duplicate\r\n\r\n",
    "user": "frankwillmore",
    "url": "https://api.github.com/repos/spack/spack/issues/22643",
    "updated_at": "2021-03-31 21:47:39",
    "created_at": "2021-03-30 15:05:05",
    "closed_at": "2021-03-31 21:47:38",
    "state": "closed",
    "title": "Installation issue: hypre needs to be repackaged with autoconf@2.70 or newer to use oneapi fortran",
    "number": 22643,
    "milestone": null,
    "labels": [
        "compilers",
        "build-error",
        "autotools",
        "ecp",
        "e4s",
        "alcf",
        "oneapi",
        "fortran"
    ],
    "id": 844702417,
    "html_url": "https://github.com/spack/spack/issues/22643",
    "assignees": [
        "balay"
    ],
    "comments": 2
}