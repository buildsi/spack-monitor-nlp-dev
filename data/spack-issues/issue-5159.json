{
    "body": "I failed to build opencv on CentOS 7 with GCC-5.4. Error messages said `CMake Error: INSTALL(EXPORT) given unknown export \"OpenCVModules\"`. The workaround show in http://answers.opencv.org/question/28283/cmake-error-installexport-given-unknown-export-opencvmodules/ worked for me. After adding `+core` spec, opencv has been built successfully.\r\n\r\nI'd like to submit a PR in which `+core` is set to TRUE in opencv by default.\r\n\r\n```\r\n$ spack install opencv~eigen %gcc@5.4.0\r\n==> cmake@3.8.1 : externally installed in /lustre/spack/tools/linux-centos7-x86_64/gcc-4.8.5/cmake-3.8.1-gxy3e7idb3\r\nna7wynpn55u3esttis67xw                                                                                             \r\n==> cmake@3.8.1 : already registered in DB                                                                         \r\n==> jasper is already installed in /lustre/home/acct-hpc/hpc-jianwen/spack/opt/linux-centos7-x86_64/gcc-5.4.0/jaspe\r\nr-1.900.1-s4vrs4dyghbs6wwf4lymob7snoauoc25                                                                         \r\n==> Installing opencv                           \r\n==> Using cached archive: /lustre/home/acct-hpc/hpc-jianwen/spack/var/spack/cache/opencv/opencv-3.3.0.tar.gz\r\n==> Already staged opencv-3.3.0-bzuxyt6ytmflw2dvu2equtritrroywsy in /lustre/home/acct-hpc/hpc-jianwen/spack/var/spa\r\nck/stage/opencv-3.3.0-bzuxyt6ytmflw2dvu2equtritrroywsy                                                             \r\n==> No patches needed for opencv\r\n==> Building opencv [CMakePackage]                                                                                 \r\n==> Executing phase : 'cmake'                                                             \r\n==> Error: ProcessError: Command exited with status 1:\r\n    'cmake' '/lustre/home/acct-hpc/hpc-jianwen/spack/var/spack/stage/opencv-3.3.0-bzuxyt6ytmflw2dvu2equtritrroywsy/\r\nopencv-3.3.0' '-G' 'Unix Makefiles' '-DCMAKE_INSTALL_PREFIX:PATH=/lustre/home/acct-hpc/hpc-jianwen/spack/opt/linux-\r\ncentos7-x86_64/gcc-5.4.0/opencv-3.3.0-bzuxyt6ytmflw2dvu2equtritrroywsy' '-DCMAKE_BUILD_TYPE:STRING=RelWithDebInfo'\r\n'-DCMAKE_VERBOSE_MAKEFILE:BOOL=ON' '-DCMAKE_INSTALL_RPATH_USE_LINK_PATH:BOOL=FALSE' '-DCMAKE_INSTALL_RPATH:STRING=/\r\nlustre/home/acct-hpc/hpc-jianwen/spack/opt/linux-centos7-x86_64/gcc-5.4.0/opencv-3.3.0-bzuxyt6ytmflw2dvu2equtritrro\r\nywsy/lib:/lustre/home/acct-hpc/hpc-jianwen/spack/opt/linux-centos7-x86_64/gcc-5.4.0/opencv-3.3.0-bzuxyt6ytmflw2dvu2\r\nequtritrroywsy/lib64:/lustre/home/acct-hpc/hpc-jianwen/spack/opt/linux-centos7-x86_64/gcc-5.4.0/jasper-1.900.1-s4vr\r\ns4dyghbs6wwf4lymob7snoauoc25/lib:/lustre/home/acct-hpc/hpc-jianwen/spack/opt/linux-centos7-x86_64/gcc-5.4.0/libjpeg\r\n-turbo-1.5.0-h22e2e67tnw6ok343k7glrdjt25cwkr6/lib' '-DBUILD_SHARED_LIBS:BOOL=ON' '-DENABLE_PRECOMPILED_HEADERS:BOOL\r\n=OFF' '-DWITH_IPP:BOOL=ON' '-DWITH_CUDA:BOOL=OFF' '-DWITH_QT:BOOL=OFF' '-DWITH_VTK:BOOL=OFF' '-DBUILD_opencv_java:B\r\nOOL=OFF' '-DBUILD_opencv_core:BOOL=OFF' '-DBUILD_opencv_highgui:BOOL=OFF' '-DBUILD_opencv_imgproc:BOOL=OFF' '-DWITH\r\n_JPEG:BOOL=OFF' '-DWITH_PNG:BOOL=OFF' '-DWITH_TIFF:BOOL=OFF' '-DWITH_ZLIB:BOOL=OFF' '-DWITH_OPENMP:BOOL=OFF' '-DJAS\r\nPER_LIBRARY_RELEASE:FILEPATH=/lustre/home/acct-hpc/hpc-jianwen/spack/opt/linux-centos7-x86_64/gcc-5.4.0/jasper-1.90\r\n0.1-s4vrs4dyghbs6wwf4lymob7snoauoc25/lib/libjasper.so' '-DJASPER_INCLUDE_DIR:PATH=/lustre/home/acct-hpc/hpc-jianwen\r\n/spack/opt/linux-centos7-x86_64/gcc-5.4.0/jasper-1.900.1-s4vrs4dyghbs6wwf4lymob7snoauoc25/include' '-DWITH_GTK:BOOL\r\n=OFF' '-DWITH_GTK_2_X:BOOL=OFF' '-DBUILD_opencv_python2=OFF' '-DBUILD_opencv_python3=OFF'\r\n/lustre/home/acct-hpc/hpc-jianwen/spack/lib/spack/spack/build_systems/cmake.py:186, in cmake:\r\n     180      def cmake(self, spec, prefix):\r\n     181          \"\"\"Runs ``cmake`` in the build directory\"\"\"\r\n     182          options = [os.path.abspath(self.root_cmakelists_dir)]\r\n     183          options += self.std_cmake_args\r\n     184          options += self.cmake_args()\r\n     185          with working_dir(self.build_directory, create=True):\r\n  >> 186              inspect.getmodule(self).cmake(*options)\r\n\r\nSee build log for details:\r\n  /tmp/hpc-jianwen/spack_stage/spack-stage/spack-stage-C4RTBH/opencv-3.3.0/spack-build.out\r\n\r\n$ tail -5 /tmp/hpc-jianwen/spack_stage/spack-stage/spack-stage-C4RTBH/opencv-3.3.0/spack-build.out\r\n-- Configuring done\r\nCMake Error: INSTALL(EXPORT) given unknown export \"OpenCVModules\"\r\n-- Generating done\r\n-- Build files have been written to: /tmp/hpc-jianwen/spack_stage/spack-stage/spack-stage-C4RTBH/opencv-3.3.0/spack-build\r\n\r\n$ spack install opencv+core~eigen %gcc@5.4.0\r\n==> cmake@3.8.1 : externally installed in /lustre/spack/tools/linux-centos7-x86_64/gcc-4.8.5/cmake-3.8.1-gxy3e7idb3\r\nna7wynpn55u3esttis67xw                                                                                             \r\n==> cmake@3.8.1 : already registered in DB                                                                         \r\n==> jasper is already installed in /lustre/home/acct-hpc/hpc-jianwen/spack/opt/linux-centos7-x86_64/gcc-5.4.0/jaspe\r\nr-1.900.1-s4vrs4dyghbs6wwf4lymob7snoauoc25                                                                         ==> Installing opencv                                    \r\n==> Using cached archive: /lustre/home/acct-hpc/hpc-jianwen/spack/var/spack/cache/opencv/opencv-3.3.0.tar.gz\r\n==> Staging archive: /lustre/home/acct-hpc/hpc-jianwen/spack/var/spack/stage/opencv-3.3.0-flbxpf43xnmpvb5u4csyedunfuybmwgf/3.3.0.tar.gz        \r\n==> Created stage in /lustre/home/acct-hpc/hpc-jianwen/spack/var/spack/stage/opencv-3.3.0-flbxpf43xnmpvb5u4csyedunf\r\nuybmwgf                     \r\n==> No patches needed for opencv\r\n==> Building opencv [CMakePackage]                                                                                 \r\n==> Executing phase : 'cmake'\r\n==> Executing phase : 'build'                                                                                      ==> Executing phase : 'install'\r\n==> Successfully installed opencv\r\n  Fetch: 0.17s.  Build: 1m 5.11s.  Total: 1m 5.28s.                                                                \r\n[+] /lustre/home/acct-hpc/hpc-jianwen/spack/opt/linux-centos7-x86_64/gcc-5.4.0/opencv-3.3.0-flbxpf43xnmpvb5u4csyedu\r\nnfuybmwgf\r\n```",
    "user": "weijianwen",
    "url": "https://api.github.com/repos/spack/spack/issues/5159",
    "updated_at": "2017-09-21 04:38:16",
    "created_at": "2017-08-18 14:46:36",
    "closed_at": "2017-09-21 04:38:16",
    "state": "closed",
    "title": "Failed to build opecv due to CMake Error: INSTALL(EXPORT) given unknown export \"OpenCVModules\"",
    "number": 5159,
    "milestone": null,
    "labels": [
        "build-error"
    ],
    "id": 251267890,
    "html_url": "https://github.com/spack/spack/issues/5159",
    "assignees": [],
    "comments": 1
}