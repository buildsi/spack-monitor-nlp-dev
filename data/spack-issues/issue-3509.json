{
    "body": "we had a user who tried Spack and had a problem with installing ncurses https://groups.google.com/forum/?fromgroups#!topic/dealii/r7P682fTF7Y\r\n\r\nI cross-post his message here in case there is something to be fixed in Spack. From the user's comment, i was not able to tell if that's the case or not. Feel free to reply to the original post if you think it's more appropriate, as well as close this issue if it is definitely not a problem with Spack.\r\n\r\nThe original message is below:\r\n\r\n---\r\n\r\nHello,\r\nI'm trying to install dealii on a shared AFS file system. Originally, I tried to install everything manually, which I had done successfully on our HPC cluster, but ran into a PETSc link error and decided to try Spack.\r\n\r\nI followed the instructions on the deal.II wiki, but installation stopped during the \"install\" phase for \"ncurses\". The packages \"bzip2\" and \"muparser\" installed without a problem.\r\n\r\nHere's the error message:\r\n######################################################################## 100.0%\r\n\r\n==> Staging archive: /afs/umich.edu/user/s/t/stvdwtt/Public/PRISMS/software/spack/spack/var/spack/stage/ncurses-6.0-4wkexyzgaxdwrfs6wqje2ppcm5di263m/ncurses-6.0.tar.gz\r\n\r\n==> Created stage in /afs/umich.edu/user/s/t/stvdwtt/Public/PRISMS/software/spack/spack/var/spack/stage/ncurses-6.0-4wkexyzgaxdwrfs6wqje2ppcm5di263m\r\n\r\n==> Applied patch sed_pgi.patch\r\n\r\n==> Ran patch() for ncurses\r\n\r\n==> Building ncurses [AutotoolsPackage]\r\n\r\n==> Executing phase : 'autoreconf'\r\n\r\n==> Executing phase : 'configure'\r\n\r\n==> Executing phase : 'build'\r\n\r\n==> Executing phase : 'install'\r\n\r\n==> Error: ProcessError: Command exited with status 2:\r\n\r\n    'make' '-j2' 'install'\r\n\r\n/afs/umich.edu/user/s/t/stvdwtt/Public/PRISMS/software/spack/spack/lib/spack/spack/build_systems/autotools.py:282, in install:\r\n\r\n     277      def install(self, spec, prefix):\r\n\r\n     278          \"\"\"Makes the install targets specified by\r\n\r\n     279          :py:attr:``~.AutotoolsPackage.install_targets``\r\n\r\n     280          \"\"\"\r\n\r\n     281          with working_dir(self.build_directory):\r\n\r\n  >> 282              inspect.getmodule(self).make(*self.install_targets)\r\n\r\n\r\n\r\nSee build log for details:\r\n\r\n  /tmp/stvdwtt/spack-stage/spack-stage-7oak9b/ncurses-6.0/spack-build.out\r\n\r\n\r\nI went to the build log (which is quite long), and see several errors like this:\r\ncd ../lib && (ln -s -f libpanel.so.6.0 libpanel.so.6; ln -s -f libpanel.so.6 libpanel.so; )\r\n\r\n/usr/bin/ld: total time in link: 0.021996\r\n\r\n/usr/bin/ld: data size 29224512\r\n\r\ncd /afs/umich.edu/user/s/t/stvdwtt/Public/PRISMS/software/spack/spack/opt/spack/linux-rhel6-x86_64/gcc-4.4.7/ncurses-6.0-4wkexyzgaxdwrfs6wqje2ppcm5di263m/lib && (ln -s -f libpanel.so.6.0 libpanel.so.6; ln -s -f libpanel.so.6 libpanel.so; )\r\n\r\ntest -z \"\" && /sbin/ldconfig\r\n\r\n/sbin/ldconfig: Can't create temporary cache file /etc/ld.so.cache~: Permission denied\r\n\r\nmake[1]: [/afs/umich.edu/user/s/t/stvdwtt/Public/PRISMS/software/spack/spack/opt/spack/linux-rhel6-x86_64/gcc-4.4.7/ncurses-6.0-4wkexyzgaxdwrfs6wqje2ppcm5di263m/lib/libpanel.so.6.0] Error 1 (ignored)\r\n\r\n\r\nThe last few lines of the build log (which I'm not sure are relevant) are:\r\nRunning sh /afs/umich.edu/user/s/t/stvdwtt/Public/PRISMS/software/spack/spack/var/spack/stage/ncurses-6.0-4wkexyzgaxdwrfs6wqje2ppcm5di263m/ncurses-6.0/misc/shlib tic to install /afs/umich.edu/user/s/t/stvdwtt/Public/PRISMS/software/spack/spack/opt/spack/linux-rhel6-x86_64/gcc-4.4.7/ncurses-6.0-4wkexyzgaxdwrfs6wqje2ppcm5di263m/share/terminfo ...\r\n\r\n\r\n\r\n        You may see messages regarding extended capabilities, e.g., AX.\r\n\r\n        These are extended terminal capabilities which are compiled\r\n\r\n        using\r\n\r\n                tic -x\r\n\r\n        If you have ncurses 4.2 applications, you should read the INSTALL\r\n\r\n        document, and install the terminfo without the -x option.\r\n\r\n\r\n\r\n** creating form.pc\r\n\r\n** creating ncurses++.pc\r\n\r\ntouch pc-files\r\n\r\n/bin/sh -c 'for name in *.pc; do /usr/bin/install -c -m 644 $name /afs/umich.edu/user/s/t/stvdwtt/Public/PRISMS/software/spack/spack/opt/spack/linux-rhel6-x86_64/gcc-4.4.7/ncurses-6.0-4wkexyzgaxdwrfs6wqje2ppcm5di263m/lib/pkgconfig/$name; done'\r\n\r\n\r\nJudging from the error, I'm assuming that it's a permissions issue. I double-checked that my $SPACK_ROOT environment variable is set correctly. The first line of the build log includes a '--prefix=' statement, which correctly picks up the $SPACK_ROOT path.\r\n\r\nDoes anyone have ideas on what the problem is? Digging around the Spack documentation didn't turn up anything.\r\n\r\nThanks!\r\nSteve",
    "user": "davydden",
    "url": "https://api.github.com/repos/spack/spack/issues/3509",
    "updated_at": "2020-02-22 16:09:15",
    "created_at": "2017-03-21 18:00:17",
    "closed_at": "2020-02-22 16:09:15",
    "state": "closed",
    "title": "ncurses fails to install due to permission problem on a shared AFS file system",
    "number": 3509,
    "milestone": null,
    "labels": [
        "build-error"
    ],
    "id": 215828380,
    "html_url": "https://github.com/spack/spack/issues/3509",
    "assignees": [],
    "comments": 5
}