{
    "body": "### Steps to reproduce\n\nBootstrapping with external compilers that need `LD_LIBRARY_PATH` is currently not possible as the process does not use `compilers.yaml`.  A workaround is to always run bootstrap before adding external compilers.\r\n\r\nAdditionally, maybe this needs to be documented on the \"Getting Started\" page in the \"Bootstrapping Clingo\" section, while the above is being addressed?\r\n\n\n### Error message\n\n```\r\n[kavalurav@scfocus18 spack]$ spack install openkim-models\r\n==> Bootstrapping clingo from pre-built binaries\r\n==> Fetching https://mirror.spack.io/bootstrap/github-actions/v0.1/build_cache/linux-rhel5-x86_64/gcc-9.3.0/clingo-bootstrap-spack/linux-rhel5-x86_64-gcc-9.3.0-clingo-bootstrap-spack-hmnv6gk5wha64k6r3s7hid35mzvhkuot.spack\r\n==> Installing \"clingo-bootstrap@spack%gcc@9.3.0~docs~ipo+python build_type=Release arch=linux-rhel5-x86_64\" from a buildcache\r\n==> Bootstrapping patchelf from pre-built binaries\r\n==> Installing patchelf-0.13.1-q2phgoulbx4m4kbctzlyptsczbw6e6zi\r\n==> No binary for patchelf-0.13.1-q2phgoulbx4m4kbctzlyptsczbw6e6zi found: installing from source\r\n==> Fetching https://github.com/NixOS/patchelf/releases/download/0.13.1/patchelf-0.13.1.tar.gz\r\n==> No patches needed for patchelf\r\n==> patchelf: Executing phase: 'autoreconf'\r\n==> patchelf: Executing phase: 'configure'\r\n==> Error: ProcessError: Command exited with status 77:\r\n    '/tmp/kavalurav/spack-stage/spack-stage-patchelf-0.13.1-q2phgoulbx4m4kbctzlyptsczbw6e6zi/spack-src/configure' '--prefix=/home/kavalurav/.spack/bootstrap/store/linux-centos7-x86_64/gcc-8.2.0/patchelf-0.13.1-q2phgoulbx4m4kbctzlyptsczbw6e6zi'\r\n\r\n2 errors found in build log:\r\n     7     checking for gawk... gawk\r\n     8     checking whether make sets $(MAKE)... yes\r\n     9     checking whether make supports nested variables... yes\r\n     10    checking whether make supports the include directive... yes (GNU style)\r\n     11    checking for gcc... /lstr/home/kavalurav/spack/lib/spack/env/gcc/gcc\r\n     12    checking whether the C compiler works... no\r\n  >> 13    configure: error: in `/tmp/kavalurav/spack-stage/spack-stage-patchelf-0.13.1-q2phgoulbx4m4kbctzlyptsczbw6e6zi/spack-src':\r\n  >> 14    configure: error: C compiler cannot create executables\r\n     15    See `config.log' for more details\r\n\r\nSee build log for details:\r\n  /tmp/kavalurav/spack-stage/spack-stage-patchelf-0.13.1-q2phgoulbx4m4kbctzlyptsczbw6e6zi/spack-build-out.txt\r\n\r\n==> Bootstrapping clingo from sources\r\n[+] /usr (external bison-3.0.4-6by6mwnentffr2smzgpc4r6w4trgki7t)\r\n==> Installing pkgconf-1.8.0-4qrvznh6qmp75hhnhjp37atgcckjwnf2\r\n==> No binary for pkgconf-1.8.0-4qrvznh6qmp75hhnhjp37atgcckjwnf2 found: installing from source\r\n==> Using cached archive: /lstr/home/kavalurav/spack/var/spack/cache/_source-cache/archive/ef/ef9c7e61822b7cb8356e6e9e1dca58d9556f3200d78acab35e4347e9d4c2bbaf.tar.xz\r\n==> No patches needed for pkgconf\r\n==> pkgconf: Executing phase: 'autoreconf'\r\n==> pkgconf: Executing phase: 'configure'\r\n==> Error: ProcessError: Command exited with status 77:\r\n    '/tmp/kavalurav/spack-stage/spack-stage-pkgconf-1.8.0-4qrvznh6qmp75hhnhjp37atgcckjwnf2/spack-src/configure' '--prefix=/home/kavalurav/.spack/bootstrap/store/linux-centos7-x86_64/gcc-8.2.0/pkgconf-1.8.0-4qrvznh6qmp75hhnhjp37atgcckjwnf2'\r\n\r\n2 errors found in build log:\r\n  >> 6    configure: error: in `/tmp/kavalurav/spack-stage/spack-stage-pkgconf-1.8.0-4qrvznh6qmp75hhnhjp37atgcckjwnf2/spack-src':\r\n  >> 7    configure: error: C compiler cannot create executables\r\n     8    See `config.log' for more details\r\n\r\nSee build log for details:\r\n  /tmp/kavalurav/spack-stage/spack-stage-pkgconf-1.8.0-4qrvznh6qmp75hhnhjp37atgcckjwnf2/spack-build-out.txt\r\n\r\n==> Warning: Skipping build of ncurses-6.2-nbig43rq3uugefzgrstfaz4wymjywiol since pkgconf-1.8.0-4qrvznh6qmp75hhnhjp37atgcckjwnf2 failed\r\n==> Warning: Skipping build of cmake-3.22.1-zr4siq4tqsnvxwj2toke2p4ezsboe745 since ncurses-6.2-nbig43rq3uugefzgrstfaz4wymjywiol failed\r\n==> Warning: Skipping build of clingo-bootstrap-spack-mq6yfzoekt4xhmb6cidbpjmqwahw3jis since cmake-3.22.1-zr4siq4tqsnvxwj2toke2p4ezsboe745 failed\r\n==> Warning: Skipping build of readline-8.1-iepsygqsde5da5zrdk2hu4alace672nx since ncurses-6.2-nbig43rq3uugefzgrstfaz4wymjywiol failed\r\n==> Warning: Skipping build of gdbm-1.19-7e2k3j4u6irr7yk6xdpaxidzlhoq7scd since readline-8.1-iepsygqsde5da5zrdk2hu4alace672nx failed\r\n==> Warning: Skipping build of perl-5.34.0-2qjbggi23gvvqyrzcwva26abl44ez6pq since gdbm-1.19-7e2k3j4u6irr7yk6xdpaxidzlhoq7scd failed\r\n==> Warning: Skipping build of openssl-1.1.1m-5twjb37nkt2255wa7evgbdvoqloat6uq since perl-5.34.0-2qjbggi23gvvqyrzcwva26abl44ez6pq failed\r\n==> Error: cannot bootstrap the \"clingo\" Python module from spec \"clingo-bootstrap@spack+python %gcc target=x86_64\" due to the following failures:\r\n    'github-actions' raised RuntimeError: cannot bootstrap any of the patchelf executables from spec \"patchelf@0.13.1:0.13.99 %gcc target=x86_64\"\r\n    'spack-install' raised InstallError: Terminating after first install failure: ProcessError: Command exited with status 77:\r\n    '/tmp/kavalurav/spack-stage/spack-stage-pkgconf-1.8.0-4qrvznh6qmp75hhnhjp37atgcckjwnf2/spack-src/configure' '--prefix=/home/kavalurav/.spack/bootstrap/store/linux-centos7-x86_64/gcc-8.2.0/pkgconf-1.8.0-4qrvznh6qmp75hhnhjp37atgcckjwnf2'\r\n    Please run `spack -d spec zlib` for more verbose error messages\r\n```\r\n\r\nwith the below compilers.yaml file\r\n```\r\n[kavalurav@scfocus18 spack]$ cat /home/kavalurav/.spack/bootstrap/config/linux/compilers.yaml \r\ncompilers:\r\n- compiler:\r\n    spec: gcc@4.8.5\r\n    paths:\r\n      cc: /bin/gcc\r\n      cxx: /bin/g++\r\n      f77: /bin/gfortran\r\n      fc: /bin/gfortran\r\n    flags: {}\r\n    operating_system: centos7\r\n    target: x86_64\r\n    modules: []\r\n    environment: {}\r\n    extra_rpaths: []\r\n- compiler:\r\n    spec: gcc@8.2.0\r\n    paths:\r\n      cc: /usr/nic/compiler/gcc/8.2/bin/gcc\r\n      cxx: /usr/nic/compiler/gcc/8.2/bin/g++\r\n      f77: /usr/nic/compiler/gcc/8.2/bin/gfortran\r\n      fc: /usr/nic/compiler/gcc/8.2/bin/gfortran\r\n    flags: {}\r\n    operating_system: centos7\r\n    target: x86_64\r\n    modules: []\r\n    environment: {}\r\n    extra_rpaths: []\r\n```\r\n\n\n### Information on your system\n\n```\r\n[kavalurav@scfocus18 ~]$ spack debug report\r\n* **Spack:** 0.17.1-915-c11ce3b\r\n* **Python:** 3.9.2\r\n* **Platform:** linux-centos7-skylake_avx512\r\n* **Concretizer:** clingo\r\n```\n\n### General information\n\n- [X] I have run `spack debug report` and reported the version of Spack/Python/Platform\n- [X] I have searched the issues of this repo and believe this is not a duplicate\n- [X] I have run the failing commands in debug mode and reported the output",
    "user": "adityakavalur",
    "url": "https://api.github.com/repos/spack/spack/issues/28508",
    "updated_at": "2022-01-23 12:40:21",
    "created_at": "2022-01-19 20:15:09",
    "closed_at": "None",
    "state": "open",
    "title": "Spack does not bootstrap with external compilers",
    "number": 28508,
    "milestone": null,
    "labels": [
        "bug",
        "impact-low",
        "bootstrap"
    ],
    "id": 1108514604,
    "html_url": "https://github.com/spack/spack/issues/28508",
    "assignees": [
        "alalazo"
    ],
    "comments": 1
}