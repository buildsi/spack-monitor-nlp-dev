{
    "body": "### Steps to reproduce the issue\n\nnss fails to build on clang/aocc because it properly detects clang as its C compiler, but it runs g++ as its C++ compiler with clang parameters.\r\n\r\n```console\r\n$ spack spec -l nss%clang@11.0.0\r\nInput spec\r\n--------------------------------\r\nnss%clang@11.0.0\r\n\r\nConcretized\r\n--------------------------------\r\nswoz4wh  nss@3.73%clang@11.0.0 arch=linux-ubuntu20.04-haswell\r\nucr34xo      ^nspr@4.32%clang@11.0.0 arch=linux-ubuntu20.04-haswell\r\nceapj5u          ^perl@5.34.0%clang@11.0.0+cpanm+shared+threads arch=linux-ubuntu20.04-haswell\r\ngcvqmoo              ^berkeley-db@18.1.40%clang@11.0.0+cxx~docs+stl patches=b231fcc arch=linux-ubuntu20.04-haswell\r\nnwrmiuf              ^bzip2@1.0.8%clang@11.0.0~debug~pic+shared arch=linux-ubuntu20.04-haswell\r\nbahha3s                  ^diffutils@3.8%clang@11.0.0 arch=linux-ubuntu20.04-haswell\r\njew5ui7                      ^libiconv@1.16%clang@11.0.0 libs=shared,static arch=linux-ubuntu20.04-haswell\r\ntr5uqop              ^gdbm@1.19%clang@11.0.0 arch=linux-ubuntu20.04-haswell\r\nrmtx2ep                  ^readline@8.1%clang@11.0.0 arch=linux-ubuntu20.04-haswell\r\n3t4cjtt                      ^ncurses@6.2%clang@11.0.0~symlinks+termlib abi=none arch=linux-ubuntu20.04-haswell\r\ndlktc2h                          ^pkgconf@1.8.0%clang@11.0.0 arch=linux-ubuntu20.04-haswell\r\n5vhpnmw              ^zlib@1.2.11%clang@11.0.0+optimize+pic+shared arch=linux-ubuntu20.04-haswell\r\nhimedlx      ^sqlite@3.37.2%clang@11.0.0+column_metadata+dynamic_extensions+fts~functions+rtree arch=linux-ubuntu20.04-haswell\r\n```\r\n\n\n### Error message\n\n<details><summary>Error message</summary><pre>\r\n     1846    g++ -o Linux5.4_x86_64_clang_glibc_PTH_64_OPT.OBJ/databuffer.o -c -std=c++11 -O2 -fPIC  -m64 -pipe -ffunction-sections -fdata-sections -DHAVE_STRERROR -DLINUX -Dlinux -Wall -Wshadow -Qunused-arguments -Wno-parentheses-equali\r\n             ty -Wno-array-bounds -Wno-unevaluated-expression -Werror -DXP_UNIX -DXP_UNIX -UDEBUG -DNDEBUG -D_DEFAULT_SOURCE -D_BSD_SOURCE -D_POSIX_SOURCE -DSDB_MEASURE_USE_TEMP_DIR -D_REENTRANT -UDEBUG -DNDEBUG -D_DEFAULT_SOURCE -D_BSD_\r\n             SOURCE -D_POSIX_SOURCE -DSDB_MEASURE_USE_TEMP_DIR -D_REENTRANT -DNSS_NO_INIT_SUPPORT -DUSE_UTIL_DIRECTLY -DNO_NSPR_10_SUPPORT -DSSL_DISABLE_DEPRECATED_CIPHER_SUITE_NAMES -I/tmp/bc/spack-stage/spack-stage-nss-3.73-swoz4whrnd2\r\n             auw3cosubfpeoec3tg6rv/spack-src/dist/include -I/tmp/bc/spack-stage/spack-stage-nss-3.73-swoz4whrnd2auw3cosubfpeoec3tg6rv/spack-src/dist/public/nss -I/tmp/bc/spack-stage/spack-stage-nss-3.73-swoz4whrnd2auw3cosubfpeoec3tg6rv/s\r\n             pack-src/dist/private/nss  -std=c++0x databuffer.cc\r\n  >> 1847    g++: error: unrecognized command line option '-Qunused-arguments'\r\n  >> 1848    make[2]: *** [../coreconf/rules.mk:349: Linux5.4_x86_64_clang_glibc_PTH_64_OPT.OBJ/databuffer.o] Error 1\r\n     1849    make[2]: Leaving directory '/tmp/bc/spack-stage/spack-stage-nss-3.73-swoz4whrnd2auw3cosubfpeoec3tg6rv/spack-src/nss/cpputil'\r\n  >> 1850    make[1]: *** [coreconf/rules.mk:44: cpputil] Error 2\r\n     1851    make[1]: Leaving directory '/tmp/bc/spack-stage/spack-stage-nss-3.73-swoz4whrnd2auw3cosubfpeoec3tg6rv/spack-src/nss'\r\n  >> 1852    make: *** [manifest.mn:21: all] Error 2\r\n</pre></details>\r\n\n\n### Information on your system\n\n* **Spack:** 0.17.1-1338-a027b5b6ad\r\n* **Python:** 3.8.10\r\n* **Platform:** linux-ubuntu20.04-haswell\r\n* **Concretizer:** clingo\n\n### Additional information\n\n[spack-build-out.txt](https://github.com/spack/spack/files/8138615/spack-build-out.txt)\r\n[spack-build-env.txt](https://github.com/spack/spack/files/8138616/spack-build-env.txt)\r\n\r\n\n\n### General information\n\n- [X] I have run `spack debug report` and reported the version of Spack/Python/Platform\n- [X] I have run `spack maintainers <name-of-the-package>` and **@mentioned** any maintainers\n- [X] I have uploaded the build log and environment files\n- [X] I have searched the issues of this repo and believe this is not a duplicate",
    "user": "zzzoom",
    "url": "https://api.github.com/repos/spack/spack/issues/29194",
    "updated_at": "2022-03-03 13:59:30",
    "created_at": "2022-02-25 05:02:55",
    "closed_at": "2022-03-03 13:59:30",
    "state": "closed",
    "title": "Installation issue: nss %clang",
    "number": 29194,
    "milestone": null,
    "labels": [
        "build-error"
    ],
    "id": 1150045878,
    "html_url": "https://github.com/spack/spack/issues/29194",
    "assignees": [],
    "comments": 0
}