{
    "body": "From\r\n`UNKNOWN COMPILER '/srv/beegfs/cluster/home/clusterbuild/spack/lib/spack/env/gcc/gcc' for ICC: you must also supply flags!`\r\nIt seems like atlas is refusing to accept spack provided compiler as `gcc` ...\r\n\r\n### Steps to reproduce the issue\r\n\r\n```console\r\n$ spack install atlas@3.11.41\r\n==> Installing atlas\r\n==> No binary for atlas found: installing from source                                                                              \r\n==> Moving resource stage\r\n\tsource : /tmp/clusterbuild/spack-stage/resource-lapack-txlzl2b3typr2xmuchd3ebxixecv3znu/spack-src/\r\n\tdestination : /tmp/clusterbuild/spack-stage/spack-stage-atlas-3.11.41-txlzl2b3typr2xmuchd3ebxixecv3znu/spack-src/spack-resource-lapack/lapack-3.5.0\r\n==> atlas: Executing phase: 'install'\r\n==> Error: ProcessError: Command exited with status 2:\r\n    'make'\r\n\r\n13 errors found in build log:\r\n     52     /tmp/clusterbuild/spack-stage/spack-stage-atlas-3.11.41-txlzl2b3typr2xmuchd3ebxixecv3znu/spack-src/spack-build/..//CONF\r\n            IG/include/atlas_sys.h:224: warning: the use of `tmpnam' is dangerous, better use `mkstemp'\r\n     53     rm -f config1.out\r\n     54     make atlas_run atldir=/tmp/clusterbuild/spack-stage/spack-stage-atlas-3.11.41-txlzl2b3typr2xmuchd3ebxixecv3znu/spack-sr\r\n            c/spack-build exe=xprobe_comp redir=config1.out \\\r\n     55                     args=\"-v 0 -o atlconf.txt -O 1 -A 35 -Si nof77 0 -V 1968  -C ic '/srv/beegfs/cluster/home/clusterbuild/\r\n            spack/lib/spack/env/gcc/gcc' -C if '/srv/beegfs/cluster/home/clusterbuild/spack/lib/spack/env/gcc/gfortran' -b 64 -d b \r\n            /tmp/clusterbuild/spack-stage/spack-stage-atlas-3.11.41-txlzl2b3typr2xmuchd3ebxixecv3znu/spack-src/spack-build\"\r\n     56     make[1]: Entering directory '/tmp/clusterbuild/spack-stage/spack-stage-atlas-3.11.41-txlzl2b3typr2xmuchd3ebxixecv3znu/s\r\n            pack-src/spack-build'\r\n     57     cd /tmp/clusterbuild/spack-stage/spack-stage-atlas-3.11.41-txlzl2b3typr2xmuchd3ebxixecv3znu/spack-src/spack-build ; ./x\r\n            probe_comp -v 0 -o atlconf.txt -O 1 -A 35 -Si nof77 0 -V 1968  -C ic '/srv/beegfs/cluster/home/clusterbuild/spack/lib/s\r\n            pack/env/gcc/gcc' -C if '/srv/beegfs/cluster/home/clusterbuild/spack/lib/spack/env/gcc/gfortran' -b 64 -d b /tmp/cluste\r\n            rbuild/spack-stage/spack-stage-atlas-3.11.41-txlzl2b3typr2xmuchd3ebxixecv3znu/spack-src/spack-build > config1.out\r\n  >> 58     find: '/opt/slurm/20.02/bin': No such file or directory\r\n  >> 59     find: '/usr/users/clusterbuild/local': No such file or directory\r\n  >> 60     find: '/opt/bin': No such file or directory\r\n  >> 61     find: '/opt/sbin': No such file or directory\r\n     62     UNKNOWN COMPILER '/srv/beegfs/cluster/home/clusterbuild/spack/lib/spack/env/gcc/gcc' for ICC: you must also supply flag\r\n            s!\r\n     63     Makefile:109: recipe for target 'atlas_run' failed\r\n  >> 64     make[1]: *** [atlas_run] Error 1\r\n     65     make[1]: Leaving directory '/tmp/clusterbuild/spack-stage/spack-stage-atlas-3.11.41-txlzl2b3typr2xmuchd3ebxixecv3znu/sp\r\n            ack-src/spack-build'\r\n     66     Makefile:123: recipe for target 'IRun_comp' failed\r\n  >> 67     make: *** [IRun_comp] Error 2\r\n     68     ERROR 512 IN SYSCMND: 'make IRun_comp args=\"-v 0 -o atlconf.txt -O 1 -A 35 -Si nof77 0 -V 1968  -C ic '/srv/beegfs/clus\r\n            ter/home/clusterbuild/spack/lib/spack/env/gcc/gcc' -C if '/srv/beegfs/cluster/home/clusterbuild/spack/lib/spack/env/gcc\r\n            /gfortran' -b 64\"'\r\n     69     \r\n     70     OS configured as Linux (1)\r\n     71     \r\n     72     Assembly configured as GAS_x8664 (2)\r\n     73     \r\n\r\n     ...\r\n\r\n     105    cd interfaces/blas/F77 ; mkdir src testing\r\n     106    cd interfaces/lapack ; mkdir C2F\r\n     107    cd interfaces/lapack/C2F ; mkdir src\r\n     108    mkdir ARCHS\r\n     109    make -f Make.top startup\r\n     110    make[1]: Entering directory '/tmp/clusterbuild/spack-stage/spack-stage-atlas-3.11.41-txlzl2b3typr2xmuchd3ebxixecv3znu/s\r\n            pack-src/spack-build'\r\n  >> 111    Make.top:1: Make.inc: No such file or directory\r\n  >> 112    make[1]: *** No rule to make target 'Make.inc'.  Stop.\r\n     113    make[1]: Leaving directory '/tmp/clusterbuild/spack-stage/spack-stage-atlas-3.11.41-txlzl2b3typr2xmuchd3ebxixecv3znu/sp\r\n            ack-src/spack-build'\r\n     114    Makefile:560: recipe for target 'startup' failed\r\n  >> 115    make: *** [startup] Error 2\r\n  >> 116    mv: cannot stat 'lib/Makefile': No such file or directory\r\n     117    ../configure: 573: ../configure: cannot create lib/Makefile: Directory nonexistent\r\n     118    ../configure: 574: ../configure: cannot create lib/Makefile: Directory nonexistent\r\n     119    ../configure: 575: ../configure: cannot create lib/Makefile: Directory nonexistent\r\n     120    ../configure: 576: ../configure: cannot create lib/Makefile: Directory nonexistent\r\n     121    ../configure: 580: ../configure: cannot create include/atlas_maxmalloc.h: Directory nonexistent\r\n     122    ../configure: 585: ../configure: cannot create include/atlas_maxmalloc.h: Directory nonexistent\r\n\r\n     ...\r\n\r\n     127    ../configure: 643: ../configure: cannot create lib/Makefile: Directory nonexistent\r\n     128    ../configure: 661: ../configure: cannot create /tmp/clusterbuild/spack-stage/spack-stage-atlas-3.11.41-txlzl2b3typr2xmu\r\n            chd3ebxixecv3znu/spack-src/spack-build/tune/threads/res/aff.h: Directory nonexistent\r\n     129    DONE configure\r\n     130    ==> [2020-10-06-23:44:30.540475] 'make'\r\n     131    make -f Make.top build\r\n     132    make[1]: Entering directory '/tmp/clusterbuild/spack-stage/spack-stage-atlas-3.11.41-txlzl2b3typr2xmuchd3ebxixecv3znu/s\r\n            pack-src/spack-build'\r\n  >> 133    Make.top:1: Make.inc: No such file or directory\r\n  >> 134    make[1]: *** No rule to make target 'Make.inc'.  Stop.\r\n     135    make[1]: Leaving directory '/tmp/clusterbuild/spack-stage/spack-stage-atlas-3.11.41-txlzl2b3typr2xmuchd3ebxixecv3znu/sp\r\n            ack-src/spack-build'\r\n     136    Makefile:555: recipe for target 'build' failed\r\n  >> 137    make: *** [build] Error 2\r\n\r\nSee build log for details:\r\n  /tmp/clusterbuild/spack-stage/spack-stage-atlas-3.11.41-txlzl2b3typr2xmuchd3ebxixecv3znu/spack-build-out.txt\r\n\r\n...\r\n```\r\n\r\n### Information on your system\r\n\r\n<!-- Please include the output of `spack debug report` -->\r\n\r\n```console\r\nclusterbuild@r3d3:~/local_modules/Modules$ spack debug report\r\n* **Spack:** 0.15.4\r\n* **Python:** 3.6.9\r\n* **Platform:** linux-ubuntu18.04-cascadelake\r\n```\r\n\r\n### Additional information\r\n\r\n* [spack-build-out.txt](https://github.com/spack/spack/files/5337026/spack-build-out.txt)\r\n* [spack-build-env.txt](https://github.com/spack/spack/files/5337027/spack-build-env.txt)\r\n",
    "user": "JaroslavHron",
    "url": "https://api.github.com/repos/spack/spack/issues/19214",
    "updated_at": "2020-10-06 21:58:27",
    "created_at": "2020-10-06 21:58:27",
    "closed_at": "None",
    "state": "open",
    "title": "Installation issue: atlas",
    "number": 19214,
    "milestone": null,
    "labels": [
        "build-error"
    ],
    "id": 716049157,
    "html_url": "https://github.com/spack/spack/issues/19214",
    "assignees": [],
    "comments": 0
}