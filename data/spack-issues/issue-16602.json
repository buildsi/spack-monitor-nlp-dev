{
    "body": "Trying to build `libffi@3.3` on `power8` using `gcc@7.3.0` results in the error shown below. Using `spack@develop` checked out at commit `7813e4146459` from 12-May-2020. Even when target=ppc64le is specified:\r\n\r\n```\r\n$> spack install libffi target=ppc64le\r\n...\r\n==> Error: Failed to install libffi due to ChildError: ProcessError: Command exited with status 2:\r\n    'make' '-j16'\r\n7 errors found in build log:\r\n     260    ../src/java_raw_api.c:337:1: note: declared here\r\n     261     ffi_prep_java_raw_closure_loc (ffi_java_raw_closure* cl,\r\n     262     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n     263    libtool: compile:  /opt/spack/lib/spack/env/gcc/gcc -DHAVE_CONFIG_H -I. -I.. -I. -I../include -Iinclude -I../src -I. -I../include -Iinclude -I../\r\n            src -MT src/powerpc/linux64.lo -MD -MP -MF src/powerpc/.deps/linux64.Tpo -c ../src/powerpc/linux64.S -o src/powerpc/linux64.o >/dev/null 2>&1\r\n     264    libtool: compile:  /opt/spack/lib/spack/env/gcc/gcc -DHAVE_CONFIG_H -I. -I.. -I. -I../include -Iinclude -I../src -O3 -fomit-frame-pointer -fstric\r\n            t-aliasing -ffast-math -mcpu=power8 -Wall -fexceptions -MT src/types.lo -MD -MP -MF src/.deps/types.Tpo -c ../src/types.c -o src/types.o >/dev/nu\r\n            ll 2>&1\r\n     265    In file included from ../src/powerpc/ffi.c:33:0:\r\n  >> 266    ../src/powerpc/ffi_powerpc.h:61:9: error: '_Float128' is not supported on this target\r\n     267     typedef _Float128 float128;\r\n     268             ^~~~~~~~~\r\n     269    libtool: compile:  /opt/spack/lib/spack/env/gcc/gcc -DHAVE_CONFIG_H -I. -I.. -I. -I../include -Iinclude -I../src -O3 -fomit-frame-pointer -fstric\r\n            t-aliasing -ffast-math -mcpu=power8 -Wall -fexceptions -MT src/powerpc/ffi_sysv.lo -MD -MP -MF src/powerpc/.deps/ffi_sysv.Tpo -c ../src/powerpc/f\r\n            fi_sysv.c -o src/powerpc/ffi_sysv.o >/dev/null 2>&1\r\n     270    Makefile:1273: recipe for target 'src/powerpc/ffi.lo' failed\r\n  >> 271    make[3]: *** [src/powerpc/ffi.lo] Error 1\r\n     272    make[3]: *** Waiting for unfinished jobs....\r\n     273    In file included from ../src/powerpc/ffi_linux64.c:35:0:\r\n  >> 274    ../src/powerpc/ffi_powerpc.h:61:9: error: '_Float128' is not supported on this target\r\n     275     typedef _Float128 float128;\r\n     276             ^~~~~~~~~\r\n     277    Makefile:1273: recipe for target 'src/powerpc/ffi_linux64.lo' failed\r\n  >> 278    make[3]: *** [src/powerpc/ffi_linux64.lo] Error 1\r\n     279    libtool: compile:  /opt/spack/lib/spack/env/gcc/gcc -DHAVE_CONFIG_H -I. -I.. -I. -I../include -Iinclude -I../src -O3 -fomit-frame-pointer -fstric\r\n            t-aliasing -ffast-math -mcpu=power8 -Wall -fexceptions -MT src/java_raw_api.lo -MD -MP -MF src/.deps/java_raw_api.Tpo -c ../src/java_raw_api.c -o\r\n             src/java_raw_api.o >/dev/null 2>&1\r\n     280    libtool: compile:  /opt/spack/lib/spack/env/gcc/gcc -DHAVE_CONFIG_H -I. -I.. -I. -I../include -Iinclude -I../src -O3 -fomit-frame-pointer -fstric\r\n            t-aliasing -ffast-math -mcpu=power8 -Wall -fexceptions -MT src/raw_api.lo -MD -MP -MF src/.deps/raw_api.Tpo -c ../src/raw_api.c -o src/raw_api.o\r\n            >/dev/null 2>&1\r\n     281    libtool: compile:  /opt/spack/lib/spack/env/gcc/gcc -DHAVE_CONFIG_H -I. -I.. -I. -I../include -Iinclude -I../src -O3 -fomit-frame-pointer -fstric\r\n            t-aliasing -ffast-math -mcpu=power8 -Wall -fexceptions -MT src/prep_cif.lo -MD -MP -MF src/.deps/prep_cif.Tpo -c ../src/prep_cif.c -o src/prep_ci\r\n            f.o >/dev/null 2>&1\r\n     282    libtool: compile:  /opt/spack/lib/spack/env/gcc/gcc -DHAVE_CONFIG_H -I. -I.. -I. -I../include -Iinclude -I../src -O3 -fomit-frame-pointer -fstric\r\n            t-aliasing -ffast-math -mcpu=power8 -Wall -fexceptions -MT src/closures.lo -MD -MP -MF src/.deps/closures.Tpo -c ../src/closures.c -o src/closure\r\n            s.o >/dev/null 2>&1\r\n     283    make[3]: Leaving directory '/tmp/root/spack-stage/spack-stage-libffi-3.3-hjmp26qlv2hwyz7q4agyxsahgovsvzdt/spack-src/powerpc64le-unknown-linux-gnu\r\n            '\r\n     284    Makefile:1347: recipe for target 'all-recursive' failed\r\n  >> 285    make[2]: *** [all-recursive] Error 1\r\n     286    make[2]: Leaving directory '/tmp/root/spack-stage/spack-stage-libffi-3.3-hjmp26qlv2hwyz7q4agyxsahgovsvzdt/spack-src/powerpc64le-unknown-linux-gnu\r\n            '\r\n     287    Makefile:622: recipe for target 'all' failed\r\n  >> 288    make[1]: *** [all] Error 2\r\n     289    make[1]: Leaving directory '/tmp/root/spack-stage/spack-stage-libffi-3.3-hjmp26qlv2hwyz7q4agyxsahgovsvzdt/spack-src/powerpc64le-unknown-linux-gnu\r\n            '\r\n     290    Makefile:592: recipe for target 'all-all' failed\r\n  >> 291    make: *** [all-all] Error 2\r\n```\r\n\r\n@michaelkuhn @ax3l @skosukhin \r\n\r\n",
    "user": "eugeneswalker",
    "url": "https://api.github.com/repos/spack/spack/issues/16602",
    "updated_at": "2020-06-12 18:25:07",
    "created_at": "2020-05-12 16:00:46",
    "closed_at": "2020-06-12 18:25:07",
    "state": "closed",
    "title": "Installation issue: libffi on power 8",
    "number": 16602,
    "milestone": null,
    "labels": [
        "build-error",
        "power"
    ],
    "id": 616774117,
    "html_url": "https://github.com/spack/spack/issues/16602",
    "assignees": [],
    "comments": 6
}