{
    "body": "The issue appears to be a problem in the AML code itself where they are copying files to a directory that wasn't created.\r\nThis was discovered while trying to address packages that did not build for the E4S project initially.   I have a suggested fix but am looking for advice on what is the best strategy.   The fix is to add a mkdir command to the doc directory Makefile.am file:\r\n```\r\n$ diff -Naur aml-0.1.0/doc/Makefile.am aml-0.1.0-fixed/doc/Makefile.am\r\n--- aml-0.1.0/doc/Makefile.am\t1969-12-31 19:00:01.000000000 -0500\r\n+++ aml-0.1.0-fixed/doc/Makefile.am\t2020-08-10 17:57:57.756347000 -0400\r\n@@ -16,6 +16,7 @@\r\n \r\n install-doc-html: build-docs\r\n \tif [ -d $(SPHINX_BUILD_DIR) ]; then \\\r\n+\tmkdir -p $(DATA_INSTALL_DIR)/html \\\r\n \tcp -r $(SPHINX_BUILD_DIR) $(DATA_INSTALL_DIR)/html; \\\r\n \tfi\r\n```\r\n\r\nBecause this is in the project code itself, should this fix be done by the project team responsible for aml or another option is to patch the file.   Patching the file will not take effect unless we do the autogen.sh command and perhaps just patch Makefile.in which is regenerated by the autogen.sh.   Does anyone have advice on how this could be done effectively?\r\n\r\nTo recreate the original problem:\r\nspack -e . install --no-cache\r\nwith this spack.yaml file in your spack top-level directory:\r\n```\r\nspack:\r\n  packages:\r\n    all:\r\n      providers:\r\n        mpi: [spectrum-mpi]\r\n      target: [ppc64le]\r\n      buildable: true\r\n      version: []\r\n      paths: {}\r\n      modules: {}\r\n      compiler: []\r\n    cuda:\r\n      buildable: false\r\n      version: [10.1.243]\r\n      modules:\r\n        cuda@10.1.243: cuda/10.1.243\r\n      target: []\r\n      providers: {}\r\n      paths: {}\r\n      compiler: []\r\n    spectrum-mpi:\r\n      buildable: false\r\n      version:\r\n      - 10.3.1.2\r\n      modules:\r\n        spectrum-mpi@10.3.1.2: spectrum-mpi/10.3.1.2-20200121\r\n      target: []\r\n      providers: {}\r\n      paths: {}\r\n      compiler: []\r\n    gcc:\r\n      version:\r\n      - 6.4.0\r\n      buildable: true\r\n      target: []\r\n      providers: {}\r\n      paths: {}\r\n      modules: {}\r\n      compiler: []\r\n  specs:\r\n  - aml\r\n#  - faodel\r\n#  - flecsi+cinch\r\n#  - petsc\r\n#  - turbine\r\n#  - unifyfs\r\n  config:\r\n    misc_cache: $spack/cache\r\n    install_tree: $spack/$padding:512\r\n  view: false\r\n  concretization: separately\r\n```\r\n\r\nHere is the original failed output:\r\n```\r\n==> Installing aml\r\n==> aml: Executing phase: 'autoreconf'\r\n==> aml: Executing phase: 'configure'\r\n==> aml: Executing phase: 'build'\r\n==> aml: Executing phase: 'install'\r\n==> Error: ProcessError: Command exited with status 2:\r\n    'make' '-j16' 'install'\r\n\r\n4 errors found in build log:\r\n     362    mkdir -p /autofs/nccsopen-svm1_home/jgalarowicz/luke_assignment/spa\r\n            ck/spack_path_placeholder/spack_path_placeholder/spack_path_placeho\r\n            lder/spack_path_placeholder/spack_path_placeholder/spack_path_place\r\n            holder/spack_path_placeholder/spack_path_placeholder/spack_path_pla\r\n            ceholder/spack_path_placeholder/spack_path_placeholder/spack_path_p\r\n            laceholder/spack_path_placeholder/spack_path_placeholder/spack_path\r\n            _placeholder/spack_path_placeholder/spack_path_placeholder/spack_pa\r\n            th_placeholder/spack_path_placeholder/spack_path_placeholder/spack_\r\n            path_placeholder/spack_path_placeholder/spack_/linux-rhel7-ppc64le/\r\n            gcc-6.4.0/aml-0.1.0-xlnakyzomp5n6relmtb6ajb2ijrds3uz/share/aml\r\n     363    echo \"not building documentation\"\r\n     364    not building documentation\r\n     365    if [ -d ./build-sphinx ]; then \\\r\n     366    cp -r ./build-sphinx /autofs/nccsopen-svm1_home/jgalarowicz/luke_as\r\n            signment/spack/spack_path_placeholder/spack_path_placeholder/spack_\r\n            path_placeholder/spack_path_placeholder/spack_path_placeholder/spac\r\n            k_path_placeholder/spack_path_placeholder/spack_path_placeholder/sp\r\n            ack_path_placeholder/spack_path_placeholder/spack_path_placeholder/\r\n            spack_path_placeholder/spack_path_placeholder/spack_path_placeholde\r\n            r/spack_path_placeholder/spack_path_placeholder/spack_path_placehol\r\n            der/spack_path_placeholder/spack_path_placeholder/spack_path_placeh\r\n            older/spack_path_placeholder/spack_path_placeholder/spack_/linux-rh\r\n            el7-ppc64le/gcc-6.4.0/aml-0.1.0-xlnakyzomp5n6relmtb6ajb2ijrds3uz/sh\r\n            are/aml/html; \\\r\n     367    fi\r\n  >> 368    cp: cannot create directory '/autofs/nccsopen-svm1_home/jgalarowicz\r\n            /luke_assignment/spack/spack_path_placeholder/spack_path_placeholde\r\n            r/spack_path_placeholder/spack_path_placeholder/spack_path_placehol\r\n            der/spack_path_placeholder/spack_path_placeholder/spack_path_placeh\r\n            older/spack_path_placeholder/spack_path_placeholder/spack_path_plac\r\n            eholder/spack_path_placeholder/spack_path_placeholder/spack_path_pl\r\n            aceholder/spack_path_placeholder/spack_path_placeholder/spack_path_\r\n            placeholder/spack_path_placeholder/spack_path_placeholder/spack_pat\r\n            h_placeholder/spack_path_placeholder/spack_path_placeholder/spack_/\r\n            linux-rhel7-ppc64le/gcc-6.4.0/aml-0.1.0-xlnakyzomp5n6relmtb6ajb2ijr\r\n            ds3uz/share/aml/html': No such file or directory\r\n  >> 369    make[2]: *** [install-doc-html] Error 1\r\n     370    make[2]: *** Waiting for unfinished jobs....\r\n     371    make[2]: Leaving directory `/autofs/nccsopen-svm1_home/jgalarowicz/\r\n            tempspack/spack-stage/spack-stage-aml-0.1.0-xlnakyzomp5n6relmtb6ajb\r\n            2ijrds3uz/spack-src/doc'\r\n  >> 372    make[1]: *** [install-am] Error 2\r\n     373    make[1]: Leaving directory `/autofs/nccsopen-svm1_home/jgalarowicz/\r\n            tempspack/spack-stage/spack-stage-aml-0.1.0-xlnakyzomp5n6relmtb6ajb\r\n            2ijrds3uz/spack-src/doc'\r\n  >> 374    make: *** [install-recursive] Error 1\r\n\r\nSee build log for details:\r\n  /ccsopen/home/jgalarowicz/tempspack/spack-stage/spack-stage-aml-0.1.0-xlnakyzomp5n6relmtb6ajb2ijrds3uz/spack-build-out.txt\r\n```\r\n\r\n@freuk ",
    "user": "jgalarowicz",
    "url": "https://api.github.com/repos/spack/spack/issues/18196",
    "updated_at": "2020-10-14 19:15:46",
    "created_at": "2020-08-20 16:59:12",
    "closed_at": "None",
    "state": "open",
    "title": "Installation issue: E4S project: AML will not install on Ascent (ORNL) with gcc/6.4.0 ",
    "number": 18196,
    "milestone": null,
    "labels": [
        "question",
        "build-error",
        "ecp",
        "e4s",
        "olcf"
    ],
    "id": 682913772,
    "html_url": "https://github.com/spack/spack/issues/18196",
    "assignees": [
        "jgalarowicz",
        "eugeneswalker"
    ],
    "comments": 5
}