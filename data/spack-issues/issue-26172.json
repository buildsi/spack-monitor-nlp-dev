{
    "body": "### Steps to reproduce the issue\n\n```console\r\nspack install boost@1.77.00 +python\r\n```\r\n\r\nThis returns (shown here after a `spack clean -a`)\r\n```console\r\n14:41:24 wdconinc@menelaos ~/git/spack (develop *$%>) $ spack install boost@1.77.0 +python\r\n==> Bootstrapping clingo from pre-built binaries\r\n[+] /opt/software/linux-ubuntu21.04-skylake/gcc-10.3.0/libiconv-1.16-oguv65pupoj35le6ruzfn4io3vho2hgk\r\n[+] /opt/software/linux-ubuntu21.04-skylake/gcc-10.3.0/libmd-1.0.3-gvmdq3zn7qdtizaxjx767fxp7frqfbzz\r\n[+] /opt/software/linux-ubuntu21.04-skylake/gcc-10.3.0/pkgconf-1.8.0-uwtf3ig5r35itfi3asyom4lpg2gkfmzv\r\n[+] /opt/software/linux-ubuntu21.04-skylake/gcc-10.3.0/xz-5.2.5-t5fxix4io3zo3uphzerbzinqt7uvxpn5\r\n[+] /opt/software/linux-ubuntu21.04-skylake/gcc-10.3.0/zlib-1.2.11-qpp6a5yzwhdy3omg5garredpixucq5zo\r\n[+] /opt/software/linux-ubuntu21.04-skylake/gcc-10.3.0/libffi-3.3-ooawcyppe7cltqkh7mvvqsfc5m3qilfd\r\n[+] /opt/software/linux-ubuntu21.04-skylake/gcc-10.3.0/berkeley-db-18.1.40-x2pe7jpzisagf4sgtchpuoh4vgauerrb\r\n[+] /opt/software/linux-ubuntu21.04-skylake/gcc-10.3.0/diffutils-3.7-sja32t3coipyuuafdlxh5gwa72xocizo\r\n[+] /opt/software/linux-ubuntu21.04-skylake/gcc-10.3.0/tar-1.34-3gayytud2fduy3otjqp2wf6z2ocpu6wd\r\n[+] /opt/software/linux-ubuntu21.04-skylake/gcc-10.3.0/libbsd-0.11.3-3v2r2qfuuqlizoisejmutrtsy4yav3wf\r\n[+] /opt/software/linux-ubuntu21.04-skylake/gcc-10.3.0/ncurses-6.2-lcrmmmvxigpyuic62yqomn7g72wvv63o\r\n[+] /opt/software/linux-ubuntu21.04-skylake/gcc-10.3.0/util-linux-uuid-2.36.2-2dy6qm3edpl6mbsdxrht7rdbaegivq3l\r\n[+] /opt/software/linux-ubuntu21.04-skylake/gcc-10.3.0/libxml2-2.9.12-26gnpcci5hhdl3gjzxyziickewdsbc63\r\n[+] /opt/software/linux-ubuntu21.04-skylake/gcc-10.3.0/bzip2-1.0.8-t5y2wxsa5qhnwbjujhn325slrjklsj4o\r\n[+] /opt/software/linux-ubuntu21.04-skylake/gcc-10.3.0/expat-2.4.1-ymbmplvqaa3mnvro7k5trarey2awgdbq\r\n[+] /opt/software/linux-ubuntu21.04-skylake/gcc-10.3.0/readline-8.1-37wxiqrh2ysnlhktzmenglecasrooqzc\r\n[+] /opt/software/linux-ubuntu21.04-skylake/gcc-10.3.0/gettext-0.21-5o34s7m7jltizoptpoxzdhvev2b74xvu\r\n[+] /opt/software/linux-ubuntu21.04-skylake/gcc-10.3.0/sqlite-3.36.0-wmtjrxpcehwqpvhq2gyxxlqq2eduwcuw\r\n[+] /opt/software/linux-ubuntu21.04-skylake/gcc-10.3.0/gdbm-1.19-jkpzbn666cxjn24ogx3nynsmdss7m4y7\r\n[+] /opt/software/linux-ubuntu21.04-skylake/gcc-10.3.0/perl-5.34.0-7qrp65zciomd2yyg4upp4pzehcuzaazv\r\n[+] /opt/software/linux-ubuntu21.04-skylake/gcc-10.3.0/openssl-1.1.1l-arq2hqjtmwtxpw7pe2lr3ttccwtde2cw\r\n[+] /opt/software/linux-ubuntu21.04-skylake/gcc-10.3.0/python-3.8.11-f66magi4t6njqqwjkc5khhtf4rc4v75z\r\n==> Installing boost-1.77.0-ymctdrmonrdnpzegyi3tuoh7fxgm6mbi\r\n==> No binary for boost-1.77.0-ymctdrmonrdnpzegyi3tuoh7fxgm6mbi found: installing from source\r\n==> Fetching https://mirror.spack.io/_source-cache/archive/fc/fc9f85fc030e233142908241af7a846e60630aa7388de9a5fafb1f3a26840854.tar.bz2\r\n==> Fetching https://github.com/bfgroup/b2/commit/23212066f0f20358db54568bb16b3fe1d76f88ce.patch\r\n1 out of 4 hunks FAILED -- saving rejects to file tools/build/src/tools/python.jam.rej\r\n==> Patch /home/wdconinc/git/spack/var/spack/repos/builtin/packages/boost/python_jam.patch failed.\r\n==> Error: ProcessError: Command exited with status 1:\r\n    '/usr/bin/patch' '-s' '-p' '1' '-i' '/home/wdconinc/git/spack/var/spack/repos/builtin/packages/boost/python_jam.patch' '-d' '.'\r\n```\n\n### Information on your system\n\n* **Spack:** 0.16.2-4359-dcf4ca9a0e\r\n* **Python:** 3.9.5\r\n* **Platform:** linux-ubuntu21.04-skylake\r\n* **Concretizer:** clingo\r\n\n\n### Additional information\n\nThe issue only happens for `+python` (defaults to off). The patch is only applied for `patch('python_jam.patch', when='@1.56.0: ^python@3:')`.\r\n\r\nThere is no build or env log, but here is the reject hunk `tools/build/src/tools/python.jam.rej`:\r\n```diff\r\n--- tools/build/src/tools/python.jam\r\n+++ tools/build/src/tools/python.jam\r\n@@ -543,7 +547,7 @@ local rule compute-default-paths ( target-os : version ? : prefix ? :\r\n     }\r\n     else\r\n     {\r\n-        includes ?= $(prefix)/include/python$(version) ;\r\n+        includes ?= $(prefix)/include/python$(version)$(abiflags) ;\r\n \r\n         local lib = $(exec-prefix)/lib ;\r\n         libraries ?= $(lib)/python$(version)/config $(lib) ;\r\n```\r\n\r\nThe origin of this issue is the following boost build system commit which changes part of the patched lines: https://github.com/boostorg/build/commit/ca7d1729b160da2f07be5369349dc00b1b8313ef#diff-2d60e472a93312a30ddcfa658afb3e8a07c005127d2f98cbdf08f47ff7d8eebe\r\n\r\nThis commit is included as of 1.77.00.\r\n\r\nSuggested solution could be to create a `python_jam_pre177.patch`, similar to the `python_jam_pre156.patch` which is already there. I don't know what should remain in the `python_jam.patch` since the boost build commit above tries to solve some but not all of what the patch tries to achieve.\r\n\r\nMaintainer tag: @hainest \r\n\r\n\n\n### General information\n\n- [X] I have run `spack debug report` and reported the version of Spack/Python/Platform\n- [X] I have run `spack maintainers <name-of-the-package>` and **@mentioned** any maintainers\n- [X] I have uploaded the build log and environment files\n- [X] I have searched the issues of this repo and believe this is not a duplicate",
    "user": "wdconinc",
    "url": "https://api.github.com/repos/spack/spack/issues/26172",
    "updated_at": "2021-10-01 09:09:33",
    "created_at": "2021-09-22 19:57:49",
    "closed_at": "2021-10-01 09:09:33",
    "state": "closed",
    "title": "Installation issue: boost@1.77.00 +python (python_jam.patch fails)",
    "number": 26172,
    "milestone": null,
    "labels": [
        "build-error"
    ],
    "id": 1004719263,
    "html_url": "https://github.com/spack/spack/issues/26172",
    "assignees": [],
    "comments": 0
}