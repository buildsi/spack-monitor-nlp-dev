{
    "body": "### Steps to reproduce\r\n\r\n- I added user-intel to the package.py file\r\n- Intel compiler and libraries are available in my environment \r\n```\r\n$ spack install lammps%intel +asphere +class2 +kspace +manybody +misc +molecule +mpiio +opt +replica +rigid +user-omp +user-intel ^intel-mkl ^intel-mpi\r\n```\r\n\r\n\r\n\r\n### Error message\r\n\r\n```\r\n(base) bash-4.2$ spack install lammps%intel +asphere +class2 +kspace +manybody +misc +molecule +mpiio +opt +replica +rigid +user-omp +user-intel ^intel-mkl ^intel-mpi\r\n[+] /opt/intel/cmake (external cmake-3.20.0-3teotjsa6webcsazofydfkk2v3pn2hb6)\r\n[+] /nfs/pdx/home/sdouyeb/spack/opt/spack/linux-centos7-skylake_avx512/intel-19.1.3.304/alsa-lib-1.2.3.2-yctbppr2tcdayclbt32xjgagmmwbct2v\r\n[+] /nfs/pdx/home/sdouyeb/spack/opt/spack/linux-centos7-skylake_avx512/intel-19.1.3.304/libiconv-1.16-ilxedtsoqggtmtbrjxehh6ojznmtdni3\r\n[+] /nfs/pdx/home/sdouyeb/spack/opt/spack/linux-centos7-skylake_avx512/intel-19.1.3.304/yasm-1.3.0-7y4fvxshqkmikii3cvelccaiajj4dboc\r\n[+] /nfs/pdx/home/sdouyeb/spack/opt/spack/linux-centos7-skylake_avx512/intel-19.1.3.304/zlib-1.2.11-k24vg36ubsrvwfgrdipndmpqn4eo5jq7\r\n==> Installing cpio-2.13-kyb4ylvxyqlfnfscw6qhqc7i2i2xvdr3\r\n==> No binary for cpio-2.13-kyb4ylvxyqlfnfscw6qhqc7i2i2xvdr3 found: installing from source\r\n==> Using cached archive: /nfs/pdx/home/sdouyeb/spack/var/spack/cache/_source-cache/archive/e8/e87470d9c984317f658567c03bfefb6b0c829ff17dbf6b0de48d71a4c8f3db88.tar.gz\r\n==> No patches needed for cpio\r\n==> cpio: Executing phase: 'autoreconf'\r\n==> cpio: Executing phase: 'configure'\r\n==> cpio: Executing phase: 'build'\r\n==> Error: ProcessError: Command exited with status 2:\r\n    'make' '-j16' 'V=1'\r\n\r\n10 errors found in build log:\r\n     1710    /nfs/pdx/home/sdouyeb/spack/lib/spack/env/intel/icc -std=gnu99 -DHAVE_CONFIG_H -I. -I/tmp/sdouyeb/spack-stage/spack-stage-cpio-2.13-kyb4ylvxyqlfnfscw6qhqc7i2i2xvdr3/spack-src/gnu -I..     -g -\r\n             O2 -MT fd-hook.o -MD -MP -MF .deps/fd-hook.Tpo -c -o fd-hook.o /tmp/sdouyeb/spack-stage/spack-stage-cpio-2.13-kyb4ylvxyqlfnfscw6qhqc7i2i2xvdr3/spack-src/gnu/fd-hook.c\r\n     1711    mv -f .deps/argp-fs-xinl.Tpo .deps/argp-fs-xinl.Po\r\n     1712    /nfs/pdx/home/sdouyeb/spack/lib/spack/env/intel/icc -std=gnu99 -DHAVE_CONFIG_H -I. -I/tmp/sdouyeb/spack-stage/spack-stage-cpio-2.13-kyb4ylvxyqlfnfscw6qhqc7i2i2xvdr3/spack-src/gnu -I..     -g -\r\n             O2 -MT filenamecat-lgpl.o -MD -MP -MF .deps/filenamecat-lgpl.Tpo -c -o filenamecat-lgpl.o /tmp/sdouyeb/spack-stage/spack-stage-cpio-2.13-kyb4ylvxyqlfnfscw6qhqc7i2i2xvdr3/spack-src/gnu/filename\r\n             cat-lgpl.c\r\n     1713    mv -f .deps/argmatch.Tpo .deps/argmatch.Po\r\n     1714    /nfs/pdx/home/sdouyeb/spack/lib/spack/env/intel/icc -std=gnu99 -DHAVE_CONFIG_H -I. -I/tmp/sdouyeb/spack-stage/spack-stage-cpio-2.13-kyb4ylvxyqlfnfscw6qhqc7i2i2xvdr3/spack-src/gnu -I..     -g -\r\n             O2 -MT full-write.o -MD -MP -MF .deps/full-write.Tpo -c -o full-write.o /tmp/sdouyeb/spack-stage/spack-stage-cpio-2.13-kyb4ylvxyqlfnfscw6qhqc7i2i2xvdr3/spack-src/gnu/full-write.c\r\n     1715    In file included from /tmp/sdouyeb/spack-stage/spack-stage-cpio-2.13-kyb4ylvxyqlfnfscw6qhqc7i2i2xvdr3/spack-src/gnu/basename.c(24):\r\n  >> 1716    /tmp/sdouyeb/spack-stage/spack-stage-cpio-2.13-kyb4ylvxyqlfnfscw6qhqc7i2i2xvdr3/spack-src/gnu/xalloc.h(107): error: argument is incompatible with formal parameter\r\n     1717        if (xalloc_oversized (n, s))\r\n     1718            ^\r\n     1719\r\n     1720    In file included from /tmp/sdouyeb/spack-stage/spack-stage-cpio-2.13-kyb4ylvxyqlfnfscw6qhqc7i2i2xvdr3/spack-src/gnu/basename.c(24):\r\n  >> 1721    /tmp/sdouyeb/spack-stage/spack-stage-cpio-2.13-kyb4ylvxyqlfnfscw6qhqc7i2i2xvdr3/spack-src/gnu/xalloc.h(120): error: argument is incompatible with formal parameter\r\n     1722        if (xalloc_oversized (n, s))\r\n     1723            ^\r\n     1724\r\n     1725    mv -f .deps/cloexec.Tpo .deps/cloexec.Po\r\n     1726    compilation aborted for /tmp/sdouyeb/spack-stage/spack-stage-cpio-2.13-kyb4ylvxyqlfnfscw6qhqc7i2i2xvdr3/spack-src/gnu/basename.c (code 2)\r\n     1727    /nfs/pdx/home/sdouyeb/spack/lib/spack/env/intel/icc -std=gnu99 -DHAVE_CONFIG_H -I. -I/tmp/sdouyeb/spack-stage/spack-stage-cpio-2.13-kyb4ylvxyqlfnfscw6qhqc7i2i2xvdr3/spack-src/gnu -I..     -g -\r\n             O2 -MT getprogname.o -MD -MP -MF .deps/getprogname.Tpo -c -o getprogname.o /tmp/sdouyeb/spack-stage/spack-stage-cpio-2.13-kyb4ylvxyqlfnfscw6qhqc7i2i2xvdr3/spack-src/gnu/getprogname.c\r\n  >> 1728    make[4]: *** [basename.o] Error 2\r\n     1729    make[4]: *** Waiting for unfinished jobs....\r\n     1730    In file included from /tmp/sdouyeb/spack-stage/spack-stage-cpio-2.13-kyb4ylvxyqlfnfscw6qhqc7i2i2xvdr3/spack-src/gnu/dirname.c(25):\r\n  >> 1731    /tmp/sdouyeb/spack-stage/spack-stage-cpio-2.13-kyb4ylvxyqlfnfscw6qhqc7i2i2xvdr3/spack-src/gnu/xalloc.h(107): error: argument is incompatible with formal parameter\r\n     1732        if (xalloc_oversized (n, s))\r\n     1733            ^\r\n     1734\r\n     1735    In file included from /tmp/sdouyeb/spack-stage/spack-stage-cpio-2.13-kyb4ylvxyqlfnfscw6qhqc7i2i2xvdr3/spack-src/gnu/dirname.c(25):\r\n  >> 1736    /tmp/sdouyeb/spack-stage/spack-stage-cpio-2.13-kyb4ylvxyqlfnfscw6qhqc7i2i2xvdr3/spack-src/gnu/xalloc.h(120): error: argument is incompatible with formal parameter\r\n     1737        if (xalloc_oversized (n, s))\r\n     1738            ^\r\n     1739\r\n     1740    compilation aborted for /tmp/sdouyeb/spack-stage/spack-stage-cpio-2.13-kyb4ylvxyqlfnfscw6qhqc7i2i2xvdr3/spack-src/gnu/dirname.c (code 2)\r\n  >> 1741    make[4]: *** [dirname.o] Error 2\r\n     1742    mv -f .deps/opendir-safer.Tpo .deps/opendir-safer.Po\r\n     1743    mv -f .deps/close-stream.Tpo .deps/close-stream.Po\r\n     1744    mv -f .deps/stripslash.Tpo .deps/stripslash.Po\r\n     1745    mv -f .deps/exitfail.Tpo .deps/exitfail.Po\r\n     1746    mv -f .deps/closeout.Tpo .deps/closeout.Po\r\n     1747    mv -f .deps/fd-hook.Tpo .deps/fd-hook.Po\r\n\r\n     ...\r\n\r\n     1751    mv -f .deps/argp-fmtstream.Tpo .deps/argp-fmtstream.Po\r\n     1752    mv -f .deps/basename-lgpl.Tpo .deps/basename-lgpl.Po\r\n     1753    mv -f .deps/argp-parse.Tpo .deps/argp-parse.Po\r\n     1754    mv -f .deps/getprogname.Tpo .deps/getprogname.Po\r\n     1755    mv -f .deps/argp-help.Tpo .deps/argp-help.Po\r\n     1756    make[4]: Leaving directory `/tmp/sdouyeb/spack-stage/spack-stage-cpio-2.13-kyb4ylvxyqlfnfscw6qhqc7i2i2xvdr3/spack-src/spack-build/gnu'\r\n  >> 1757    make[3]: *** [all-recursive] Error 1\r\n     1758    make[3]: Leaving directory `/tmp/sdouyeb/spack-stage/spack-stage-cpio-2.13-kyb4ylvxyqlfnfscw6qhqc7i2i2xvdr3/spack-src/spack-build/gnu'\r\n  >> 1759    make[2]: *** [all] Error 2\r\n     1760    make[2]: Leaving directory `/tmp/sdouyeb/spack-stage/spack-stage-cpio-2.13-kyb4ylvxyqlfnfscw6qhqc7i2i2xvdr3/spack-src/spack-build/gnu'\r\n  >> 1761    make[1]: *** [all-recursive] Error 1\r\n     1762    make[1]: Leaving directory `/tmp/sdouyeb/spack-stage/spack-stage-cpio-2.13-kyb4ylvxyqlfnfscw6qhqc7i2i2xvdr3/spack-src/spack-build'\r\n  >> 1763    make: *** [all] Error 2\r\n\r\nSee build log for details:\r\n  /tmp/sdouyeb/spack-stage/spack-stage-cpio-2.13-kyb4ylvxyqlfnfscw6qhqc7i2i2xvdr3/spack-build-out.txt\r\n\r\n==> Warning: Skipping build of intel-mkl-2020.4.304-bqs6ap7tr4dqsclcnrdo4fc3st3zg3wu since cpio-2.13-kyb4ylvxyqlfnfscw6qhqc7i2i2xvdr3 failed\r\n==> Warning: Skipping build of lammps-20210310-o6ikbt7djtst6bwrybn6wialxd34aeuz since intel-mkl-2020.4.304-bqs6ap7tr4dqsclcnrdo4fc3st3zg3wu failed\r\n[+] /nfs/pdx/home/sdouyeb/spack/opt/spack/linux-centos7-skylake_avx512/intel-19.1.3.304/intel-mpi-2019.10.317-jt4mvodu7oyvnyrx3qcjkibv6kgokjai\r\n[+] /nfs/pdx/home/sdouyeb/spack/opt/spack/linux-centos7-skylake_avx512/intel-19.1.3.304/nasm-2.15.05-sutf7mmbppxcrppyqg4zwsfoz3obtibu\r\n[+] /nfs/pdx/home/sdouyeb/spack/opt/spack/linux-centos7-skylake_avx512/intel-19.1.3.304/kim-api-2.2.1-4nbddmiltigebbjjk6vqoulb7z4xzqj3\r\n==> Installing diffutils-3.8-frylsajtddqljwp4sz7vetfm6m6ja47s\r\n==> No binary for diffutils-3.8-frylsajtddqljwp4sz7vetfm6m6ja47s found: installing from source\r\n==> Using cached archive: /nfs/pdx/home/sdouyeb/spack/var/spack/cache/_source-cache/archive/a6/a6bdd7d1b31266d11c4f4de6c1b748d4607ab0231af5188fc2533d0ae2438fec.tar.xz\r\n==> No patches needed for diffutils\r\n==> diffutils: Executing phase: 'autoreconf'\r\n==> diffutils: Executing phase: 'configure'\r\n==> diffutils: Executing phase: 'build'\r\n==> Error: ProcessError: Command exited with status 2:\r\n    'make' '-j16' 'V=1'\r\n\r\n8 errors found in build log:\r\n     1784    depbase=`echo sh-quote.o | sed 's|[^/]*$|.deps/&|;s|\\.o$||'`;\\\r\n     1785    /nfs/pdx/home/sdouyeb/spack/lib/spack/env/intel/icc -std=gnu11  -I. -I/tmp/sdouyeb/spack-stage/spack-stage-diffutils-3.8-frylsajtddqljwp4sz7vetfm6m6ja47s/spack-src/lib      -g -O2 -MT sh-quote\r\n             .o -MD -MP -MF $depbase.Tpo -c -o sh-quote.o /tmp/sdouyeb/spack-stage/spack-stage-diffutils-3.8-frylsajtddqljwp4sz7vetfm6m6ja47s/spack-src/lib/sh-quote.c &&\\\r\n     1786    mv -f $depbase.Tpo $depbase.Po\r\n     1787    depbase=`echo sigsegv.o | sed 's|[^/]*$|.deps/&|;s|\\.o$||'`;\\\r\n     1788    /nfs/pdx/home/sdouyeb/spack/lib/spack/env/intel/icc -std=gnu11  -I. -I/tmp/sdouyeb/spack-stage/spack-stage-diffutils-3.8-frylsajtddqljwp4sz7vetfm6m6ja47s/spack-src/lib      -g -O2 -MT sigsegv.\r\n             o -MD -MP -MF $depbase.Tpo -c -o sigsegv.o /tmp/sdouyeb/spack-stage/spack-stage-diffutils-3.8-frylsajtddqljwp4sz7vetfm6m6ja47s/spack-src/lib/sigsegv.c &&\\\r\n     1789    mv -f $depbase.Tpo $depbase.Po\r\n  >> 1790    /tmp/sdouyeb/spack-stage/spack-stage-diffutils-3.8-frylsajtddqljwp4sz7vetfm6m6ja47s/spack-src/lib/malloca.c(52): error: argument is incompatible with formal parameter\r\n     1791        if (!INT_ADD_WRAPV (n, plus, &nplus) && !xalloc_oversized (nplus, 1))\r\n     1792             ^\r\n     1793\r\n     1794    compilation aborted for /tmp/sdouyeb/spack-stage/spack-stage-diffutils-3.8-frylsajtddqljwp4sz7vetfm6m6ja47s/spack-src/lib/malloca.c (code 2)\r\n  >> 1795    make[2]: *** [malloca.o] Error 2\r\n     1796    make[2]: *** Waiting for unfinished jobs....\r\n  >> 1797    /tmp/sdouyeb/spack-stage/spack-stage-diffutils-3.8-frylsajtddqljwp4sz7vetfm6m6ja47s/spack-src/lib/nstrftime.c(691): error: argument is incompatible with formal parameter\r\n     1798                    if (INT_MULTIPLY_WRAPV (width, 10, &width)\r\n     1799                        ^\r\n     1800\r\n  >> 1801    /tmp/sdouyeb/spack-stage/spack-stage-diffutils-3.8-frylsajtddqljwp4sz7vetfm6m6ja47s/spack-src/lib/nstrftime.c(691): error: argument is incompatible with formal parameter\r\n     1802                    if (INT_MULTIPLY_WRAPV (width, 10, &width)\r\n     1803                        ^\r\n     1804\r\n  >> 1805    /tmp/sdouyeb/spack-stage/spack-stage-diffutils-3.8-frylsajtddqljwp4sz7vetfm6m6ja47s/spack-src/lib/nstrftime.c(692): error: argument is incompatible with formal parameter\r\n     1806                        || INT_ADD_WRAPV (width, *f - L_('0'), &width))\r\n     1807                           ^\r\n     1808\r\n     1809    compilation aborted for /tmp/sdouyeb/spack-stage/spack-stage-diffutils-3.8-frylsajtddqljwp4sz7vetfm6m6ja47s/spack-src/lib/nstrftime.c (code 2)\r\n  >> 1810    make[2]: *** [nstrftime.o] Error 2\r\n     1811    make[2]: Leaving directory `/tmp/sdouyeb/spack-stage/spack-stage-diffutils-3.8-frylsajtddqljwp4sz7vetfm6m6ja47s/spack-src/spack-build/lib'\r\n  >> 1812    make[1]: *** [all] Error 2\r\n     1813    make[1]: Leaving directory `/tmp/sdouyeb/spack-stage/spack-stage-diffutils-3.8-frylsajtddqljwp4sz7vetfm6m6ja47s/spack-src/spack-build/lib'\r\n  >> 1814    make: *** [all-recursive] Error 1\r\n\r\nSee build log for details:\r\n  /tmp/sdouyeb/spack-stage/spack-stage-diffutils-3.8-frylsajtddqljwp4sz7vetfm6m6ja47s/spack-build-out.txt\r\n\r\n==> Warning: Skipping build of bzip2-1.0.8-pdq2pcy3k4c72ebwu35xxna3cjfy4exw since diffutils-3.8-frylsajtddqljwp4sz7vetfm6m6ja47s failed\r\n==> Warning: Skipping build of ffmpeg-4.3.2-arzh4rrmktxv76envvgxwcdgqupqfs3z since bzip2-1.0.8-pdq2pcy3k4c72ebwu35xxna3cjfy4exw failed\r\n[+] /nfs/pdx/home/sdouyeb/spack/opt/spack/linux-centos7-skylake_avx512/intel-19.1.3.304/libpng-1.6.37-nth25mjp6ppkzzolplso5fbsuh7heeao\r\n[+] /nfs/pdx/home/sdouyeb/spack/opt/spack/linux-centos7-skylake_avx512/intel-19.1.3.304/libjpeg-turbo-2.1.0-6lok3eddmml2zcm3zsx3elpw2c5kevrz\r\n==> Error: lammps-20210310-o6ikbt7djtst6bwrybn6wialxd34aeuz: Package was not installed\r\n==> Error: Installation request failed.  Refer to reported errors for failing package(s).\r\n(base) bash-4.2$ spack tahs\r\n==> Error: tahs is not a recognized Spack command or extension command; check with `spack commands`.\r\n(base) bash-4.2$ spack tags\r\n==> Error: tags is not a recognized Spack command or extension command; check with `spack commands`.\r\n(base) bash-4.2$ spack tags ecp ecp-apps ecp-proxy-app\r\n==> Error: tags is not a recognized Spack command or extension command; check with `spack commands`.\r\n```\r\n\r\n\r\n\r\n### Information on your system\r\n\r\nspack debug report \r\n* **Spack:** 0.16.3-4690-3cf426d\r\n* **Python:** 3.6.8\r\n* **Platform:** linux-centos7-skylake_avx512\r\n* **Concretizer:** clingo\r\n\r\n### General information\r\n\r\n- [X] I have run `spack debug report` and reported the version of Spack/Python/Platform\r\n- [X] I have searched the issues of this repo and believe this is not a duplicate\r\n- [X] I have run the failing commands in debug mode and reported the output",
    "user": "Smahane",
    "url": "https://api.github.com/repos/spack/spack/issues/26705",
    "updated_at": "2022-03-09 16:52:34",
    "created_at": "2021-10-13 11:38:23",
    "closed_at": "None",
    "state": "open",
    "title": "LAMMPS failed to install with Intel compiler due to cpio and diffutils",
    "number": 26705,
    "milestone": null,
    "labels": [
        "bug",
        "triage"
    ],
    "id": 1025137736,
    "html_url": "https://github.com/spack/spack/issues/26705",
    "assignees": [],
    "comments": 4
}