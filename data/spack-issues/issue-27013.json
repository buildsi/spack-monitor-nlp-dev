{
    "body": "llvm@11.1.0 does not build with gcc@11 (see [1]). \r\nThe patch that fixes llvm@10 does also work for llvm@10 so that the build succeeds.\r\n\r\n[1]:\r\n```\r\n==> Installing llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea\r\n==> No binary for llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea found: installing from source\r\n==> Using cached archive: $spack/var/spack/cache/_source-cache/archive/53/53a0719f3f4b0388013cfffd7b10c7d5682eece1929a9553c722348d1f866e79.tar.gz\r\n==> No patches needed for llvm\r\n==> llvm: Executing phase: 'cmake'\r\n==> llvm: Executing phase: 'build'\r\n==> Error: ProcessError: Command exited with status 2:\r\n    'make' '-j4'\r\n\r\n5 errors found in build log:\r\n     4131    [  7%] Building CXX object utils/benchmark/src/CMakeFiles/benchmark.dir/benchmark.cc.o\r\n     4132    cd $stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-build-pe7cvut/utils\r\n             /benchmark/src && $spack/lib/spack/env/gcc/g++ -DHAVE_POSIX_REGEX -DHAVE_STD_REGEX -DHAVE_STE\r\n             ADY_CLOCK -D_GNU_SOURCE -D__STDC_CONSTANT_MACROS -D__STDC_FORMAT_MACROS -D__STDC_LIMIT_MACROS -I$stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-build-pe7cvut/utils/benchmark/src -I$stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-src/llvm/utils/benchmark/src -I$spack/opt/spack/linux-fedora32-haswell/gcc-11.2.0/libxml2-2.9.12-7jqzymjvos2b366hifprujd3egeil4ne/include/libxml2 -I$stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-build-pe7cvut/include -I$stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-src/llvm/include -I$stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-src/llvm/utils/benchmark/include -I$stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-src/llvm/utils/benchmark/src/../include -std=c++11 -fPIC -fvisibility-inlines-hidden -Werror=date-time -Wall -Wextra -Wno-unused-parameter -Wwrite-strings -Wcast-qual -Wno-missing-field-initializers -pedantic -Wno-long-long -Wimplicit-fallthrough -Wno-maybe-uninitialized -Wno-class-memaccess -Wno-redundant-move -Wno-noexcept-type -Wdelete-non-virtual-dtor -Wno-comment -ffunction-sections -fdata-sections  -std=c++11  -Wall  -Wextra  -Wshadow  -pedantic  -pedantic-errors  -Wfloat-equal  -fstrict-aliasing  -fno-exceptions  -Wstrict-aliasing -O3 -DNDEBUG -std=c++14 -MD -MT utils/benchmark/src/CMakeFiles/benchmark.dir/benchmark.cc.o -MF CMakeFiles/benchmark.dir/benchmark.cc.o.d -o CMakeFiles/benchmark.dir/benchmark.cc.o -c $stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-src/llvm/utils/benchmark/src/benchmark.cc\r\n     4133    [  7%] Building CXX object utils/benchmark/src/CMakeFiles/benchmark.dir/benchmark_register.cc.o\r\n     4134    cd $stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-build-pe7cvut/utils/benchmark/src && $spack/lib/spack/env/gcc/g++ -DHAVE_POSIX_REGEX -DHAVE_STD_REGEX -DHAVE_STEADY_CLOCK -D_GNU_SOURCE -D__STDC_CONSTANT_MACROS -D__STDC_FORMAT_MACROS -D__STDC_LIMIT_MACROS -I$stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-build-pe7cvut/utils/benchmark/src -I$stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-src/llvm/utils/benchmark/src -I$spack/opt/spack/linux-fedora32-haswell/gcc-11.2.0/libxml2-2.9.12-7jqzymjvos2b366hifprujd3egeil4ne/include/libxml2 -I$stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-build-pe7cvut/include -I$stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-src/llvm/include -I$stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-src/llvm/utils/benchmark/include -I$stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-src/llvm/utils/benchmark/src/../include -std=c++11 -fPIC -fvisibility-inlines-hidden -Werror=date-time -Wall -Wextra -Wno-unused-parameter -Wwrite-strings -Wcast-qual -Wno-missing-field-initializers -pedantic -Wno-long-long -Wimplicit-fallthrough -Wno-maybe-uninitialized -Wno-class-memaccess -Wno-redundant-move -Wno-noexcept-type -Wdelete-non-virtual-dtor -Wno-comment -ffunction-sections -fdata-sections  -std=c++11  -Wall  -Wextra  -Wshadow  -pedantic  -pedantic-errors  -Wfloat-equal  -fstrict-aliasing  -fno-exceptions  -Wstrict-aliasing -O3 -DNDEBUG-std=c++14 -MD -MT utils/benchmark/src/CMakeFiles/benchmark.dir/benchmark_register.cc.o -MF CMakeFiles/benchmark.dir/benchmark_register.cc.o.d -o CMakeFiles/benchmark.dir/benchmark_register.cc.o -c $stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-src/llvm/utils/benchmark/src/benchmark_register.cc\r\n     4135    In file included from $stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-src/llvm/utils/benchmark/src/benchmark_register.cc:15:\r\n     4136    $stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-src/llvm/utils/benchmark/src/benchmark_register.h: In function 'void AddRange(std::vector<T>*, T, T, int)':\r\n  >> 4137    $stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-src/llvm/utils/benchmark/src/benchmark_register.h:17:30: error: 'numeric_limits' is not a member of 'std'\r\n     4138       17 |   static const T kmax = std::numeric_limits<T>::max();\r\n     4139          |                              ^~~~~~~~~~~~~~\r\n  >> 4140    $stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-src/llvm/utils/benchmark/src/benchmark_register.h:17:46: error: expected primary-expression before '>' token\r\n     4141       17 |   static const T kmax = std::numeric_limits<T>::max();\r\n     4142          |                                              ^\r\n  >> 4143    $stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-src/llvm/utils/benchmark/src/benchmark_register.h:17:49: error: '::max' has not been declared; did you mean 'std::max'?\r\n     4144       17 |   static const T kmax = std::numeric_limits<T>::max();\r\n     4145          |                                                 ^~~\r\n     4146          |                                                 std::max\r\n     4147    In file included from $spack/opt/spack/linux-fedora32-haswell/gcc-10.3.1/gcc-11.2.0-3tjvptoh34f42eyyuunfdoohaaqk5ypz/include/c++/11.2.0/algorithm:62,\r\n     4148                     from $stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-src/llvm/utils/benchmark/include/benchmark/benchmark.h:175,\r\n     4149                     from $stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-src/llvm/utils/benchmark/src/internal_macros.h:4,\r\n\r\n     ...\r\n\r\n     4154     3467 |     max(initializer_list<_Tp> __l, _Compare __comp)\r\n     4155          |     ^~~\r\n     4156    [  7%] Building CXX object tools/clang/utils/TableGen/CMakeFiles/obj.clang-tblgen.dir/ClangOpcodesEmitter.cpp.o\r\n     4157    cd $stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-build-pe7cvut/tools/clang/utils/TableGen && $spack/lib/spack/env/gcc/g++ -D_GNU_SOURCE -D__STDC_CONSTANT_MACROS-D__STDC_FORMAT_MACROS -D__STDC_LIMIT_MACROS -I$stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-build-pe7cvut/tools/clang/utils/TableGen -I$stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-src/clang/utils/TableGen -I$stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-src/clang/include -I$stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-build-pe7cvut/tools/clang/include -I$spack/opt/spack/linux-fedora32-haswell/gcc-11.2.0/libxml2-2.9.12-7jqzymjvos2b366hifprujd3egeil4ne/include/libxml2 -I$stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-build-pe7cvut/include -I$stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-src/llvm/include -std=c++11 -fPIC -fvisibility-inlines-hidden -Werror=date-time -Wall -Wextra -Wno-unused-parameter -Wwrite-strings -Wcast-qual -Wno-missing-field-initializers -pedantic -Wno-long-long -Wimplicit-fallthrough -Wno-maybe-uninitialized -Wno-class-memaccess -Wno-redundant-move -Wno-noexcept-type -Wdelete-non-virtual-dtor -Wno-comment -ffunction-sections -fdata-sections -fno-common -Woverloaded-virtual -fno-strict-aliasing -O3 -DNDEBUG -std=c++14 -MD -MT tools/clang/utils/TableGen/CMakeFiles/obj.clang-tblgen.dir/ClangOpcodesEmitter.cpp.o -MF CMakeFiles/obj.clang-tblgen.dir/ClangOpcodesEmitter.cpp.o.d -o CMakeFiles/obj.clang-tblgen.dir/ClangOpcodesEmitter.cpp.o -c $stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-src/clang/utils/TableGen/ClangOpcodesEmitter.cpp\r\n     4158    [  7%] Building CXX object tools/clang/utils/TableGen/CMakeFiles/obj.clang-tblgen.dir/ClangOpenCLBuiltinEmitter.cpp.o\r\n     4159    cd $stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-build-pe7cvut/tools/clang/utils/TableGen && $spack/lib/spack/env/gcc/g++ -D_GNU_SOURCE -D__STDC_CONSTANT_MACROS -D__STDC_FORMAT_MACROS -D__STDC_LIMIT_MACROS -I$stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-build-pe7cvut/tools/clang/utils/TableGen -I$stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-src/clang/utils/TableGen -I$stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-src/clang/include -I$stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-build-pe7cvut/tools/clang/include -I$spack/opt/spack/linux-fedora32-haswell/gcc-11.2.0/libxml2-2.9.12-7jqzymjvos2b366hifprujd3egeil4ne/include/libxml2 -I$stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-build-pe7cvut/include -I$stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-src/llvm/include -std=c++11 -fPIC -fvisibility-inlines-hidden -Werror=date-time -Wall -Wextra -Wno-unused-parameter -Wwrite-strings -Wcast-qual -Wno-missing-field-initializers -pedantic -Wno-long-long -Wimplicit-fallthrough -Wno-maybe-uninitialized -Wno-class-memaccess -Wno-redundant-move -Wno-noexcept-type -Wdelete-non-virtual-dtor -Wno-comment -ffunction-sections -fdata-sections -fno-common -Woverloaded-virtual -fno-strict-aliasing -O3 -DNDEBUG -std=c++14 -MD -MT tools/clang/utils/TableGen/CMakeFiles/obj.clang-tblgen.dir/ClangOpenCLBuiltinEmitter.cpp.o -MF CMakeFiles/obj.clang-tblgen.dir/ClangOpenCLBuiltinEmitter.cpp.o.d -o CMakeFiles/obj.clang-tblgen.dir/ClangOpenCLBuiltinEmitter.cpp.o -c $stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-src/clang/utils/TableGen/ClangOpenCLBuiltinEmitter.cpp\r\n  >> 4160    make[2]: *** [utils/benchmark/src/CMakeFiles/benchmark.dir/build.make:93: utils/benchmark/src/CMakeFiles/benchmark.dir/benchmark_register.cc.o] Error 1\r\n     4161    make[2]: Leaving directory '$stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-build-pe7cvut'\r\n  >> 4162    make[1]: *** [CMakeFiles/Makefile2:220007: utils/benchmark/src/CMakeFiles/benchmark.dir/all] Error 2\r\n     4163    make[1]: *** Waiting for unfinished jobs....\r\n     4164    [  7%] Building CXX object tools/clang/utils/TableGen/CMakeFiles/obj.clang-tblgen.dir/ClangOptionDocEmitter.cpp.o\r\n     4165    cd $stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-build-pe7cvut/tools/clang/utils/TableGen && $spack/lib/spack/env/gcc/g++ -D_GNU_SOURCE -D__STDC_CONSTANT_MACROS -D__STDC_FORMAT_MACROS -D__STDC_LIMIT_MACROS -I$stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-build-pe7cvut/tools/clang/utils/TableGen -I$stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-src/clang/utils/TableGen -I$stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-src/clang/include -I$stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-build-pe7cvut/tools/clang/include -I$spack/opt/spack/linux-fedora32-haswell/gcc-11.2.0/libxml2-2.9.12-7jqzymjvos2b366hifprujd3egeil4ne/include/libxml2 -I$stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-build-pe7cvut/include -I$stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-src/llvm/include -std=c++11 -fPIC -fvisibility-inlines-hidden -Werror=date-time -Wall -Wextra -Wno-unused-parameter -Wwrite-strings -Wcast-qual -Wno-missing-field-initializers -pedantic -Wno-long-long -Wimplicit-fallthrough -Wno-maybe-uninitialized -Wno-class-memaccess -Wno-redundant-move -Wno-noexcept-type -Wdelete-non-virtual-dtor -Wno-comment -ffunction-sections -fdata-sections -fno-common -Woverloaded-virtual -fno-strict-aliasing -O3 -DNDEBUG -std=c++14 -MD -MT tools/clang/utils/TableGen/CMakeFiles/obj.clang-tblgen.dir/ClangOptionDocEmitter.cpp.o -MF CMakeFiles/obj.clang-tblgen.dir/ClangOptionDocEmitter.cpp.o.d -o CMakeFiles/obj.clang-tblgen.dir/ClangOptionDocEmitter.cpp.o -c $stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-src/clang/utils/TableGen/ClangOptionDocEmitter.cpp\r\n     4166    [  7%] Building CXX object tools/clang/utils/TableGen/CMakeFiles/obj.clang-tblgen.dir/ClangSACheckersEmitter.cpp.o\r\n     4167    cd $stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-build-pe7cvut/tools/clang/utils/TableGen && $spack/lib/spack/env/gcc/g++ -D_GNU_SOURCE -D__STDC_CONSTANT_MACROS -D__STDC_FORMAT_MACROS -D__STDC_LIMIT_MACROS -I$stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-build-pe7cvut/tools/clang/utils/TableGen -I$stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-src/clang/utils/TableGen -I$stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-src/clang/include -I$stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-build-pe7cvut/tools/clang/include -I$spack/opt/spack/linux-fedora32-haswell/gcc-11.2.0/libxml2-2.9.12-7jqzymjvos2b366hifprujd3egeil4ne/include/libxml2 -I$stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-build-pe7cvut/include -I$stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-src/llvm/include -std=c++11 -fPIC -fvisibility-inlines-hidden -Werror=date-time -Wall -Wextra -Wno-unused-parameter -Wwrite-strings -Wcast-qual -Wno-missing-field-initializers -pedantic -Wno-long-long -Wimplicit-fallthrough -Wno-maybe-uninitialized -Wno-class-memaccess -Wno-redundant-move -Wno-noexcept-type -Wdelete-non-virtual-dtor -Wno-comment -ffunction-sections -fdata-sections -fno-common -Woverloaded-virtual -fno-strict-aliasing -O3 -DNDEBUG -std=c++14 -MD -MT tools/clang/utils/TableGen/CMakeFiles/obj.clang-tblgen.dir/ClangSACheckersEmitter.cpp.o -MF CMakeFiles/obj.clang-tblgen.dir/ClangSACheckersEmitter.cpp.o.d -o CMakeFiles/obj.clang-tblgen.dir/ClangSACheckersEmitter.cpp.o -c $stage/spack-stage-llvm-11.1.0-pe7cvutgpdyy5xc5xjoclsp5fcgswbea/spack-src/clang/utils/TableGen/ClangSACheckersEmitter.cpp\r\n     4168    [  7%] Building CXX object tools/clang/utils/TableGen/CMakeFiles/obj.clang-tblgen.dir/ClangTypeNodesEmitter.cpp.o\r\n```",
    "user": "manuelakuhn",
    "url": "https://api.github.com/repos/spack/spack/issues/27013",
    "updated_at": "2021-10-28 22:09:27",
    "created_at": "2021-10-28 14:09:30",
    "closed_at": "2021-10-28 22:07:56",
    "state": "closed",
    "title": "llvm: fix @11 for gcc@11",
    "number": 27013,
    "milestone": null,
    "labels": [
        "update-package"
    ],
    "id": 1038566429,
    "html_url": "https://github.com/spack/spack/pull/27013",
    "assignees": [],
    "comments": 3
}