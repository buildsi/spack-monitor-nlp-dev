{
    "body": "### Expected Result\r\n\r\nspack install works as directed or gives an appropriate explanation as to why it fails\r\n\r\n### Actual Result\r\n\r\nspack throws up Error with no explanation at all. \r\n\r\nFor example : \r\n```\r\n[sajid@xrmlite ncurses-6.0]$ spack install python@3.6.5 %intel@19.0.0.046\r\n==> bzip2 is already installed in /home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-19.0.0.046/bzip2-1.0.6-g6epdp7y4ina5z52yf5xpz74sngpkzyg\r\n==> pkgconf is already installed in /home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-19.0.0.046/pkgconf-1.4.0-jjsb5qolv2aoepxe2zicbj2qnlu2jez3\r\n==> Error:\r\n```\r\n\r\n### --debug output \r\n```\r\n[sajid@xrmlite ncurses-6.0]$ spack --debug install python@3.6.5 %intel@19.0.0.046                                                                                                           \r\n==> Reading config file /home/sajid/packages/spack/etc/spack/defaults/packages.yaml                                                                                                         \r\n==> Reading config file /home/sajid/.spack/packages.yaml                                                                                                                                    \r\n==> READ LOCK: /home/sajid/.spack/cache/providers/.builtin-index.yaml.lock[0:0] [Acquiring]                                                                                                 \r\n==> READ LOCK: /home/sajid/.spack/cache/providers/.builtin-index.yaml.lock[0:0] [Acquired]                                                                                                  \r\n==> READ LOCK: /home/sajid/.spack/cache/providers/.builtin-index.yaml.lock[0:0] [Released]                                                                                                  \r\n==> Reading config file /home/sajid/.spack/linux/compilers.yaml                                                                                                                             \r\n==> WRITE LOCK: /home/sajid/packages/spack/opt/spack/.spack-db/prefix_lock[6417505941298829586:1] [Acquiring]                                                                               \r\n==> WRITE LOCK: /home/sajid/packages/spack/opt/spack/.spack-db/prefix_lock[6417505941298829586:1] [Acquired]                                                                                \r\n==> READ LOCK: /home/sajid/packages/spack/opt/spack/.spack-db/lock[0:0] [Acquiring]                                                                                                         \r\n==> READ LOCK: /home/sajid/packages/spack/opt/spack/.spack-db/lock[0:0] [Acquired]                                                                                                          \r\n==> READ LOCK: /home/sajid/packages/spack/opt/spack/.spack-db/lock[0:0] [Released]                                                                                                          \r\n==> WRITE LOCK: /home/sajid/packages/spack/opt/spack/.spack-db/prefix_lock[6417505941298829586:1] [Released]                                                                                \r\n==> link /home/sajid/packages/spack/var/spack/stage/python-3.6.5-wipr6tpoe2zckamozzji3ucpchg6cyae -> /home/sajid/Documents/build_temp/spack-stage/spack-stage-wvH0H9                        \r\n==> READ LOCK: /home/sajid/packages/spack/opt/spack/.spack-db/prefix_lock[6417505941298829586:1] [Acquiring]                                                                                \r\n==> READ LOCK: /home/sajid/packages/spack/opt/spack/.spack-db/prefix_lock[6417505941298829586:1] [Acquired]                                                                                 \r\n==> READ LOCK: /home/sajid/packages/spack/opt/spack/.spack-db/prefix_lock[6417505941298829586:1] [Released]                                                                                 \r\n==> Installing python dependencies                                                                                                                                                          \r\n==> WRITE LOCK: /home/sajid/packages/spack/opt/spack/.spack-db/prefix_lock[2000857037867650311:1] [Acquiring]                                                                               \r\n==> WRITE LOCK: /home/sajid/packages/spack/opt/spack/.spack-db/prefix_lock[2000857037867650311:1] [Acquired]                                                                                \r\n==> WRITE LOCK: /home/sajid/packages/spack/opt/spack/.spack-db/prefix_lock[2000857037867650311:1] [Released]                                                                                \r\n==> link /home/sajid/packages/spack/var/spack/stage/bzip2-1.0.6-g6epdp7y4ina5z52yf5xpz74sngpkzyg -> /home/sajid/Documents/build_temp/spack-stage/spack-stage-bzPW7F                         \r\n==> READ LOCK: /home/sajid/packages/spack/opt/spack/.spack-db/prefix_lock[2000857037867650311:1] [Acquiring]                                                                                \r\n==> READ LOCK: /home/sajid/packages/spack/opt/spack/.spack-db/prefix_lock[2000857037867650311:1] [Acquired]                                                                                 \r\n==> bzip2 is already installed in /home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-19.0.0.046/bzip2-1.0.6-g6epdp7y4ina5z52yf5xpz74sngpkzyg                                   \r\n==> READ LOCK: /home/sajid/packages/spack/opt/spack/.spack-db/prefix_lock[2000857037867650311:1] [Released]                                                                                 \r\n==> WRITE LOCK: /home/sajid/packages/spack/opt/spack/.spack-db/prefix_lock[2680221637086232689:1] [Acquiring]                                                                               \r\n==> WRITE LOCK: /home/sajid/packages/spack/opt/spack/.spack-db/prefix_lock[2680221637086232689:1] [Acquired]                                                                                \r\n==> WRITE LOCK: /home/sajid/packages/spack/opt/spack/.spack-db/prefix_lock[2680221637086232689:1] [Released]                                                                                \r\n==> link /home/sajid/packages/spack/var/spack/stage/pkgconf-1.4.0-jjsb5qolv2aoepxe2zicbj2qnlu2jez3 -> /home/sajid/Documents/build_temp/spack-stage/spack-stage-5bduq9                       \r\n==> READ LOCK: /home/sajid/packages/spack/opt/spack/.spack-db/prefix_lock[2680221637086232689:1] [Acquiring]                                                                                \r\n==> READ LOCK: /home/sajid/packages/spack/opt/spack/.spack-db/prefix_lock[2680221637086232689:1] [Acquired]                                                                                 \r\n==> pkgconf is already installed in /home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-19.0.0.046/pkgconf-1.4.0-jjsb5qolv2aoepxe2zicbj2qnlu2jez3                               \r\n==> READ LOCK: /home/sajid/packages/spack/opt/spack/.spack-db/prefix_lock[2680221637086232689:1] [Released]                                                                                 \r\n==> WRITE LOCK: /home/sajid/packages/spack/opt/spack/.spack-db/prefix_lock[372156640868993180:1] [Acquiring]                                                                                \r\nTraceback (most recent call last):                                                                                                                                                          \r\n  File \"/home/sajid/packages/spack/bin/spack\", line 85, in <module>                                                                                                                         \r\n    sys.exit(spack.main.main())                                                                                                                                                             \r\n  File \"/home/sajid/packages/spack/lib/spack/spack/main.py\", line 577, in main                                                                                                              \r\n    return _main(command, parser, args, unknown)                                                                                                                                            \r\n  File \"/home/sajid/packages/spack/lib/spack/spack/main.py\", line 469, in _main                                                                                                             \r\n    return _invoke_spack_command(command, parser, args, unknown_args)                                                                                                                       \r\n  File \"/home/sajid/packages/spack/lib/spack/spack/main.py\", line 381, in _invoke_spack_command                                                                                             \r\n    return_val = command(parser, args)                                                                                                                                                      \r\n  File \"/home/sajid/packages/spack/lib/spack/spack/cmd/install.py\", line 256, in install                                                                                                    \r\n    install_spec(args, kwargs, spec)                                                                                                                                                        \r\n  File \"/home/sajid/packages/spack/lib/spack/spack/cmd/install.py\", line 150, in install_spec                                                                                               \r\n    spec.package.do_install(**kwargs)                                                                                                                                                       \r\n  File \"/home/sajid/packages/spack/lib/spack/spack/package.py\", line 1448, in do_install                                                                                                    \r\n    **kwargs)                                                                                                                                                                               \r\n  File \"/home/sajid/packages/spack/lib/spack/spack/package.py\", line 1411, in do_install                                                                                                    \r\n    partial = self.check_for_unfinished_installation(keep_prefix, restage)                                                                                                                  \r\n  File \"/home/sajid/packages/spack/lib/spack/spack/package.py\", line 1600, in check_for_unfinished_installation                                                                             \r\n    with spack.store.db.prefix_write_lock(self.spec):                                                                                                                                       \r\n  File \"/usr/lib64/python2.7/contextlib.py\", line 17, in __enter__                                                                                                                          \r\n    return self.gen.next()                                                                                                                                                                  \r\n  File \"/home/sajid/packages/spack/lib/spack/spack/database.py\", line 258, in prefix_write_lock                                                                                             \r\n    prefix_lock.release_write()                                                                                                                                                             \r\n  File \"/home/sajid/packages/spack/lib/spack/llnl/util/lock.py\", line 265, in release_write                                                                                                 \r\n    assert self._writes > 0                                                                                                                                                                 \r\nAssertionError                                                                                                                                                                              \r\n```\r\n\r\n### Information\r\nsystem : linnux-centos7-x86_64\r\nspack version : develop (up to date)  ",
    "user": "s-sajid-ali",
    "url": "https://api.github.com/repos/spack/spack/issues/7935",
    "updated_at": "2020-03-01 02:14:03",
    "created_at": "2018-04-27 20:40:59",
    "closed_at": "2020-02-29 12:15:00",
    "state": "closed",
    "title": "spack install throws up Error with no explanation, output of --debug included",
    "number": 7935,
    "milestone": null,
    "labels": [
        "build-error",
        "pkg-database",
        "locking"
    ],
    "id": 318543252,
    "html_url": "https://github.com/spack/spack/issues/7935",
    "assignees": [],
    "comments": 6
}