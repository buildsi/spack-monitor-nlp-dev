{
    "body": "I am currently trying to install qr_mumps with spack fork fpruvost on a cluster under CentOS release 6.6. \nOne of the required dependencies is scotch@6.0.4%gcc@5.4.0~compression+esmumps~grf~idx64~mpi+pthread+shared arch=linux-x86_64. Sadly, upon installation, an error is returned:\n\n``` bash\n$ spack install qr_mumps \n==> Installing qr_mumps\n==> hwloc is already installed in /scratch/algo/leleux/spack/opt/spack/linux-x86_64/gcc-5.4.0/hwloc-1.11.4-ek6anw4f44p6jti4pnc34y46fxkt5x3z\n==> starpu is already installed in /scratch/algo/leleux/spack/opt/spack/linux-x86_64/gcc-5.4.0/starpu-1.2.0-wwvw32o4qqqoz7rq3ys2acmaypoijf2o\n==> metis is already installed in /scratch/algo/leleux/spack/opt/spack/linux-x86_64/gcc-5.4.0/metis-5.1.0-rvrnhec7jslgnhl3cik5bdzqbmd53d72\n==> colamd is already installed in /scratch/algo/leleux/spack/opt/spack/linux-x86_64/gcc-5.4.0/colamd-4.4.6-ok27qzictplufjjhzkcmlrr5sszbxmrh\n==> Installing scotch\n==> Already downloaded /scratch/algo/leleux/spack/var/spack/stage/scotch-6.0.4-wszgyliyepnqz36xo7optynyzwleazmm/scotch_6.0.4.tar.gz\n==> Already staged scotch-6.0.4-wszgyliyepnqz36xo7optynyzwleazmm in /scratch/algo/leleux/spack/var/spack/stage/scotch-6.0.4-wszgyliyepnqz36xo7optynyzwleazmm\n==> No patches needed for scotch\n==> Building scotch\n==> Error: Command exited with status 2:\n'make' 'scotch'\n\nSee build log for details:\n  /tmp/leleux/spack-stage/spack-stage-UBqDX5/scotch_6.0.4/spack-build.out\n\n/scratch/algo/leleux/spack/var/spack/repos/builtin/packages/scotch/package.py:183, in install:\n     169      def install(self, spec, prefix):\n     170          self.setup()\n     171  \n     172          targets = ['scotch']\n     173          if spec.satisfies('+mpi'):\n     174              targets.append('ptscotch')\n     175  \n     176          if spec.satisfies('+esmumps'):\n     177              targets.append('esmumps')\n     178              if spec.satisfies('+mpi'):\n     179                  targets.append('ptesmumps')\n     180  \n     181          with working_dir('src'):\n     182              for app in targets:\n  >> 183                  make(app, parallel=0)\n     184              make('prefix=%s' % prefix, 'install')\n     185              # esmumps libs are not installed by default (is it a mistake?)\n     186              if spec.satisfies('+shared'):\n     187                  if platform.system() == 'Darwin':\n     188                      libext = \".dylib\"\n     189                  else:\n     190                      libext = \".so\"\n     191              else:\n     192                  libext = \".a\"\n     193              if spec.satisfies('+esmumps'):\n     194                  install('../include/esmumps.h',   prefix.include)\n     195                  install('../lib/libesmumps%s' % libext,   prefix.lib)\n     196                  if spec.satisfies('+mpi'):\n     197                      install('../lib/libptesmumps%s' % libext, prefix.lib)\n     198  \n     199          if spec.satisfies('+grf'):\n     200              with working_dir('grf'):\n     201                  for f in os.listdir('.'):\n     202                      gunzip(f)\n     203              install_tree('grf', prefix + '/grf')\n==> Error: Installation process had nonzero exit code.\n```\n\nHere is the content of the log file \"spack-build.out\":\n\n``` bash\n==> 'make' 'scotch'\n(cd libscotch ;      make VERSION=6 RELEASE=0 PATCHLEVEL=4 scotch && make install)\nmake[1]: Entering directory `/tmp/leleux/spack-stage/spack-stage-1t0gKq/scotch_6.0.4/src/libscotch'\nmake CC=\"cc\" CCD=\"cc\"   \\\n                    scotch.h                \\\n                    scotchf.h               \\\n                    libscotch.so                \\\n                    libscotcherr.so         \\\n                    libscotcherrexit.so\nmake[2]: Entering directory `/tmp/leleux/spack-stage/spack-stage-1t0gKq/scotch_6.0.4/src/libscotch'\nmake[2]: `scotch.h' is up to date.\nmake[2]: `scotchf.h' is up to date.\nmake[2]: `libscotch.so' is up to date.\nmake[2]: `libscotcherr.so' is up to date.\nmake[2]: `libscotcherrexit.so' is up to date.\nmake[2]: Leaving directory `/tmp/leleux/spack-stage/spack-stage-1t0gKq/scotch_6.0.4/src/libscotch'\nmake[1]: Leaving directory `/tmp/leleux/spack-stage/spack-stage-1t0gKq/scotch_6.0.4/src/libscotch'\nmake[1]: Entering directory `/tmp/leleux/spack-stage/spack-stage-1t0gKq/scotch_6.0.4/src/libscotch'\nmake[1]: Nothing to be done for `install'.\nmake[1]: Leaving directory `/tmp/leleux/spack-stage/spack-stage-1t0gKq/scotch_6.0.4/src/libscotch'\n(cd scotch ;         make VERSION=6 RELEASE=0 PATCHLEVEL=4 scotch && make install)\nmake[1]: Entering directory `/tmp/leleux/spack-stage/spack-stage-1t0gKq/scotch_6.0.4/src/scotch'\nmake CC=\"cc\" SCOTCHLIB=scotch   \\\n                    acpl                \\\n                    amk_ccc             \\\n                    amk_fft2                \\\n                    amk_grf             \\\n                    amk_hy              \\\n                    amk_m2              \\\n                    amk_p2              \\\n                    atst                \\\n                    gbase               \\\n                    gcv             \\\n                    gmap                \\\n                    gmk_hy              \\\n                    gmk_m2              \\\n                    gmk_m3              \\\n                    gmk_msh             \\\n                    gmk_ub2             \\\n                    gmtst               \\\n                    gord                \\\n                    gotst               \\\n                    gout                \\\n                    gpart               \\\n                    gscat               \\\n                    gtst                \\\n                    mcv             \\\n                    mmk_m2              \\\n                    mmk_m3              \\\n                    mord                \\\n                    mtst\nmake[2]: Entering directory `/tmp/leleux/spack-stage/spack-stage-1t0gKq/scotch_6.0.4/src/scotch'\ncc -O3 -DCOMMON_TIMING_OLD -DCOMMON_RANDOM_FIXED_SEED -DSCOTCH_DETERMINISTIC -DSCOTCH_RENAME -Drestrict=__restrict -DCOMMON_PTHREAD -DCOMMON_PTHREAD_BARRIER -I../../include -I../libscotch acpl.c -o acpl -L../../lib -lscotch -lscotch -lscotcherrexit -lm -lrt -pthread\n../../lib/libscotch.so: undefined reference to `scotchyylex'\ncollect2: error: ld returned 1 exit status\nmake[2]: *** [acpl] Error 1\nmake[2]: Leaving directory `/tmp/leleux/spack-stage/spack-stage-1t0gKq/scotch_6.0.4/src/scotch'\nmake[1]: *** [scotch] Error 2\nmake[1]: Leaving directory `/tmp/leleux/spack-stage/spack-stage-1t0gKq/scotch_6.0.4/src/scotch'\nmake: *** [scotch] Error 2\n```\n\nIt seems to be a problem of linking with the scotch library but I cannot figure out how to make it compile. Do you think of any way I could solve this ?\n",
    "user": "Philou31",
    "url": "https://api.github.com/repos/spack/spack/issues/2161",
    "updated_at": "2017-01-09 17:18:37",
    "created_at": "2016-10-28 14:18:21",
    "closed_at": "2017-01-09 17:18:37",
    "state": "closed",
    "title": "Undefined reference to 'scotchyylex' during installation of scotch",
    "number": 2161,
    "milestone": null,
    "labels": [],
    "id": 185934995,
    "html_url": "https://github.com/spack/spack/issues/2161",
    "assignees": [],
    "comments": 1
}