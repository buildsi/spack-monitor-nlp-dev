{
    "body": "### Steps to reproduce the issue\n\nMy ultimate goal is to install all R packages available in Spack (@glennpj ). For this purpose, I follow these steps:\r\n```sh\r\n$ spack env create r-4_1\r\n$ spacktivate -p r-4_1\r\n$ spack add $(spack list r-*)\r\n```\r\nThen, I add the following to the environment config file:\r\n```yaml\r\n  config:\r\n    install_missing_compilers: true\r\n    concretizer: clingo\r\n    use_curl: true\r\n  concretization: together\r\n  packages:\r\n    r:\r\n      version:\r\n      - 4.1.1\r\n      variants: +X+rmath\r\n```\r\n\r\nFinally, I concretize and install packages:\r\n\r\n```sh\r\n$ spack -d concretize\r\n$ spack -d install\r\n```\r\n\r\nWhen installing, there are certain packages that fail at building step:\r\n\r\n- `r-tictoc`: it seems the error is not related to spack but to the original package: \r\n[spack-build-out.txt](https://github.com/spack/spack/files/7596255/spack-build-out.txt)\r\n- `r-v8`: the error might be related to spack: \r\n[spack-build-out.txt](https://github.com/spack/spack/files/7596260/spack-build-out.txt)\r\n- `r-prettydoc`: it complains about requiring `rmarkdown` as a dependency, but it is already installed when I check with `$ spack find`: \r\n[spack-build-out.txt](https://github.com/spack/spack/files/7596269/spack-build-out.txt)\r\n- `r-hdf5r`: it complains about the `hdf5` installed, but it is indeed correct (hdf5@1.10.7): \r\n[spack-build-out.txt](https://github.com/spack/spack/files/7596283/spack-build-out.txt)\r\n- `r-affy`: \r\n[spack-build-out.txt](https://github.com/spack/spack/files/7596300/spack-build-out.txt)\r\n- `r-rpostgresql`: it seems it's a dependency issue:\r\n```sh\r\n==> [2021-11-24-15:14:26.793002] r-rpostgresql: Executing phase: 'install'\r\n==> [2021-11-24-15:14:26.835899] Error: AttributeError: 'RRpostgresql' object has no attribute '_require_build_deps'\r\n\r\n/usr/local/spack/lib/spack/spack/build_systems/autotools.py:169, in _do_patch_config_files:\r\n        166        if not to_be_patched:\r\n        167            return\r\n        168\r\n  >>    169        # Otherwise, require `gnuconfig` to be a build dependency\r\n        170        self._require_build_deps(\r\n        171            pkgs=['gnuconfig'],\r\n        172            spec=self.spec,\r\n\r\nSee build log for details:\r\n  /tmp/jacorvar/spack-stage/spack-stage-r-rpostgresql-0.6-2-esyrp4zl6wyqt4xecqtofismpkzat37n/spack-build-out.txt\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/local/spack/lib/spack/spack/build_environment.py\", line 1035, in _setup_pkg_and_run\r\n    return_value = function(pkg, kwargs)\r\n  File \"/usr/local/spack/lib/spack/spack/installer.py\", line 1952, in build_process\r\n    return installer.run()\r\n  File \"/usr/local/spack/lib/spack/spack/installer.py\", line 1809, in run\r\n    self._real_install()\r\n  File \"/usr/local/spack/lib/spack/spack/installer.py\", line 1916, in _real_install\r\n    phase(pkg.spec, pkg.prefix)\r\n  File \"/usr/local/spack/lib/spack/spack/package.py\", line 134, in phase_wrapper\r\n    callback(instance)\r\n  File \"/usr/local/spack/var/spack/repos/builtin/packages/r-rpostgresql/package.py\", line 38, in patch_config_guess\r\n  File \"/usr/local/spack/lib/spack/spack/build_systems/autotools.py\", line 170, in _do_patch_config_files\r\n    self._require_build_deps(\r\nAttributeError: 'RRpostgresql' object has no attribute '_require_build_deps'\r\n```\n\n### Information on your system\n\n* **Spack:** 0.17.0-252-5eba5dc271\r\n* **Python:** 3.8.10\r\n* **Platform:** linux-ubuntu20.04-skylake\r\n* **Concretizer:** clingo\r\n\n\n### Additional information\n\n_No response_\n\n### General information\n\n- [X] I have run `spack debug report` and reported the version of Spack/Python/Platform\n- [X] I have run `spack maintainers <name-of-the-package>` and **@mentioned** any maintainers\n- [X] I have uploaded the build log and environment files\n- [X] I have searched the issues of this repo and believe this is not a duplicate",
    "user": "jacorvar",
    "url": "https://api.github.com/repos/spack/spack/issues/27634",
    "updated_at": "2021-12-22 02:25:59",
    "created_at": "2021-11-24 14:20:49",
    "closed_at": "None",
    "state": "open",
    "title": "Installation issue: r-v8, r-affy, r-hdf5r, r-tictoc, r-prettydoc, r-rpostgresql",
    "number": 27634,
    "milestone": null,
    "labels": [
        "build-error"
    ],
    "id": 1062486224,
    "html_url": "https://github.com/spack/spack/issues/27634",
    "assignees": [],
    "comments": 16
}