{
    "body": "### Steps to reproduce the issue\n\n`tasmanian@7.7 +rocm amdgpu_target=gfx908` fails to build using:\r\n* `spack@develop` (f81d84dfc6b1c3a821dffab785e62ecd79f130ab from `Tue Dec 7 12:30:14 2021 +0100`\r\n* Ubuntu 20.04, x86_64\r\n* GCC 9.3.0\r\n* ROCm 4.3.1, defined externally, installed via apt\r\n\r\nConcrete spec: [tasmanian.spec.json.txt](https://github.com/spack/spack/files/7688322/tasmanian.spec.json.txt)\r\n\r\nConcretization:\r\n```\r\ntasmanian@7.7%gcc@9.3.0~blas~cuda~fortran~ipo~magma+mpi+openmp~python+rocm~xsdkflags amdgpu_target=gfx908 build_type=Release arch=linux-ubuntu20.04-x86_64\r\n    ^cmake@3.21.4%gcc@9.3.0~doc+ncurses+openssl+ownlibs~qt build_type=Release arch=linux-ubuntu20.04-x86_64\r\n        ^ncurses@6.2%gcc@9.3.0~symlinks+termlib abi=none arch=linux-ubuntu20.04-x86_64\r\n            ^pkgconf@1.8.0%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n        ^openssl@1.1.1l%gcc@9.3.0~docs certs=system arch=linux-ubuntu20.04-x86_64\r\n            ^perl@5.34.0%gcc@9.3.0+cpanm+shared+threads arch=linux-ubuntu20.04-x86_64\r\n                ^berkeley-db@18.1.40%gcc@9.3.0+cxx~docs+stl patches=b231fcc4d5cff05e5c3a4814f6a5af0e9a966428dc2176540d2c05aff41de522 arch=linux-ubuntu20.04-x86_64\r\n                ^bzip2@1.0.8%gcc@9.3.0~debug~pic+shared arch=linux-ubuntu20.04-x86_64\r\n                    ^diffutils@3.8%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n                        ^libiconv@1.16%gcc@9.3.0 libs=shared,static arch=linux-ubuntu20.04-x86_64\r\n                ^gdbm@1.19%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n                    ^readline@8.1%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n                ^zlib@1.2.11%gcc@9.3.0+optimize+pic+shared arch=linux-ubuntu20.04-x86_64\r\n    ^hip@4.3.1%gcc@9.3.0~ipo build_type=Release patches=2a4190477b7d9206b9cd8d70770ba0bc007273cbe54772efb12f9ca2e37c0392,99190b4616edb362d48f9b265c3018a3c6339481b0729d9fe46185fca25bc54b,e276c4acf3d37712b6bea306fea34f539d3c4f743471e9da208b5eb17b16ae67 arch=linux-ubuntu20.04-x86_64\r\n    ^hsa-rocr-dev@4.3.1%gcc@9.3.0+image~ipo+shared build_type=Release patches=71e6851d9be8113bfb8d71b66a3171e0d0401bae5e6f161c9e7fe32558261a46 arch=linux-ubuntu20.04-x86_64\r\n    ^llvm-amdgpu@4.3.1%gcc@9.3.0~ipo+openmp+rocm-device-libs build_type=Release patches=d999f3b235e655ee07f6dd2590302082feaa06d32c5c6b53aae9c5cf1e45b644 arch=linux-ubuntu20.04-x86_64\r\n    ^mpich@3.4.2%gcc@9.3.0~argobots+fortran+hwloc+hydra+libxml2+pci+romio~slurm~two_level_namespace~verbs~wrapperrpath device=ch4 netmod=ofi pmi=pmi arch=linux-ubuntu20.04-x86_64\r\n        ^findutils@4.8.0%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n        ^hwloc@2.6.0%gcc@9.3.0~cairo~cuda~gl~libudev+libxml2~netloc~nvml~opencl+pci~rocm+shared arch=linux-ubuntu20.04-x86_64\r\n            ^libpciaccess@0.16%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n                ^libtool@2.4.6%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n                    ^m4@1.4.19%gcc@9.3.0+sigsegv patches=9dc5fbd0d5cb1037ab1e6d0ecc74a30df218d0a94bdd5a02759a97f62daca573,bfdffa7c2eb01021d5849b36972c069693654ad826c1a20b53534009a4ec7a89 arch=linux-ubuntu20.04-x86_64\r\n                        ^libsigsegv@2.13%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n                ^util-macros@1.19.3%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n            ^libxml2@2.9.12%gcc@9.3.0~python arch=linux-ubuntu20.04-x86_64\r\n                ^xz@5.2.5%gcc@9.3.0+pic libs=shared,static arch=linux-ubuntu20.04-x86_64\r\n        ^libfabric@1.14.0%gcc@9.3.0~debug~kdreg fabrics=rxm,sockets,tcp,udp arch=linux-ubuntu20.04-x86_64\r\n    ^rocblas@4.3.1%gcc@9.3.0~ipo build_type=Release tensile_architecture=all arch=linux-ubuntu20.04-x86_64\r\n    ^rocsolver@4.3.1%gcc@9.3.0~ipo+optimal amdgpu_target=gfx906:xnack- build_type=Release patches=bed776208b4903367a4fd4d59c45738306b8177f871cccc7e10ff3fa398f5c67 arch=linux-ubuntu20.04-x86_64\r\n    ^rocsparse@4.3.1%gcc@9.3.0~ipo build_type=Release arch=linux-ubuntu20.04-x86_64\r\n```\r\n\r\n```\r\n$> spack install -f ./tasmanian.spec.json\r\n...\r\n==> Installing tasmanian-7.7-mregqtemxzq2ujmtqho4ynldxv3tutkt\r\n==> No binary for tasmanian-7.7-mregqtemxzq2ujmtqho4ynldxv3tutkt found: installing from source\r\n==> Using cached archive: /spack/var/spack/cache/_source-cache/archive/85/85fb3a7b302ea21a3b700712767a59a623d9ab93da03308fa47d4413654c3878.tar.gz\r\n==> No patches needed for tasmanian\r\n==> tasmanian: Executing phase: 'cmake'\r\n==> tasmanian: Executing phase: 'build'\r\n==> Error: ProcessError: Command exited with status 2:\r\n    'make' '-j16'\r\n...\r\n     100    [ 26%] Building CXX object SparseGrids/CMakeFiles/Tasmanian_libsparsegrid.dir/tsgSequenceOptimizer.cpp.o\r\n     101    cd /tmp/root/spack-stage/spack-stage-tasmanian-7.7-mregqtemxzq2ujmtqho4ynldxv3tutkt/spack-build-mregqte/SparseGrids && /opt/rocm-4.3.1/hip/bin/hipcc -DTasmanian_li\r\n            bsparsegrid_EXPORTS -D__HIP_PLATFORM_AMD__=1 -D__HIP_PLATFORM_HCC__=1 -I/tmp/root/spack-stage/spack-stage-tasmanian-7.7-mregqtemxzq2ujmtqho4ynldxv3tutkt/spack-src/\r\n            SparseGrids -I/tmp/root/spack-stage/spack-stage-tasmanian-7.7-mregqtemxzq2ujmtqho4ynldxv3tutkt/spack-src/SparseGrids/../Addons -I/tmp/root/spack-stage/spack-stage-\r\n            tasmanian-7.7-mregqtemxzq2ujmtqho4ynldxv3tutkt/spack-src/SparseGrids/../DREAM -I/tmp/root/spack-stage/spack-stage-tasmanian-7.7-mregqtemxzq2ujmtqho4ynldxv3tutkt/sp\r\n            ack-src/Config -I/tmp/root/spack-stage/spack-stage-tasmanian-7.7-mregqtemxzq2ujmtqho4ynldxv3tutkt/spack-src/InterfaceTPL -I/tmp/root/spack-stage/spack-stage-tasman\r\n            ian-7.7-mregqtemxzq2ujmtqho4ynldxv3tutkt/spack-build-mregqte/configured -isystem /opt/rocm-4.3.1/hip/include -isystem /spack/opt/spack/linux-ubuntu20.04-x86_64/gcc\r\n            -9.3.0/mpich-3.4.2-da2intlyhnltoebtrcvfl7qeffmwwzp6/include -O3 -DNDEBUG -fPIC -fopenmp=libiomp5 -MD -MT SparseGrids/CMakeFiles/Tasmanian_libsparsegrid.dir/tsgSequ\r\n            enceOptimizer.cpp.o -MF CMakeFiles/Tasmanian_libsparsegrid.dir/tsgSequenceOptimizer.cpp.o.d -o CMakeFiles/Tasmanian_libsparsegrid.dir/tsgSequenceOptimizer.cpp.o -c\r\n             /tmp/root/spack-stage/spack-stage-tasmanian-7.7-mregqtemxzq2ujmtqho4ynldxv3tutkt/spack-src/SparseGrids/tsgSequenceOptimizer.cpp\r\n  >> 102    /tmp/root/spack-stage/spack-stage-tasmanian-7.7-mregqtemxzq2ujmtqho4ynldxv3tutkt/spack-src/SparseGrids/tsgLinearSolvers.cpp:281:30: error: no member named 'numeric\r\n            _limits' in namespace 'std'\r\n     103        double eps = norm * std::numeric_limits<double>::epsilon();\r\n     104                            ~~~~~^\r\n  >> 105    /tmp/root/spack-stage/spack-stage-tasmanian-7.7-mregqtemxzq2ujmtqho4ynldxv3tutkt/spack-src/SparseGrids/tsgLinearSolvers.cpp:281:51: error: expected '(' for functio\r\n            n-style cast or type construction\r\n     106        double eps = norm * std::numeric_limits<double>::epsilon();\r\n     107                                                ~~~~~~^\r\n  >> 108    /tmp/root/spack-stage/spack-stage-tasmanian-7.7-mregqtemxzq2ujmtqho4ynldxv3tutkt/spack-src/SparseGrids/tsgLinearSolvers.cpp:281:54: error: no member named 'epsilon\r\n            ' in the global namespace\r\n     109        double eps = norm * std::numeric_limits<double>::epsilon();\r\n     110                                                       ~~^\r\n     111    3 errors generated when compiling for host.\r\n  >> 112    make[2]: *** [SparseGrids/CMakeFiles/Tasmanian_libsparsegrid.dir/build.make:275: SparseGrids/CMakeFiles/Tasmanian_libsparsegrid.dir/tsgLinearSolvers.cpp.o] Error 1\r\n     113    make[2]: *** Waiting for unfinished jobs....\r\n     114    make[2]: Leaving directory '/tmp/root/spack-stage/spack-stage-tasmanian-7.7-mregqtemxzq2ujmtqho4ynldxv3tutkt/spack-build-mregqte'\r\n  >> 115    make[1]: *** [CMakeFiles/Makefile2:331: SparseGrids/CMakeFiles/Tasmanian_libsparsegrid.dir/all] Error 2\r\n     116    make[1]: Leaving directory '/tmp/root/spack-stage/spack-stage-tasmanian-7.7-mregqtemxzq2ujmtqho4ynldxv3tutkt/spack-build-mregqte'\r\n  >> 117    make: *** [Makefile:149: all] Error 2\r\n...\r\n```\n\n### Information on your system\n\n* **Spack:** 0.17.0-472-6be1c9b9d3\r\n* **Python:** 3.8.10\r\n* **Platform:** linux-ubuntu20.04-broadwell\r\n* **Concretizer:** clingo\n\n### Additional information\n\n[spack-build-out.txt](https://github.com/spack/spack/files/7688332/spack-build-out.txt)\r\n[spack-build-env.txt](https://github.com/spack/spack/files/7688331/spack-build-env.txt)\r\n[spack-build-01-cmake-out.txt](https://github.com/spack/spack/files/7688341/spack-build-01-cmake-out.txt)\r\n\r\n@mkstoyanov\n\n### General information\n\n- [X] I have run `spack debug report` and reported the version of Spack/Python/Platform\n- [X] I have run `spack maintainers <name-of-the-package>` and **@mentioned** any maintainers\n- [X] I have uploaded the build log and environment files\n- [X] I have searched the issues of this repo and believe this is not a duplicate",
    "user": "eugeneswalker",
    "url": "https://api.github.com/repos/spack/spack/issues/27896",
    "updated_at": "2021-12-10 21:27:38",
    "created_at": "2021-12-09 20:48:47",
    "closed_at": "None",
    "state": "open",
    "title": "tasmanian +rocm build fails: tsgLinearSolvers.cpp:281:30: no member named 'numeric_limits' in namespace 'std'",
    "number": 27896,
    "milestone": null,
    "labels": [
        "build-error",
        "e4s",
        "ROCm/hip"
    ],
    "id": 1076000939,
    "html_url": "https://github.com/spack/spack/issues/27896",
    "assignees": [
        "mkstoyanov"
    ],
    "comments": 1
}