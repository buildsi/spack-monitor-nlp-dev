{
    "body": "### Steps to reproduce the issue\n\nSuccessful:\r\n````console\r\nspack -d -v install --fake flex\r\n````\r\nFailing:\r\n````console\r\nspack -d -v install flex\r\n````\r\n\r\nErrors apparently:\r\n````console\r\nmake[2]: *** [Makefile:1833: stage1scan.c] Broken pipe\r\n````\r\n\r\n````console\r\nFile \"/opt/ohpc/admin/spack/0.15.0/lib/spack/spack/build_environment.py\", \\\r\nline 838, in child_process\r\n````\r\nErrors in their context:\r\n\r\n````console\r\n$  spack -d -v install flex\r\n\r\n( ... )\r\n\r\n/bin/sh ../libtool  --tag=CC   --mode=link /opt/ohpc/admin/spack/0.15.0/lib/spack/env/gcc/gcc  -g -O2 -version-info 2:0:0  -o libfl.la -rpath /opt/ohpc/admin/spack/0.15.0/opt/spack/linux-centos8-haswell/gcc-9.3.0/flex-2.6.4-54bme7efufngw5ierxtznhndwpmm37hh/lib libmain.lo libyywrap.lo  -lm \r\n./stage1flex   -o stage1scan.c ./scan.l\r\nmake[2]: *** [Makefile:1833: stage1scan.c] Broken pipe\r\nmake[2]: *** Deleting file 'stage1scan.c'\r\nmake[2]: *** Waiting for unfinished jobs....\r\nlibtool: link: /opt/ohpc/admin/spack/0.15.0/lib/spack/env/gcc/gcc -shared  -fPIC -DPIC  .libs/libmain.o .libs/libyywrap.o   -lm  -g -O2   -Wl,-soname -Wl,libfl.so.2 -o .libs/libfl.so.2.0.0\r\nlibtool: link: (cd \".libs\" && rm -f \"libfl.so.2\" && ln -s \"libfl.so.2.0.0\" \"libfl.so.2\")\r\nlibtool: link: (cd \".libs\" && rm -f \"libfl.so\" && ln -s \"libfl.so.2.0.0\" \"libfl.so\")\r\nlibtool: link: ar cru .libs/libfl.a  libmain.o libyywrap.o\r\nlibtool: link: ranlib .libs/libfl.a\r\nlibtool: link: ( cd \".libs\" && rm -f \"libfl.la\" && ln -s \"../libfl.la\" \"libfl.la\" )\r\nmake[2]: Leaving directory '/tmp/root/spack-stage/spack-stage-flex-2.6.4-54bme7efufngw5ierxtznhndwpmm37hh/spack-src/src'\r\nmake[1]: *** [Makefile:575: all] Error 2\r\nmake[1]: Leaving directory '/tmp/root/spack-stage/spack-stage-flex-2.6.4-54bme7efufngw5ierxtznhndwpmm37hh/spack-src/src'\r\nmake: *** [Makefile:533: all-recursive] Error 1\r\n==&gt; [2021-08-05-18:35:03.601781, 1883439] WRITE LOCK (spack-stage-flex-2.6.4-54bme7efufngw5ierxtznhndwpmm37hh): /tmp/root/spack-stage/.lock[8699948262418216499:1] [Releasing] (reads 0, writes 1)\r\n==&gt; [2021-08-05-18:35:03.602065, 1883439] WRITE LOCK (spack-stage-flex-2.6.4-54bme7efufngw5ierxtznhndwpmm37hh): /tmp/root/spack-stage/.lock[8699948262418216499:1] [Released at 18:35:03.602033] (reads 0, writes 0)\r\n==&gt; [2021-08-05-18:35:03.610548, 1883434] Error: ProcessError: Command exited with status 2:\r\n    'make' '-j2'\r\n\r\nSee build log for details:\r\n  /tmp/root/spack-stage/spack-stage-flex-2.6.4-54bme7efufngw5ierxtznhndwpmm37hh/spack-build-out.txt\r\n\r\nTraceback (most recent call last):\r\n  File \"/opt/ohpc/admin/spack/0.15.0/lib/spack/spack/build_environment.py\", line 838, in child_process\r\n    return_value = function()\r\n  File \"/opt/ohpc/admin/spack/0.15.0/lib/spack/spack/installer.py\", line 1140, in build_process\r\n    phase(pkg.spec, pkg.prefix)\r\n  File \"/opt/ohpc/admin/spack/0.15.0/lib/spack/spack/package.py\", line 108, in phase_wrapper\r\n    phase(spec, prefix)\r\n  File \"/opt/ohpc/admin/spack/0.15.0/lib/spack/spack/build_systems/autotools.py\", line 331, in build\r\n    inspect.getmodule(self).make(*self.build_targets)\r\n  File \"/opt/ohpc/admin/spack/0.15.0/lib/spack/spack/build_environment.py\", line 133, in __call__\r\n    return super(MakeExecutable, self).__call__(*args, **kwargs)\r\n  File \"/opt/ohpc/admin/spack/0.15.0/lib/spack/spack/util/executable.py\", line 189, in __call__\r\n    proc.returncode, long_msg)\r\nspack.util.executable.ProcessError: Command exited with status 2:\r\n    'make' '-j2'\r\n==&gt; [2021-08-05-18:35:03.932598, 1883434] Error: Failed to install flex due to ChildError: ProcessError: Command exited with status 2:\r\n    'make' '-j2'\r\n\r\n( ... )\r\n\r\n==> [2021-08-05-18:34:58.849152, 1883439] 1883434: flex: Executing phase: 'build'\r\n==> [2021-08-05-18:34:58.849857, 1883439] 'make' '-j2'\r\nMaking all in src\r\nmake[1]: Entering directory '/tmp/root/spack-stage/spack-stage-flex-2.6.4-54bme7efufngw5ierxtznhndwpmm37hh/spack-src/src'\r\nmake  all-am\r\n\r\n( ... )\r\n\r\n/bin/sh ../libtool  --tag=CC   --mode=link /opt/ohpc/admin/spack/0.15.0/lib/spack/env/gcc/gcc  -g -O2 -version-info 2:0:0  -o libfl.la -rpath /opt/ohpc/admin/spack/0.15.0/opt/spack/linux-centos8-haswell/gcc-9.3.0/flex-2.6.4-54bme7efufngw5ierxtznhndwpmm37hh/lib libmain.lo libyywrap.lo  -lm \r\n./stage1flex   -o stage1scan.c ./scan.l\r\nmake[2]: *** [Makefile:1833: stage1scan.c] Broken pipe\r\nmake[2]: *** Deleting file 'stage1scan.c'\r\nmake[2]: *** Waiting for unfinished jobs....\r\nlibtool: link: /opt/ohpc/admin/spack/0.15.0/lib/spack/env/gcc/gcc -shared  -fPIC -DPIC  .libs/libmain.o .libs/libyywrap.o   -lm  -g -O2   -Wl,-soname -Wl,libfl.so.2 -o .libs/libfl.so.2.0.0\r\nlibtool: link: (cd \".libs\" && rm -f \"libfl.so.2\" && ln -s \"libfl.so.2.0.0\" \"libfl.so.2\")\r\nlibtool: link: (cd \".libs\" && rm -f \"libfl.so\" && ln -s \"libfl.so.2.0.0\" \"libfl.so\")\r\nlibtool: link: ar cru .libs/libfl.a  libmain.o libyywrap.o\r\nlibtool: link: ranlib .libs/libfl.a\r\nlibtool: link: ( cd \".libs\" && rm -f \"libfl.la\" && ln -s \"../libfl.la\" \"libfl.la\" )\r\nmake[2]: Leaving directory '/tmp/root/spack-stage/spack-stage-flex-2.6.4-54bme7efufngw5ierxtznhndwpmm37hh/spack-src/src'\r\nmake[1]: *** [Makefile:575: all] Error 2\r\nmake[1]: Leaving directory '/tmp/root/spack-stage/spack-stage-flex-2.6.4-54bme7efufngw5ierxtznhndwpmm37hh/spack-src/src'\r\nmake: *** [Makefile:533: all-recursive] Error 1\r\n````\r\nErrors according to build log:\r\n````console\r\n/tmp/root/spack-stage/spack-stage-flex-2.6.4-54bme7efufngw5ierxtznhndwpmm37hh/spack-build-out.txt\r\n\r\n(...)\r\n==> [2021-08-05-18:34:58.849152, 1883439] 1883434: flex: Executing phase: 'build'\r\n==> [2021-08-05-18:34:58.849857, 1883439] 'make' '-j2'\r\nMaking all in src\r\nmake[1]: Entering directory '/tmp/root/spack-stage/spack-stage-flex-2.6.4-54bme7efufngw5ierxtznhndwpmm37hh/spack-src/src'\r\nmake  all-am\r\n\r\n(...)\r\n\r\nlibtool: link: /opt/ohpc/admin/spack/0.15.0/lib/spack/env/gcc/gcc -g -O2 -o stage1flex stage1flex-scan.o stage1flex-buf.o stage1flex-ccl.o stage1flex-dfa.o stage1flex-ecs.o stage1flex-filter.o stage1flex-gen.o stage1flex-main.o stage1flex-misc.o stage1flex-nfa.o stage1flex-options.o stage1flex-parse.o stage1flex-regex.o stage1flex-scanflags.o stage1flex-scanopt.o stage1flex-skel.o stage1flex-sym.o stage1flex-tables.o stage1flex-tables_shared.o stage1flex-tblcmp.o stage1flex-yylex.o  -lm\r\n/bin/sh ../libtool  --tag=CC   --mode=link /opt/ohpc/admin/spack/0.15.0/lib/spack/env/gcc/gcc  -g -O2 -version-info 2:0:0  -o libfl.la -rpath /opt/ohpc/admin/spack/0.15.0/opt/spack/linux-centos8-haswell/gcc-9.3.0/flex-2.6.4-54bme7efufngw5ierxtznhndwpmm37hh/lib libmain.lo libyywrap.lo  -lm \r\n./stage1flex   -o stage1scan.c ./scan.l\r\nmake[2]: *** [Makefile:1833: stage1scan.c] Broken pipe\r\nmake[2]: *** Deleting file 'stage1scan.c'\r\nmake[2]: *** Waiting for unfinished jobs....\r\nlibtool: link: /opt/ohpc/admin/spack/0.15.0/lib/spack/env/gcc/gcc -shared  -fPIC -DPIC  .libs/libmain.o .libs/libyywrap.o   -lm  -g -O2   -Wl,-soname -Wl,libfl.so.2 -o .libs/libfl.so.2.0.0\r\nlibtool: link: (cd \".libs\" && rm -f \"libfl.so.2\" && ln -s \"libfl.so.2.0.0\" \"libfl.so.2\")\r\nlibtool: link: (cd \".libs\" && rm -f \"libfl.so\" && ln -s \"libfl.so.2.0.0\" \"libfl.so\")\r\nlibtool: link: ar cru .libs/libfl.a  libmain.o libyywrap.o\r\nlibtool: link: ranlib .libs/libfl.a\r\nlibtool: link: ( cd \".libs\" && rm -f \"libfl.la\" && ln -s \"../libfl.la\" \"libfl.la\" )\r\nmake[2]: Leaving directory '/tmp/root/spack-stage/spack-stage-flex-2.6.4-54bme7efufngw5ierxtznhndwpmm37hh/spack-src/src'\r\nmake[1]: *** [Makefile:575: all] Error 2\r\nmake[1]: Leaving directory '/tmp/root/spack-stage/spack-stage-flex-2.6.4-54bme7efufngw5ierxtznhndwpmm37hh/spack-src/src'\r\nmake: *** [Makefile:533: all-recursive] Error 1\r\n\r\n````\n\n### Information on your system\n\n* **Spack:** 0.15.0\r\n* **Python:** 3.6.8\r\n* **Platform:** linux-centos8-haswell\r\n* Spack implemented via OHPC 2.2\r\n* OS: CentOS8.4\n\n### Additional information\n\n\r\n[config.log.txt](https://github.com/spack/spack/files/6940677/config.log.txt)\r\n[spack-build-env.txt](https://github.com/spack/spack/files/6940678/spack-build-env.txt)\r\n[spack-build-out.txt](https://github.com/spack/spack/files/6940680/spack-build-out.txt)\r\n\"spack maintainers flex\" without result\r\n\n\n### General information\n\n- [X] I have run `spack debug report` and reported the version of Spack/Python/Platform\n- [X] I have run `spack maintainers <name-of-the-package>` and **@mentioned** any maintainers\n- [X] I have uploaded the build log and environment files\n- [X] I have searched the issues of this repo and believe this is not a duplicate",
    "user": "kelbstf",
    "url": "https://api.github.com/repos/spack/spack/issues/25279",
    "updated_at": "2021-08-06 11:06:23",
    "created_at": "2021-08-05 17:56:29",
    "closed_at": "None",
    "state": "open",
    "title": "Installation issue: flex-2.6.4",
    "number": 25279,
    "milestone": null,
    "labels": [
        "build-error"
    ],
    "id": 962066661,
    "html_url": "https://github.com/spack/spack/issues/25279",
    "assignees": [
        "scheibelp"
    ],
    "comments": 5
}