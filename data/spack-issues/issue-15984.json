{
    "body": "I'm trying to put together a package for fastinterval, https://github.com/jamescasbon/fastinterval, and it builds and installs, but when I try to activate it there's a collision because the activation has recursively linked `.../bin/pyfasta` from the `py-pyfasta` dependency into the `python` tree **BUT** I've somehow ended up with a copy of it in the installed `py-fastinterval` tree too.\r\n\r\nI suspect there's some subtly about fastinterval's setup.py or ... that a more pythonic person would get that's going right over my head, so I figured I'd ask for HELP.\r\n\r\nHere's what I have for the package so far (work in progress): \r\n\r\n```python\r\n# Copyright 2013-2020 Lawrence Livermore National Security, LLC and other\r\n# Spack Project Developers. See the top-level COPYRIGHT file for details.\r\n#\r\n# SPDX-License-Identifier: (Apache-2.0 OR MIT)\r\n\r\nfrom spack import *\r\n\r\n\r\nclass PyFastinterval(PythonPackage):\r\n    \"\"\"A simple interval class for DNA sequences from FASTA files that\r\n    provides fast access to sequences and methods for interval logic on\r\n    those sequences.\"\"\"\r\n\r\n    homepage = \"https://github.com/jamescasbon/fastinterval\"\r\n    url      = \"https://pypi.io/packages/source/f/fastinterval/fastinterval-0.1.1.tar.gz\"\r\n\r\n    # maintainers = ['github_user1', 'github_user2']\r\n\r\n    version('0.1.1', sha256='88a5b5800f382696c19474877cf8e988c461fd7b201fcf351f2b1ad56fb8e5cf')\r\n\r\n    depends_on('python@:2', type=('build', 'run'))\r\n    depends_on('py-numpy@:1.16.6', type=('build', 'run'))\r\n    depends_on('py-pyfasta', type=('build', 'run'))\r\n    depends_on('py-bx-python', type=('build', 'run'))\r\n```\r\n\r\nand here's the bottom half of its `install -v` output.  Notice where it's installing bits of its dependencies `bin/*` scripts into its bin....\r\n\r\n```\r\n==> 15407: py-fastinterval: Executing phase: 'install'\r\n==> [2020-04-10-00:55:52.417041, 15504] '/tmp/hartzell/spack-2/opt/spack/linux-centos7-haswell/gcc-4.8.5/python-2.7.16-h4dp2chlvz7jg6adkdalzh3ptwtr3xm7/bin/python2.7' '-s' 'setup.py'\r\n'--no-user-cfg' 'install' '--prefix=/tmp/hartzell/spack-2/opt/spack/linux-centos7-haswell/gcc-4.8.5/py-fastinterval-0.1.1-hmc2iu4m5z3ovzlqdftel74j7vmtut73'\r\nrunning install\r\nrunning bdist_egg\r\nrunning egg_info\r\nwriting requirements to fastinterval.egg-info/requires.txt\r\nwriting fastinterval.egg-info/PKG-INFO\r\nwriting top-level names to fastinterval.egg-info/top_level.txt\r\nwriting dependency_links to fastinterval.egg-info/dependency_links.txt\r\nreading manifest file 'fastinterval.egg-info/SOURCES.txt'\r\nwriting manifest file 'fastinterval.egg-info/SOURCES.txt'\r\ninstalling library code to build/bdist.linux-x86_64/egg\r\nrunning install_lib\r\nrunning build_py\r\ncreating build/bdist.linux-x86_64\r\ncreating build/bdist.linux-x86_64/egg\r\ncopying build/lib/fastinterval.py -> build/bdist.linux-x86_64/egg\r\nbyte-compiling build/bdist.linux-x86_64/egg/fastinterval.py to fastinterval.pyc\r\ncreating build/bdist.linux-x86_64/egg/EGG-INFO\r\ncopying fastinterval.egg-info/PKG-INFO -> build/bdist.linux-x86_64/egg/EGG-INFO\r\ncopying fastinterval.egg-info/SOURCES.txt -> build/bdist.linux-x86_64/egg/EGG-INFO\r\ncopying fastinterval.egg-info/dependency_links.txt -> build/bdist.linux-x86_64/egg/EGG-INFO\r\ncopying fastinterval.egg-info/requires.txt -> build/bdist.linux-x86_64/egg/EGG-INFO\r\ncopying fastinterval.egg-info/top_level.txt -> build/bdist.linux-x86_64/egg/EGG-INFO\r\nzip_safe flag not set; analyzing archive contents...\r\ncreating dist\r\ncreating 'dist/fastinterval-0.1.1-py2.7.egg' and adding 'build/bdist.linux-x86_64/egg' to it\r\nremoving 'build/bdist.linux-x86_64/egg' (and everything under it)\r\nCreating /tmp/hartzell/spack-2/opt/spack/linux-centos7-haswell/gcc-4.8.5/py-fastinterval-0.1.1-hmc2iu4m5z3ovzlqdftel74j7vmtut73/lib/python2.7/site-packages/site.py\r\nProcessing fastinterval-0.1.1-py2.7.egg\r\nCopying fastinterval-0.1.1-py2.7.egg to /tmp/hartzell/spack-2/opt/spack/linux-centos7-haswell/gcc-4.8.5/py-fastinterval-0.1.1-hmc2iu4m5z3ovzlqdftel74j7vmtut73/lib/python2.7/site-packa\r\nges\r\nAdding fastinterval 0.1.1 to easy-install.pth file\r\n\r\nInstalled /tmp/hartzell/spack-2/opt/spack/linux-centos7-haswell/gcc-4.8.5/py-fastinterval-0.1.1-hmc2iu4m5z3ovzlqdftel74j7vmtut73/lib/python2.7/site-packages/fastinterval-0.1.1-py2.7.e\r\ngg\r\nProcessing dependencies for fastinterval==0.1.1\r\nSearching for bx-python==0.8.8\r\nBest match: bx-python 0.8.8\r\nAdding bx-python 0.8.8 to easy-install.pth file\r\n\r\nUsing /tmp/hartzell/spack-2/opt/spack/linux-centos7-haswell/gcc-4.8.5/python-2.7.16-h4dp2chlvz7jg6adkdalzh3ptwtr3xm7/lib/python2.7/site-packages\r\nSearching for pyfasta==0.5.2\r\nBest match: pyfasta 0.5.2\r\nAdding pyfasta 0.5.2 to easy-install.pth file\r\nInstalling pyfasta script to /tmp/hartzell/spack-2/opt/spack/linux-centos7-haswell/gcc-4.8.5/py-fastinterval-0.1.1-hmc2iu4m5z3ovzlqdftel74j7vmtut73/bin\r\n\r\nUsing /tmp/hartzell/spack-2/opt/spack/linux-centos7-haswell/gcc-4.8.5/py-pyfasta-0.5.2-kvqndxoah2uaq6meg2d5xavyddlegq6w/lib/python2.7/site-packages\r\nSearching for numpy==1.16.6\r\nBest match: numpy 1.16.6\r\nAdding numpy 1.16.6 to easy-install.pth file\r\nInstalling f2py2 script to /tmp/hartzell/spack-2/opt/spack/linux-centos7-haswell/gcc-4.8.5/py-fastinterval-0.1.1-hmc2iu4m5z3ovzlqdftel74j7vmtut73/bin\r\nInstalling f2py script to /tmp/hartzell/spack-2/opt/spack/linux-centos7-haswell/gcc-4.8.5/py-fastinterval-0.1.1-hmc2iu4m5z3ovzlqdftel74j7vmtut73/bin\r\nInstalling f2py2.7 script to /tmp/hartzell/spack-2/opt/spack/linux-centos7-haswell/gcc-4.8.5/py-fastinterval-0.1.1-hmc2iu4m5z3ovzlqdftel74j7vmtut73/bin\r\n\r\nUsing /tmp/hartzell/spack-2/opt/spack/linux-centos7-haswell/gcc-4.8.5/python-2.7.16-h4dp2chlvz7jg6adkdalzh3ptwtr3xm7/lib/python2.7/site-packages\r\nSearching for six==1.12.0\r\nBest match: six 1.12.0\r\nAdding six 1.12.0 to easy-install.pth file\r\n\r\nUsing /tmp/hartzell/spack-2/opt/spack/linux-centos7-haswell/gcc-4.8.5/python-2.7.16-h4dp2chlvz7jg6adkdalzh3ptwtr3xm7/lib/python2.7/site-packages\r\nFinished processing dependencies for fastinterval==0.1.1\r\n==> 15407: py-fastinterval: Successfully installed py-fastinterval\r\n  Fetch: 0.00s.  Build: 1.82s.  Total: 1.83s.\r\n[+] /tmp/hartzell/spack-2/opt/spack/linux-centos7-haswell/gcc-4.8.5/py-fastinterval-0.1.1-hmc2iu4m5z3ovzlqdftel74j7vmtut73\r\n$\r\n```",
    "user": "hartzell",
    "url": "https://api.github.com/repos/spack/spack/issues/15984",
    "updated_at": "2020-04-30 23:18:59",
    "created_at": "2020-04-10 01:10:42",
    "closed_at": "2020-04-30 23:18:59",
    "state": "closed",
    "title": "Help authoring python extension; problem with activation",
    "number": 15984,
    "milestone": null,
    "labels": [
        "build-error",
        "python",
        "extensions"
    ],
    "id": 597638212,
    "html_url": "https://github.com/spack/spack/issues/15984",
    "assignees": [],
    "comments": 5
}