{
    "body": "### Steps to reproduce the issue\r\n\r\n`petsc@3.16.1 +rocm amdgpu_target=gfx908` fails to build using:\r\n* `spack@develop` (58109d3e8cd6b5106f07ab5af00512872eb24cfc from `Thu Dec 9 08:43:05 2021 -0800`)\r\n* Ubuntu 20.04, x86_64\r\n* GCC 9.3.0\r\n* ROCm 4.3.1, defined externally, installed via apt\r\n\r\nConcrete spec: [petsc.spec.json.txt](https://github.com/spack/spack/files/7688027/petsc.spec.json.txt)\r\n\r\nConcretization:\r\n```\r\npetsc@3.16.1%gcc@9.3.0~X~batch~cgns~complex~cuda~debug+double~exodusii~fftw~giflib+hdf5~hpddm~hwloc+hypre~int64~jpeg~knl~kokkos~libpng~libyaml~memkind+metis~mkl-pardiso~mmg~moab~mpfr+mpi~mumps~openmp~p4est~parmmg~ptscotch~random123+rocm~saws~scalapack+shared~strumpack~suite-sparse+superlu-dist~tetgen~trilinos~valgrind amdgpu_target=gfx908 clanguage=C arch=linux-ubuntu20.04-x86_64\r\n    ^diffutils@3.8%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n        ^libiconv@1.16%gcc@9.3.0 libs=shared,static arch=linux-ubuntu20.04-x86_64\r\n    ^hdf5@1.10.7%gcc@9.3.0~cxx+fortran+hl~ipo~java+mpi+shared~szip~threadsafe+tools api=v18 build_type=RelWithDebInfo arch=linux-ubuntu20.04-x86_64\r\n        ^cmake@3.21.4%gcc@9.3.0~doc+ncurses+openssl+ownlibs~qt build_type=Release arch=linux-ubuntu20.04-x86_64\r\n            ^ncurses@6.2%gcc@9.3.0~symlinks+termlib abi=none arch=linux-ubuntu20.04-x86_64\r\n                ^pkgconf@1.8.0%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n            ^openssl@1.1.1l%gcc@9.3.0~docs certs=system arch=linux-ubuntu20.04-x86_64\r\n                ^perl@5.34.0%gcc@9.3.0+cpanm+shared+threads arch=linux-ubuntu20.04-x86_64\r\n                    ^berkeley-db@18.1.40%gcc@9.3.0+cxx~docs+stl patches=b231fcc4d5cff05e5c3a4814f6a5af0e9a966428dc2176540d2c05aff41de522 arch=linux-ubuntu20.04-x86_64\r\n                    ^bzip2@1.0.8%gcc@9.3.0~debug~pic+shared arch=linux-ubuntu20.04-x86_64\r\n                    ^gdbm@1.19%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n                        ^readline@8.1%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n                    ^zlib@1.2.11%gcc@9.3.0+optimize+pic+shared arch=linux-ubuntu20.04-x86_64\r\n        ^mpich@3.4.2%gcc@9.3.0~argobots+fortran+hwloc+hydra+libxml2+pci+romio~slurm~two_level_namespace~verbs~wrapperrpath device=ch4 netmod=ofi pmi=pmi arch=linux-ubuntu20.04-x86_64\r\n            ^findutils@4.8.0%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n            ^hwloc@2.6.0%gcc@9.3.0~cairo~cuda~gl~libudev+libxml2~netloc~nvml~opencl+pci~rocm+shared arch=linux-ubuntu20.04-x86_64\r\n                ^libpciaccess@0.16%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n                    ^libtool@2.4.6%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n                        ^m4@1.4.19%gcc@9.3.0+sigsegv patches=9dc5fbd0d5cb1037ab1e6d0ecc74a30df218d0a94bdd5a02759a97f62daca573,bfdffa7c2eb01021d5849b36972c069693654ad826c1a20b53534009a4ec7a89 arch=linux-ubuntu20.04-x86_64\r\n                            ^libsigsegv@2.13%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n                    ^util-macros@1.19.3%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n                ^libxml2@2.9.12%gcc@9.3.0~python arch=linux-ubuntu20.04-x86_64\r\n                    ^xz@5.2.5%gcc@9.3.0+pic libs=shared,static arch=linux-ubuntu20.04-x86_64\r\n            ^libfabric@1.14.0%gcc@9.3.0~debug~kdreg fabrics=rxm,sockets,tcp,udp arch=linux-ubuntu20.04-x86_64\r\n        ^numactl@2.0.14%gcc@9.3.0 patches=4e1d78cbbb85de625bad28705e748856033eaafab92a66dffd383a3d7e00cc94,62fc8a8bf7665a60e8f4c93ebbd535647cebf74198f7afafec4c085a8825c006,ff37630df599cfabf0740518b91ec8daaf18e8f288b19adaae5364dc1f6b2296 arch=linux-ubuntu20.04-x86_64\r\n            ^autoconf@2.69%gcc@9.3.0 patches=35c449281546376449766f92d49fc121ca50e330e60fefcfc9be2af3253082c2,7793209b33013dc0f81208718c68440c5aae80e7a1c4b8d336e382525af791a7,a49dd5bac3b62daa0ff688ab4d508d71dbd2f4f8d7e2a02321926346161bf3ee arch=linux-ubuntu20.04-x86_64\r\n            ^automake@1.16.3%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n    ^hip@4.3.1%gcc@9.3.0~ipo build_type=Release patches=2a4190477b7d9206b9cd8d70770ba0bc007273cbe54772efb12f9ca2e37c0392,99190b4616edb362d48f9b265c3018a3c6339481b0729d9fe46185fca25bc54b,e276c4acf3d37712b6bea306fea34f539d3c4f743471e9da208b5eb17b16ae67 arch=linux-ubuntu20.04-x86_64\r\n    ^hipblas@4.3.1%gcc@9.3.0~ipo build_type=Release patches=15d79d6565f1d6219536237a1c2324019ca5810c91b044da4af2d8da3b4c9747 arch=linux-ubuntu20.04-x86_64\r\n    ^hipsparse@4.3.1%gcc@9.3.0~ipo build_type=Release arch=linux-ubuntu20.04-x86_64\r\n    ^hsa-rocr-dev@4.3.1%gcc@9.3.0+image~ipo+shared build_type=Release patches=71e6851d9be8113bfb8d71b66a3171e0d0401bae5e6f161c9e7fe32558261a46 arch=linux-ubuntu20.04-x86_64\r\n    ^hypre@2.23.0%gcc@9.3.0~complex~cuda~debug+fortran~int64~internal-superlu~mixedint+mpi~openmp+shared~superlu-dist~unified-memory arch=linux-ubuntu20.04-x86_64\r\n        ^openblas@0.3.18%gcc@9.3.0~bignuma~consistent_fpcsr~ilp64+locking+pic+shared symbol_suffix=none threads=openmp arch=linux-ubuntu20.04-x86_64\r\n    ^llvm-amdgpu@4.3.1%gcc@9.3.0~ipo+openmp+rocm-device-libs build_type=Release patches=d999f3b235e655ee07f6dd2590302082feaa06d32c5c6b53aae9c5cf1e45b644 arch=linux-ubuntu20.04-x86_64\r\n    ^metis@5.1.0%gcc@9.3.0~gdb~int64~real64+shared build_type=Release patches=4991da938c1d3a1d3dea78e49bbebecba00273f98df2a656e38b83d55b281da1,b1225da886605ea558db7ac08dd8054742ea5afe5ed61ad4d0fe7a495b1270d2 arch=linux-ubuntu20.04-x86_64\r\n    ^parmetis@4.0.3%gcc@9.3.0~gdb~int64~ipo+shared build_type=RelWithDebInfo patches=4f892531eb0a807eb1b82e683a416d3e35154a455274cf9b162fb02054d11a5b,50ed2081bc939269689789942067c58b3e522c269269a430d5d34c00edbc5870,704b84f7c7444d4372cb59cca6e1209df4ef3b033bc4ee3cf50f369bce972a9d arch=linux-ubuntu20.04-x86_64\r\n    ^python@3.8.12%gcc@9.3.0+bz2+ctypes+dbm~debug+libxml2+lzma~nis~optimizations+pic+pyexpat+pythoncmd+readline+shared+sqlite3+ssl~tix~tkinter~ucs4+uuid+zlib patches=0d98e93189bc278fbc37a50ed7f183bd8aaf249a8e1670a465f0db6bb4f8cf87,4c2457325f2b608b1b6a2c63087df8c26e07db3e3d493caf36a56f0ecf6fb768,f2fd060afc4b4618fe8104c4c5d771f36dc55b1db5a4623785a4ea707ec72fb4 arch=linux-ubuntu20.04-x86_64\r\n        ^expat@2.4.1%gcc@9.3.0+libbsd arch=linux-ubuntu20.04-x86_64\r\n            ^libbsd@0.11.3%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n                ^libmd@1.0.3%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n        ^gettext@0.21%gcc@9.3.0+bzip2+curses+git~libunistring+libxml2+tar+xz arch=linux-ubuntu20.04-x86_64\r\n            ^tar@1.34%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n        ^libffi@3.3%gcc@9.3.0 patches=26f26c6f29a7ce9bf370ad3ab2610f99365b4bdd7b82e7c31df41a3370d685c0 arch=linux-ubuntu20.04-x86_64\r\n        ^sqlite@3.36.0%gcc@9.3.0+column_metadata+fts~functions~rtree arch=linux-ubuntu20.04-x86_64\r\n        ^util-linux-uuid@2.36.2%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n    ^superlu-dist@7.1.1%gcc@9.3.0~cuda~int64~ipo~openmp~rocm+shared build_type=RelWithDebInfo arch=linux-ubuntu20.04-x86_64\r\n```\r\n\r\n```\r\n$> spack install -f ./petsc.spec.json\r\n...\r\n==> Installing petsc-3.16.1-ga2bqpwvkfd77jgqocc3cfp6uznbze7x\r\n==> No binary for petsc-3.16.1-ga2bqpwvkfd77jgqocc3cfp6uznbze7x found: installing from source\r\n==> Fetching https://mirror.spack.io/_source-cache/archive/90/909cf7bce7b6a0ddb2580a1ac9502aa01631ec4105c716594c1804f0ee1ea06a.tar.gz\r\n==> No patches needed for petsc\r\n==> petsc: Executing phase: 'install'\r\n==> Error: ProcessError: Command exited with status 2:\r\n    'make' 'V=1 MAKE_NP=16'\r\n\r\n5 errors found in build log:\r\n...\r\n     961     /tmp/root/spack-stage/spack-stage-petsc-3.16.1-ga2bqpwvkfd77jgqocc3cfp6uznbze7x/spack-src/src/sys/f90-mod/petscsysmod.F90:293:12:\r\n     962\r\n     963       293 |         use iso_c_binding\r\n     964           |            1\r\n  >> 965     Fatal Error: File 'iso_c_binding.mod' opened at (1) is not a GNU Fortran module file\r\n     966     compilation terminated.\r\n  >> 967     make[3]: *** [gmakefile:217: arch-linux-c-opt/obj/sys/f90-mod/petscsysmod.o] Error 1\r\n     968     make[3]: *** Waiting for unfinished jobs....\r\n     969     /spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/mpich-3.4.2-da2intlyhnltoebtrcvfl7qeffmwwzp6/bin/mpicc -c -fPIC    -I/tmp/root/spack-stage/s\r\n             pack-stage-petsc-3.16.1-ga2bqpwvkfd77jgqocc3cfp6uznbze7x/spack-src/include -I/tmp/root/spack-stage/spack-stage-petsc-3.16.1-ga2bqpwvkfd77jgqocc3\r\n             cfp6uznbze7x/spack-src/arch-linux-c-opt/include -I/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/hypre-2.23.0-c3nxdg26jzas4u5ppomt47ei6ngua\r\n             wqw/include -I/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/superlu-dist-7.1.1-bgdrrdvgctco37h2hg4czjmig7sdhvhq/include -I/spack/opt/spack\r\n             /linux-ubuntu20.04-x86_64/gcc-9.3.0/hdf5-1.10.7-kxdjppzwnndofihbdzlbiv5mzyymwdqr/include -I/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/p\r\n             armetis-4.0.3-dz2oktl2xw36xifkcpxljzctewkyo5cv/include -I/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/metis-5.1.0-vds2a7ehbmqig5t4e5albl6\r\n             ivgtl4mvm/include -I/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/zlib-1.2.11-ufqpqnpj5gjkfx5sd2o3twwveuowcz2b/include -I/opt/rocm-4.3.1/h\r\n             ip/include    -MMD -MP /tmp/root/spack-stage/spack-stage-petsc-3.16.1-ga2bqpwvkfd77jgqocc3cfp6uznbze7x/spack-src/src/sys/objects/subcomm.c -o ar\r\n             ch-linux-c-opt/obj/sys/objects/subcomm.o\r\n     970     /spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/mpich-3.4.2-da2intlyhnltoebtrcvfl7qeffmwwzp6/bin/mpicc -c -fPIC    -I/tmp/root/spack-stage/s\r\n             pack-stage-petsc-3.16.1-ga2bqpwvkfd77jgqocc3cfp6uznbze7x/spack-src/include -I/tmp/root/spack-stage/spack-stage-petsc-3.16.1-ga2bqpwvkfd77jgqocc3\r\n             cfp6uznbze7x/spack-src/arch-linux-c-opt/include -I/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/hypre-2.23.0-c3nxdg26jzas4u5ppomt47ei6ngua\r\n             wqw/include -I/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/superlu-dist-7.1.1-bgdrrdvgctco37h2hg4czjmig7sdhvhq/include -I/spack/opt/spack\r\n             /linux-ubuntu20.04-x86_64/gcc-9.3.0/hdf5-1.10.7-kxdjppzwnndofihbdzlbiv5mzyymwdqr/include -I/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/p\r\n             armetis-4.0.3-dz2oktl2xw36xifkcpxljzctewkyo5cv/include -I/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/metis-5.1.0-vds2a7ehbmqig5t4e5albl6\r\n             ivgtl4mvm/include -I/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/zlib-1.2.11-ufqpqnpj5gjkfx5sd2o3twwveuowcz2b/include -I/opt/rocm-4.3.1/h\r\n             ip/include    -MMD -MP /tmp/root/spack-stage/spack-stage-petsc-3.16.1-ga2bqpwvkfd77jgqocc3cfp6uznbze7x/spack-src/src/sys/objects/fcallback.c -o\r\n             arch-linux-c-opt/obj/sys/objects/fcallback.o\r\n     971     /spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/mpich-3.4.2-da2intlyhnltoebtrcvfl7qeffmwwzp6/bin/mpicc -c -fPIC    -I/tmp/root/spack-stage/s\r\n             pack-stage-petsc-3.16.1-ga2bqpwvkfd77jgqocc3cfp6uznbze7x/spack-src/include -I/tmp/root/spack-stage/spack-stage-petsc-3.16.1-ga2bqpwvkfd77jgqocc3\r\n             cfp6uznbze7x/spack-src/arch-linux-c-opt/include -I/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/hypre-2.23.0-c3nxdg26jzas4u5ppomt47ei6ngua\r\n             wqw/include -I/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/superlu-dist-7.1.1-bgdrrdvgctco37h2hg4czjmig7sdhvhq/include -I/spack/opt/spack\r\n             /linux-ubuntu20.04-x86_64/gcc-9.3.0/hdf5-1.10.7-kxdjppzwnndofihbdzlbiv5mzyymwdqr/include -I/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/p\r\n             armetis-4.0.3-dz2oktl2xw36xifkcpxljzctewkyo5cv/include -I/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/metis-5.1.0-vds2a7ehbmqig5t4e5albl6\r\n             ivgtl4mvm/include -I/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/zlib-1.2.11-ufqpqnpj5gjkfx5sd2o3twwveuowcz2b/include -I/opt/rocm-4.3.1/h\r\n             ip/include    -MMD -MP /tmp/root/spack-stage/spack-stage-petsc-3.16.1-ga2bqpwvkfd77jgqocc3cfp6uznbze7x/spack-src/src/sys/objects/tagm.c -o arch-\r\n             linux-c-opt/obj/sys/objects/tagm.o\r\n     972     /spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/mpich-3.4.2-da2intlyhnltoebtrcvfl7qeffmwwzp6/bin/mpicc -c -fPIC    -I/tmp/root/spack-stage/s\r\n             pack-stage-petsc-3.16.1-ga2bqpwvkfd77jgqocc3cfp6uznbze7x/spack-src/include -I/tmp/root/spack-stage/spack-stage-petsc-3.16.1-ga2bqpwvkfd77jgqocc3\r\n             cfp6uznbze7x/spack-src/arch-linux-c-opt/include -I/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/hypre-2.23.0-c3nxdg26jzas4u5ppomt47ei6ngua\r\n             wqw/include -I/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/superlu-dist-7.1.1-bgdrrdvgctco37h2hg4czjmig7sdhvhq/include -I/spack/opt/spack\r\n             /linux-ubuntu20.04-x86_64/gcc-9.3.0/hdf5-1.10.7-kxdjppzwnndofihbdzlbiv5mzyymwdqr/include -I/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/p\r\n             armetis-4.0.3-dz2oktl2xw36xifkcpxljzctewkyo5cv/include -I/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/metis-5.1.0-vds2a7ehbmqig5t4e5albl6\r\n             ivgtl4mvm/include -I/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/zlib-1.2.11-ufqpqnpj5gjkfx5sd2o3twwveuowcz2b/include -I/opt/rocm-4.3.1/h\r\n             ip/include    -MMD -MP /tmp/root/spack-stage/spack-stage-petsc-3.16.1-ga2bqpwvkfd77jgqocc3cfp6uznbze7x/spack-src/src/sys/objects/prefix.c -o arc\r\n             h-linux-c-opt/obj/sys/objects/prefix.o\r\n     973     /spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/mpich-3.4.2-da2intlyhnltoebtrcvfl7qeffmwwzp6/bin/mpicc -c -fPIC    -I/tmp/root/spack-stage/s\r\n             pack-stage-petsc-3.16.1-ga2bqpwvkfd77jgqocc3cfp6uznbze7x/spack-src/include -I/tmp/root/spack-stage/spack-stage-petsc-3.16.1-ga2bqpwvkfd77jgqocc3\r\n             cfp6uznbze7x/spack-src/arch-linux-c-opt/include -I/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/hypre-2.23.0-c3nxdg26jzas4u5ppomt47ei6ngua\r\n             wqw/include -I/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/superlu-dist-7.1.1-bgdrrdvgctco37h2hg4czjmig7sdhvhq/include -I/spack/opt/spack\r\n             /linux-ubuntu20.04-x86_64/gcc-9.3.0/hdf5-1.10.7-kxdjppzwnndofihbdzlbiv5mzyymwdqr/include -I/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/p\r\n             armetis-4.0.3-dz2oktl2xw36xifkcpxljzctewkyo5cv/include -I/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/metis-5.1.0-vds2a7ehbmqig5t4e5albl6\r\n             ivgtl4mvm/include -I/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/zlib-1.2.11-ufqpqnpj5gjkfx5sd2o3twwveuowcz2b/include -I/opt/rocm-4.3.1/h\r\n             ip/include    -MMD -MP /tmp/root/spack-stage/spack-stage-petsc-3.16.1-ga2bqpwvkfd77jgqocc3cfp6uznbze7x/spack-src/src/sys/objects/inherit.c -o ar\r\n             ch-linux-c-opt/obj/sys/objects/inherit.o\r\n\r\n     ...\r\n\r\n     998     /spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/mpich-3.4.2-da2intlyhnltoebtrcvfl7qeffmwwzp6/bin/mpicc -c -fPIC    -I/tmp/root/spack-stage/s\r\n             pack-stage-petsc-3.16.1-ga2bqpwvkfd77jgqocc3cfp6uznbze7x/spack-src/include -I/tmp/root/spack-stage/spack-stage-petsc-3.16.1-ga2bqpwvkfd77jgqocc3\r\n             cfp6uznbze7x/spack-src/arch-linux-c-opt/include -I/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/hypre-2.23.0-c3nxdg26jzas4u5ppomt47ei6ngua\r\n             wqw/include -I/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/superlu-dist-7.1.1-bgdrrdvgctco37h2hg4czjmig7sdhvhq/include -I/spack/opt/spack\r\n             /linux-ubuntu20.04-x86_64/gcc-9.3.0/hdf5-1.10.7-kxdjppzwnndofihbdzlbiv5mzyymwdqr/include -I/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/p\r\n             armetis-4.0.3-dz2oktl2xw36xifkcpxljzctewkyo5cv/include -I/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/metis-5.1.0-vds2a7ehbmqig5t4e5albl6\r\n             ivgtl4mvm/include -I/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/zlib-1.2.11-ufqpqnpj5gjkfx5sd2o3twwveuowcz2b/include -I/opt/rocm-4.3.1/h\r\n             ip/include    -MMD -MP /tmp/root/spack-stage/spack-stage-petsc-3.16.1-ga2bqpwvkfd77jgqocc3cfp6uznbze7x/spack-src/src/sys/objects/optionsyaml.c -\r\n             o arch-linux-c-opt/obj/sys/objects/optionsyaml.o\r\n     999     /spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/mpich-3.4.2-da2intlyhnltoebtrcvfl7qeffmwwzp6/bin/mpic++ -c -fPIC -std=gnu++17   -I/tmp/root/\r\n             spack-stage/spack-stage-petsc-3.16.1-ga2bqpwvkfd77jgqocc3cfp6uznbze7x/spack-src/include -I/tmp/root/spack-stage/spack-stage-petsc-3.16.1-ga2bqpw\r\n             vkfd77jgqocc3cfp6uznbze7x/spack-src/arch-linux-c-opt/include -I/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/hypre-2.23.0-c3nxdg26jzas4u5p\r\n             pomt47ei6nguawqw/include -I/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/superlu-dist-7.1.1-bgdrrdvgctco37h2hg4czjmig7sdhvhq/include -I/sp\r\n             ack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/hdf5-1.10.7-kxdjppzwnndofihbdzlbiv5mzyymwdqr/include -I/spack/opt/spack/linux-ubuntu20.04-x86_6\r\n             4/gcc-9.3.0/parmetis-4.0.3-dz2oktl2xw36xifkcpxljzctewkyo5cv/include -I/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/metis-5.1.0-vds2a7ehbm\r\n             qig5t4e5albl6ivgtl4mvm/include -I/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/zlib-1.2.11-ufqpqnpj5gjkfx5sd2o3twwveuowcz2b/include -I/opt\r\n             /rocm-4.3.1/hip/include    -MMD -MP /tmp/root/spack-stage/spack-stage-petsc-3.16.1-ga2bqpwvkfd77jgqocc3cfp6uznbze7x/spack-src/src/sys/objects/de\r\n             vice/interface/cupminterface.cxx -o arch-linux-c-opt/obj/sys/objects/device/interface/cupminterface.o\r\n     1000    /spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/mpich-3.4.2-da2intlyhnltoebtrcvfl7qeffmwwzp6/bin/mpic++ -c -fPIC -std=gnu++17   -I/tmp/root/\r\n             spack-stage/spack-stage-petsc-3.16.1-ga2bqpwvkfd77jgqocc3cfp6uznbze7x/spack-src/include -I/tmp/root/spack-stage/spack-stage-petsc-3.16.1-ga2bqpw\r\n             vkfd77jgqocc3cfp6uznbze7x/spack-src/arch-linux-c-opt/include -I/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/hypre-2.23.0-c3nxdg26jzas4u5p\r\n             pomt47ei6nguawqw/include -I/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/superlu-dist-7.1.1-bgdrrdvgctco37h2hg4czjmig7sdhvhq/include -I/sp\r\n             ack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/hdf5-1.10.7-kxdjppzwnndofihbdzlbiv5mzyymwdqr/include -I/spack/opt/spack/linux-ubuntu20.04-x86_6\r\n             4/gcc-9.3.0/parmetis-4.0.3-dz2oktl2xw36xifkcpxljzctewkyo5cv/include -I/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/metis-5.1.0-vds2a7ehbm\r\n             qig5t4e5albl6ivgtl4mvm/include -I/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/zlib-1.2.11-ufqpqnpj5gjkfx5sd2o3twwveuowcz2b/include -I/opt\r\n             /rocm-4.3.1/hip/include    -MMD -MP /tmp/root/spack-stage/spack-stage-petsc-3.16.1-ga2bqpwvkfd77jgqocc3cfp6uznbze7x/spack-src/src/sys/objects/de\r\n             vice/interface/devicereg.cxx -o arch-linux-c-opt/obj/sys/objects/device/interface/devicereg.o\r\n     1001    /spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/mpich-3.4.2-da2intlyhnltoebtrcvfl7qeffmwwzp6/bin/mpic++ -c -fPIC -std=gnu++17   -I/tmp/root/\r\n             spack-stage/spack-stage-petsc-3.16.1-ga2bqpwvkfd77jgqocc3cfp6uznbze7x/spack-src/include -I/tmp/root/spack-stage/spack-stage-petsc-3.16.1-ga2bqpw\r\n             vkfd77jgqocc3cfp6uznbze7x/spack-src/arch-linux-c-opt/include -I/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/hypre-2.23.0-c3nxdg26jzas4u5p\r\n             pomt47ei6nguawqw/include -I/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/superlu-dist-7.1.1-bgdrrdvgctco37h2hg4czjmig7sdhvhq/include -I/sp\r\n             ack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/hdf5-1.10.7-kxdjppzwnndofihbdzlbiv5mzyymwdqr/include -I/spack/opt/spack/linux-ubuntu20.04-x86_6\r\n             4/gcc-9.3.0/parmetis-4.0.3-dz2oktl2xw36xifkcpxljzctewkyo5cv/include -I/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/metis-5.1.0-vds2a7ehbm\r\n             qig5t4e5albl6ivgtl4mvm/include -I/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/zlib-1.2.11-ufqpqnpj5gjkfx5sd2o3twwveuowcz2b/include -I/opt\r\n             /rocm-4.3.1/hip/include    -MMD -MP /tmp/root/spack-stage/spack-stage-petsc-3.16.1-ga2bqpwvkfd77jgqocc3cfp6uznbze7x/spack-src/src/sys/objects/de\r\n             vice/interface/dcontext.cxx -o arch-linux-c-opt/obj/sys/objects/device/interface/dcontext.o\r\n     1002    /spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/mpich-3.4.2-da2intlyhnltoebtrcvfl7qeffmwwzp6/bin/mpic++ -c -fPIC -std=gnu++17   -I/tmp/root/\r\n             spack-stage/spack-stage-petsc-3.16.1-ga2bqpwvkfd77jgqocc3cfp6uznbze7x/spack-src/include -I/tmp/root/spack-stage/spack-stage-petsc-3.16.1-ga2bqpw\r\n             vkfd77jgqocc3cfp6uznbze7x/spack-src/arch-linux-c-opt/include -I/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/hypre-2.23.0-c3nxdg26jzas4u5p\r\n             pomt47ei6nguawqw/include -I/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/superlu-dist-7.1.1-bgdrrdvgctco37h2hg4czjmig7sdhvhq/include -I/sp\r\n             ack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/hdf5-1.10.7-kxdjppzwnndofihbdzlbiv5mzyymwdqr/include -I/spack/opt/spack/linux-ubuntu20.04-x86_6\r\n             4/gcc-9.3.0/parmetis-4.0.3-dz2oktl2xw36xifkcpxljzctewkyo5cv/include -I/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/metis-5.1.0-vds2a7ehbm\r\n             qig5t4e5albl6ivgtl4mvm/include -I/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/zlib-1.2.11-ufqpqnpj5gjkfx5sd2o3twwveuowcz2b/include -I/opt\r\n             /rocm-4.3.1/hip/include    -MMD -MP /tmp/root/spack-stage/spack-stage-petsc-3.16.1-ga2bqpwvkfd77jgqocc3cfp6uznbze7x/spack-src/src/sys/objects/de\r\n             vice/interface/device.cxx -o arch-linux-c-opt/obj/sys/objects/device/interface/device.o\r\n     1003    /spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/mpich-3.4.2-da2intlyhnltoebtrcvfl7qeffmwwzp6/bin/mpic++ -c -fPIC -std=gnu++17   -I/tmp/root/\r\n             spack-stage/spack-stage-petsc-3.16.1-ga2bqpwvkfd77jgqocc3cfp6uznbze7x/spack-src/include -I/tmp/root/spack-stage/spack-stage-petsc-3.16.1-ga2bqpw\r\n             vkfd77jgqocc3cfp6uznbze7x/spack-src/arch-linux-c-opt/include -I/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/hypre-2.23.0-c3nxdg26jzas4u5p\r\n             pomt47ei6nguawqw/include -I/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/superlu-dist-7.1.1-bgdrrdvgctco37h2hg4czjmig7sdhvhq/include -I/sp\r\n             ack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/hdf5-1.10.7-kxdjppzwnndofihbdzlbiv5mzyymwdqr/include -I/spack/opt/spack/linux-ubuntu20.04-x86_6\r\n             4/gcc-9.3.0/parmetis-4.0.3-dz2oktl2xw36xifkcpxljzctewkyo5cv/include -I/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/metis-5.1.0-vds2a7ehbm\r\n             qig5t4e5albl6ivgtl4mvm/include -I/spack/opt/spack/linux-ubuntu20.04-x86_64/gcc-9.3.0/zlib-1.2.11-ufqpqnpj5gjkfx5sd2o3twwveuowcz2b/include -I/opt\r\n             /rocm-4.3.1/hip/include    -MMD -MP /tmp/root/spack-stage/spack-stage-petsc-3.16.1-ga2bqpwvkfd77jgqocc3cfp6uznbze7x/spack-src/src/sys/objects/de\r\n             vice/impls/cupm/cupmdevice.cxx -o arch-linux-c-opt/obj/sys/objects/device/impls/cupm/cupmdevice.o\r\n  >> 1004    make[2]: *** [/tmp/root/spack-stage/spack-stage-petsc-3.16.1-ga2bqpwvkfd77jgqocc3cfp6uznbze7x/spack-src/lib/petsc/conf/rules:50: libs] Error 2\r\n     1005    **************************ERROR*************************************\r\n     1006      Error during compile, check arch-linux-c-opt/lib/petsc/conf/make.log\r\n     1007      Send it and arch-linux-c-opt/lib/petsc/conf/configure.log to petsc-maint@mcs.anl.gov\r\n     1008    ********************************************************************\r\n  >> 1009    make[1]: *** [makefile:40: all] Error 1\r\n  >> 1010    make: *** [GNUmakefile:9: all] Error 2\r\n```\r\n\r\n### Information on your system\r\n\r\n* **Spack:** 0.17.0-466-ec1f974921\r\n* **Python:** 3.8.10\r\n* **Platform:** linux-ubuntu20.04-broadwell\r\n* **Concretizer:** clingo\r\n\r\n### Additional information\r\n\r\n[spack-build-out.txt](https://github.com/spack/spack/files/7688055/spack-build-out.txt)\r\n[spack-build-env.txt](https://github.com/spack/spack/files/7688054/spack-build-env.txt)\r\n\r\n@jedbrown\r\n@BarrySmith\r\n@balay\r\n\r\n### General information\r\n\r\n- [X] I have run `spack debug report` and reported the version of Spack/Python/Platform\r\n- [X] I have run `spack maintainers <name-of-the-package>` and **@mentioned** any maintainers\r\n- [X] I have uploaded the build log and environment files\r\n- [X] I have searched the issues of this repo and believe this is not a duplicate",
    "user": "eugeneswalker",
    "url": "https://api.github.com/repos/spack/spack/issues/27892",
    "updated_at": "2021-12-13 18:16:57",
    "created_at": "2021-12-09 19:57:02",
    "closed_at": "None",
    "state": "open",
    "title": "petsc +rocm build fails: petscsysmod.F90: 'iso_c_binding.mod' opened at (1) is not a GNU Fortran module file",
    "number": 27892,
    "milestone": null,
    "labels": [
        "build-error",
        "e4s",
        "ROCm/hip"
    ],
    "id": 1075950395,
    "html_url": "https://github.com/spack/spack/issues/27892",
    "assignees": [],
    "comments": 12
}