{
    "body": "### Steps to reproduce the issue\n\n```console\r\n$ spack env create fenicsx-env\r\n$ spack env activate fenicsx-env\r\n$ echo \"  concretization: together\" >> ./spack/var/spack/environments/fenicsx-env/spack.yaml\r\n$ spack add py-fenics-dolfinx@0.1.0 %gcc@10.1.0 ^petsc+mumps+hypre cflags=\"-O3\" fflags=\"-O3\" ^openmpi@4.1.1\r\n```\r\n\n\n### Error message\n\n<details><summary>Error message</summary><pre>\r\n==> Error: ProcessError: Command exited with status 1:\r\n    '/scratchm/jmoulin/TOOLS/spack/opt/spack/linux-centos7-broadwell/gcc-10.1.0/python-3.9.10-dog6ldmzldm3rcbhqfy6kp4s4jyr5gvv/bin/python3.9' '-m' 'pip' '-vvv' '--no-input' '--no-cache-dir' '--disable-pip-version-check' 'install' '--no-deps' '--ignore-installed' '--no-build-isolation' '--no-warn-script-location' '--no-index' '--prefix=/scratchm/jmoulin/TOOLS/spack/opt/spack/linux-centos7-broadwell/gcc-10.1.0/py-fenics-dolfinx-0.1.0-ixtkcez7ozj7svbmuorq2saiulrv7lil' '.'\r\n\r\n11 errors found in build log:\r\n     146      [ 61%] Building CXX object CMakeFiles/cpp.dir/dolfinx/wrappers/la\r\n            .cpp.o\r\n     147      [ 69%] Building CXX object CMakeFiles/cpp.dir/dolfinx/wrappers/lo\r\n            g.cpp.o\r\n     148      [ 76%] Building CXX object CMakeFiles/cpp.dir/dolfinx/wrappers/me\r\n            sh.cpp.o\r\n     149      [ 84%] Building CXX object CMakeFiles/cpp.dir/dolfinx/wrappers/nl\r\n            s.cpp.o\r\n     150      [ 92%] Building CXX object CMakeFiles/cpp.dir/dolfinx/wrappers/re\r\n            finement.cpp.o\r\n     151      [100%] Linking CXX shared library ../lib.linux-x86_64-3.9/dolfinx\r\n            /cpp.cpython-39-x86_64-linux-gnu.so\r\n  >> 152    /usr/bin/ld: cannot find -lhdf5-shared\r\n  >> 153      collect2: error: ld returned 1 exit status\r\n  >> 154      gmake[2]: *** [../lib.linux-x86_64-3.9/dolfinx/cpp.cpython-39-x86\r\n            _64-linux-gnu.so] Error 1\r\n  >> 155      gmake[1]: *** [CMakeFiles/cpp.dir/all] Error 2\r\n  >> 156      gmake: *** [all] Error 2\r\n     157      Traceback (most recent call last):\r\n     158        File \"<string>\", line 1, in <module>\r\n     159        File \"/tmp/jmoulin/spack-stage/spack-stage-py-fenics-dolfinx-0.\r\n            1.0-ixtkcez7ozj7svbmuorq2saiulrv7lil/spack-src/python/setup.py\", li\r\n            ne 65, in <module>\r\n     160          setup(name='fenics-dolfinx',\r\n     161        File \"/scratchm/jmoulin/TOOLS/spack/opt/spack/linux-centos7-bro\r\n            adwell/gcc-10.1.0/py-setuptools-59.4.0-5u5cgfp3ekuz63njujqwnwydkupe\r\n            m6dy/lib/python3.9/site-packages/setuptools/__init__.py\", line 153,\r\n             in setup\r\n     162          return distutils.core.setup(**attrs)\r\n\r\n     ...\r\n\r\n     198    Failed to build fenics-dolfinx\r\n     199    Installing collected packages: fenics-dolfinx\r\n     200      Created temporary directory: /tmp/pip-record-bg9htmjx\r\n     201        Running setup.py install for fenics-dolfinx: started\r\n     202        Running command /scratchm/jmoulin/TOOLS/spack/opt/spack/linux-c\r\n            entos7-broadwell/gcc-10.1.0/python-3.9.10-dog6ldmzldm3rcbhqfy6kp4s4\r\n            jyr5gvv/bin/python3.9 -u -c 'import io, os, sys, setuptools, tokeni\r\n            ze; sys.argv[0] = '\"'\"'/tmp/jmoulin/spack-stage/spack-stage-py-feni\r\n            cs-dolfinx-0.1.0-ixtkcez7ozj7svbmuorq2saiulrv7lil/spack-src/python/\r\n            setup.py'\"'\"'; __file__='\"'\"'/tmp/jmoulin/spack-stage/spack-stage-p\r\n            y-fenics-dolfinx-0.1.0-ixtkcez7ozj7svbmuorq2saiulrv7lil/spack-src/p\r\n            ython/setup.py'\"'\"';f = getattr(tokenize, '\"'\"'open'\"'\"', open)(__f\r\n            ile__) if os.path.exists(__file__) else io.StringIO('\"'\"'from setup\r\n            tools import setup; setup()'\"'\"');code = f.read().replace('\"'\"'\\r\\n\r\n            '\"'\"', '\"'\"'\\n'\"'\"');f.close();exec(compile(code, __file__, '\"'\"'ex\r\n            ec'\"'\"'))' install --record /tmp/pip-record-bg9htmjx/install-record\r\n            .txt --single-version-externally-managed --prefix /scratchm/jmoulin\r\n            /TOOLS/spack/opt/spack/linux-centos7-broadwell/gcc-10.1.0/py-fenics\r\n            -dolfinx-0.1.0-ixtkcez7ozj7svbmuorq2saiulrv7lil --compile --install\r\n            -headers /scratchm/jmoulin/TOOLS/spack/opt/spack/linux-centos7-broa\r\n            dwell/gcc-10.1.0/py-fenics-dolfinx-0.1.0-ixtkcez7ozj7svbmuorq2saiul\r\n            rv7lil/include/python3.9/fenics-dolfinx\r\n     203        running install\r\n  >> 204    /scratchm/jmoulin/TOOLS/spack/opt/spack/linux-centos7-broadwell/gcc\r\n            -10.1.0/py-setuptools-59.4.0-5u5cgfp3ekuz63njujqwnwydkupem6dy/lib/p\r\n            ython3.9/site-packages/setuptools/command/install.py:34: Setuptools\r\n            DeprecationWarning: setup.py install is deprecated. Use build and p\r\n            ip and other standards-based tools.\r\n     205          warnings.warn(\r\n     206        running build\r\n     207        running build_py\r\n     208        creating build\r\n     209        creating build/lib.linux-x86_64-3.9\r\n     210        creating build/lib.linux-x86_64-3.9/dolfinx\r\n\r\n     ...\r\n\r\n     314        [ 61%] Building CXX object CMakeFiles/cpp.dir/dolfinx/wrappers/\r\n            la.cpp.o\r\n     315        [ 69%] Building CXX object CMakeFiles/cpp.dir/dolfinx/wrappers/\r\n            log.cpp.o\r\n     316        [ 76%] Building CXX object CMakeFiles/cpp.dir/dolfinx/wrappers/\r\n            mesh.cpp.o\r\n     317        [ 84%] Building CXX object CMakeFiles/cpp.dir/dolfinx/wrappers/\r\n            nls.cpp.o\r\n     318        [ 92%] Building CXX object CMakeFiles/cpp.dir/dolfinx/wrappers/\r\n            refinement.cpp.o\r\n     319        [100%] Linking CXX shared library ../lib.linux-x86_64-3.9/dolfi\r\n            nx/cpp.cpython-39-x86_64-linux-gnu.so\r\n  >> 320    /usr/bin/ld: cannot find -lhdf5-shared\r\n  >> 321        collect2: error: ld returned 1 exit status\r\n  >> 322        gmake[2]: *** [../lib.linux-x86_64-3.9/dolfinx/cpp.cpython-39-x\r\n            86_64-linux-gnu.so] Error 1\r\n  >> 323        gmake[1]: *** [CMakeFiles/cpp.dir/all] Error 2\r\n  >> 324        gmake: *** [all] Error 2\r\n     325        Traceback (most recent call last):\r\n     326          File \"<string>\", line 1, in <module>\r\n     327          File \"/tmp/jmoulin/spack-stage/spack-stage-py-fenics-dolfinx-\r\n            0.1.0-ixtkcez7ozj7svbmuorq2saiulrv7lil/spack-src/python/setup.py\",\r\n            line 65, in <module>\r\n     328            setup(name='fenics-dolfinx',\r\n     329          File \"/scratchm/jmoulin/TOOLS/spack/opt/spack/linux-centos7-b\r\n            roadwell/gcc-10.1.0/py-setuptools-59.4.0-5u5cgfp3ekuz63njujqwnwydku\r\n            pem6dy/lib/python3.9/site-packages/setuptools/__init__.py\", line 15\r\n            3, in setup\r\n     330            return distutils.core.setup(**attrs)\r\n\r\nSee build log for details:\r\n  /tmp/jmoulin/spack-stage/spack-stage-py-fenics-dolfinx-0.1.0-ixtkcez7ozj7svbmuorq2saiulrv7lil/spack-build-out.txt\r\n\r\n</pre></details>\r\n\n\n### Information on your system\n\n* **Spack:** 0.17.1-1368-8f4e029e3a\r\n* **Python:** 2.7.5\r\n* **Platform:** linux-centos7-broadwell\r\n* **Concretizer:** clingo\r\n\n\n### Additional information\n\n[spack-build-env.txt](https://github.com/spack/spack/files/8161435/spack-build-env.txt)\r\n[spack-build-out.txt](https://github.com/spack/spack/files/8161436/spack-build-out.txt)\r\n\r\n@chrisrichardson \r\n@garth-wells \r\n@nate-sime \n\n### General information\n\n- [X] I have run `spack debug report` and reported the version of Spack/Python/Platform\n- [X] I have run `spack maintainers <name-of-the-package>` and **@mentioned** any maintainers\n- [X] I have uploaded the build log and environment files\n- [X] I have searched the issues of this repo and believe this is not a duplicate",
    "user": "jomoulin",
    "url": "https://api.github.com/repos/spack/spack/issues/29263",
    "updated_at": "2022-03-02 16:33:18",
    "created_at": "2022-03-01 12:11:28",
    "closed_at": "2022-03-02 16:33:17",
    "state": "closed",
    "title": "Installation issue: py-fenics-dolfinx@0.1.0 can't find `-lhdf5-shared`",
    "number": 29263,
    "milestone": null,
    "labels": [
        "build-error"
    ],
    "id": 1155265909,
    "html_url": "https://github.com/spack/spack/issues/29263",
    "assignees": [],
    "comments": 2
}