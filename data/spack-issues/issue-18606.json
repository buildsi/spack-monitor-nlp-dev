{
    "body": "There seems to be a problem building some packages ( not all packages )  using the intel compiler.\r\nSome packages compile fine without an issue ( for example packages such as zlib, openssl, and cmake  gives no issue ) but others give linking problem.\r\nAs an example to reproduce the problem I use fgsl package which produced an error as we see here.\r\n```console\r\n$ spack install fgsl%intel\r\n```\r\nnow when I try installing a package that involves linking against something from the the math kernel library it fails providing the following error\r\n```\r\n==> Error: ProcessError: Command exited with status 2:\r\n    'make'\r\n\r\n1 error found in build log:\r\n     165    /bin/bash ./libtool  --tag=CC   --mode=compile /home/mohamedkamra/LocalAppInstalls/spack/lib/spack/env/intel/icc -DHAVE_CONFIG_H -I.  -I. -I.  -I/home/mohamedkamra/LocalAppInstalls/spack/opt/spack/linux-ubuntu20.04-zen2/intel-19.1.2.254/gsl-2.4-jczpzktqce2fvi7ngav6krwd\r\n            2qhdd4ba/include -I. -g -O2 -MT libfgsl_la-fgsl_utils.lo -MD -MP -MF .deps/libfgsl_la-fgsl_utils.Tpo -c -o libfgsl_la-fgsl_utils.lo `test -f 'fgsl_utils.c' || echo './'`fgsl_utils.c\r\n     166    libtool: compile:  /home/mohamedkamra/LocalAppInstalls/spack/lib/spack/env/intel/icc -DHAVE_CONFIG_H -I. -I. -I. -I/home/mohamedkamra/LocalAppInstalls/spack/opt/spack/linux-ubuntu20.04-zen2/intel-19.1.2.254/gsl-2.4-jczpzktqce2fvi7ngav6krwd2qhdd4ba/include -I. -g -O2 -M\r\n            T libfgsl_la-fgsl_utils.lo -MD -MP -MF .deps/libfgsl_la-fgsl_utils.Tpo -c fgsl_utils.c  -fPIC -DPIC -o .libs/libfgsl_la-fgsl_utils.o\r\n     167    libtool: compile:  /home/mohamedkamra/LocalAppInstalls/spack/lib/spack/env/intel/icc -DHAVE_CONFIG_H -I. -I. -I. -I/home/mohamedkamra/LocalAppInstalls/spack/opt/spack/linux-ubuntu20.04-zen2/intel-19.1.2.254/gsl-2.4-jczpzktqce2fvi7ngav6krwd2qhdd4ba/include -I. -g -O2 -M\r\n            T libfgsl_la-fgsl_utils.lo -MD -MP -MF .deps/libfgsl_la-fgsl_utils.Tpo -c fgsl_utils.c -o libfgsl_la-fgsl_utils.o >/dev/null 2>&1\r\n     168    mv -f .deps/libfgsl_la-fgsl_utils.Tpo .deps/libfgsl_la-fgsl_utils.Plo\r\n     169    /bin/bash ./libtool  --tag=FC   --mode=link /home/mohamedkamra/LocalAppInstalls/spack/lib/spack/env/intel/ifort  -g -version-info 1:2:0   -o libfgsl.la -rpath /home/mohamedkamra/LocalAppInstalls/spack/opt/spack/linux-ubuntu20.04-zen2/intel-19.1.2.254/fgsl-1.3.0-l6zncad\r\n            usl3i22yk3ffhxqzu3oxyhcou/lib fgsl.lo libfgsl_la-fgsl_utils.lo  -L/home/mohamedkamra/LocalAppInstalls/spack/opt/spack/linux-ubuntu20.04-zen2/intel-19.1.2.254/gsl-2.4-jczpzktqce2fvi7ngav6krwd2qhdd4ba/lib -lgsl -lgslcblas -lm\r\n     170    libtool: link: /home/mohamedkamra/LocalAppInstalls/spack/lib/spack/env/intel/ifort -shared -nofor_main  .libs/fgsl.o .libs/libfgsl_la-fgsl_utils.o   -Wl,-rpath -Wl,/home/mohamedkamra/LocalAppInstalls/spack/opt/spack/linux-ubuntu20.04-zen2/intel-19.1.2.254/gsl-2.4-jczpz\r\n            ktqce2fvi7ngav6krwd2qhdd4ba/lib -Wl,-rpath -Wl,/home/mohamedkamra/LocalAppInstalls/spack/opt/spack/linux-ubuntu20.04-zen2/intel-19.1.2.254/gsl-2.4-jczpzktqce2fvi7ngav6krwd2qhdd4ba/lib -L/home/mohamedkamra/LocalAppInstalls/spack/opt/spack/linux-ubuntu20.04-zen2/intel-19\r\n            .1.2.254/gsl-2.4-jczpzktqce2fvi7ngav6krwd2qhdd4ba/lib /home/mohamedkamra/LocalAppInstalls/spack/opt/spack/linux-ubuntu20.04-zen2/intel-19.1.2.254/gsl-2.4-jczpzktqce2fvi7ngav6krwd2qhdd4ba/lib/libgsl.so /home/mohamedkamra/LocalAppInstalls/spack/opt/spack/linux-ubuntu20.0\r\n            4-zen2/intel-19.1.2.254/gsl-2.4-jczpzktqce2fvi7ngav6krwd2qhdd4ba/lib/libgslcblas.so -lm  -g   -Wl,-soname -Wl,libfgsl.so.1 -o .libs/libfgsl.so.1.0.2\r\n  >> 171    ld: /home/mohamedkamra/LocalAppInstalls/spack/opt/spack/linux-ubuntu20.04-zen2/gcc-9.3.0/intel-20.0.2-mrgwii556tj2jpbckrp3kjxx34ubk52j/compilers_and_libraries_2020.2.254/linux/bin/intel64/../../lib/LLVMgold.so: error loading plugin: libimf.so: cannot open shared object\r\n             file: No such file or directory\r\n```\r\nthe error indicate that library is not the `LD_LIBRARY_PATH`\r\nI have confirmed that libimf when intel compiler is loaded by running\r\n```\r\n/sbin/ldconfig -N -v $(sed 's/:/ /g' <<< $LD_LIBRARY_PATH) | tee log.txt\r\n```\r\n```\r\n/home/mohamedkamra/LocalAppInstalls/spack/opt/spack/linux-ubuntu20.04-zen2/gcc-9.3.0/intel-20.0.2-mrgwii556tj2jpbckrp3kjxx34ubk52j/compilers_and_libraries_2020.2.254/linux/compiler/lib/intel64_lin:\r\n\tlibiomp5.so -> libiomp5.so\r\n\tlibifport.so.5 -> libifport.so.5\r\n\tlibifcore.so.5 -> libifcore.so.5\r\n\tlibintlc.so.5 -> libintlc.so.5\r\n\tlibistrconv.so -> libistrconv.so\r\n\tlibimf.so -> libimf.so\r\n\tlibifcoremt.so.5 -> libifcoremt.so.5\r\n\tlibiomp5_db.so -> libiomp5_db.so\r\n\tlibpdbx.so.5 -> libpdbx.so.5\r\n\tlibcilkrts.so.5 -> libcilkrts.so.5\r\n\tlibirc.so -> libirc.so\r\n\tlibsvml.so -> libsvml.so\r\n\tlibqkmalloc.so -> libqkmalloc.so\r\n\tlibchkp.so -> libchkp.so\r\n\tlibmpx.so -> libmpx.so\r\n\tlibiompstubs5.so -> libiompstubs5.so\r\n\tlibirng.so -> libirng.so\r\n\tlibicaf.so -> libicaf.so\r\n```\r\nyet for some some reason it is not detected the package during build.\r\n\r\n**Could be similar Issue**\r\nI found the following issue \r\nhttps://github.com/spack/spack/issues/17100#issue-638768001\r\nbut I am not sure if it is the same or not and the issue remains open\r\n### Information on your system\r\n\r\n$ spack debug report\r\n* **Spack:** 0.15.4-933-651cffae0\r\n* **Python:** 3.8.2\r\n* **Platform:** linux-ubuntu20.04-zen2\r\n\r\n\r\n<!-- If you have any relevant configuration detail (custom `packages.yaml` or `modules.yaml`, etc.) you can add that here as well. -->\r\n```yaml\r\n**compilers.yml**\r\ncompilers:\r\n- compiler:\r\n    spec: gcc@8.4.0\r\n    paths:\r\n      cc: /usr/bin/gcc-8\r\n      cxx: /usr/bin/g++-8\r\n      f77: /usr/bin/gfortran-8\r\n      fc: /usr/bin/gfortran-8\r\n    flags: {}\r\n    operating_system: ubuntu20.04\r\n    target: x86_64\r\n    modules: []\r\n    environment: {}\r\n    extra_rpaths: []\r\n- compiler:\r\n    spec: gcc@9.3.0\r\n    paths:\r\n      cc: /usr/bin/gcc\r\n      cxx: /usr/bin/g++\r\n      f77: /usr/bin/gfortran\r\n      fc: /usr/bin/gfortran\r\n    flags: {}\r\n    operating_system: ubuntu20.04\r\n    target: x86_64\r\n    modules: []\r\n    environment: {}\r\n    extra_rpaths: []\r\n- compiler:\r\n    spec: intel@19.1.2.254\r\n    paths:\r\n      cc: /home/mohamedkamra/LocalAppInstalls/spack/opt/spack/linux-ubuntu20.04-zen2/gcc-9.3.0/intel-20.0.2-mrgwii556tj2jpbckrp3kjxx34ubk52j/compilers_and_libraries_2020.2.254/linux/bin/intel64/icc\r\n      cxx: /home/mohamedkamra/LocalAppInstalls/spack/opt/spack/linux-ubuntu20.04-zen2/gcc-9.3.0/intel-20.0.2-mrgwii556tj2jpbckrp3kjxx34ubk52j/compilers_and_libraries_2020.2.254/linux/bin/intel64/icpc\r\n      f77: /home/mohamedkamra/LocalAppInstalls/spack/opt/spack/linux-ubuntu20.04-zen2/gcc-9.3.0/intel-20.0.2-mrgwii556tj2jpbckrp3kjxx34ubk52j/compilers_and_libraries_2020.2.254/linux/bin/intel64/ifort\r\n      fc: /home/mohamedkamra/LocalAppInstalls/spack/opt/spack/linux-ubuntu20.04-zen2/gcc-9.3.0/intel-20.0.2-mrgwii556tj2jpbckrp3kjxx34ubk52j/compilers_and_libraries_2020.2.254/linux/bin/intel64/ifort\r\n    flags: {}\r\n    operating_system: ubuntu20.04\r\n    target: x86_64\r\n    modules: []\r\n    environment: {}\r\n    extra_rpaths: []\r\n```\r\n### Additional information\r\n\r\n[spack-build-env.txt](https://github.com/spack/spack/files/5201544/spack-build-env.txt)\r\n[spack-build-out.txt](https://github.com/spack/spack/files/5201549/spack-build-out.txt)\r\n\r\nI don't know if this has to do with anything but when I run\r\n```console\r\n$ spack load intel@20.0.2 \r\n==> Warning: Quotes in command arguments can confuse scripts like configure.\r\n  The following arguments may cause problems when executed:\r\n      source /dev/null &> /dev/null && python3 -c \"import os, json; print(json.dumps(dict(os.environ)))\"\r\n  Quotes aren't needed because spack doesn't use a shell.\r\n  Consider removing them\r\n==> Warning: Quotes in command arguments can confuse scripts like configure.\r\n  The following arguments may cause problems when executed:\r\n      source /home/mohamedkamra/LocalAppInstalls/spack/opt/spack/linux-ubuntu20.04-zen2/gcc-9.3.0/intel-20.0.2-mrgwii556tj2jpbckrp3kjxx34ubk52j/compilers_and_libraries_2020.2.254/linux/bin/compilervars.sh intel64 &> /dev/null && python3 -c \"import os, json; print(json.dumps(dict(os.environ)))\"\r\n  Quotes aren't needed because spack doesn't use a shell.\r\n  Consider removing them\r\n```\r\n\r\n**spack external find**\r\n```console\r\n$ spack external find\r\n==> Error: 20.04-b01: Identifier cannot contain '.'\r\n```\r\n\r\n### General information\r\n\r\n<!-- These boxes can be checked by replacing [ ] with [x] or by clicking them after submitting the issue. -->\r\n- [x] I have run `spack debug report` and reported the version of Spack/Python/Platform\r\n- [x] I have run `spack maintainers intel` and @mentioned any maintainers\r\n- [x] I have uploaded the build log and environment files\r\n- [x] I have searched the issues of this repo and believe this is not a duplicate\r\n",
    "user": "mo7ammedmostafa",
    "url": "https://api.github.com/repos/spack/spack/issues/18606",
    "updated_at": "2022-02-15 17:47:30",
    "created_at": "2020-09-10 13:18:11",
    "closed_at": "2022-02-15 17:47:30",
    "state": "closed",
    "title": "Installation issue: package (e.g. fgsl) using intel compiler",
    "number": 18606,
    "milestone": null,
    "labels": [
        "build-error",
        "intel"
    ],
    "id": 697949078,
    "html_url": "https://github.com/spack/spack/issues/18606",
    "assignees": [],
    "comments": 10
}