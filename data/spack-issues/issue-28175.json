{
    "body": "### Steps to reproduce\r\n\r\nThe basic command is\r\n```\r\nspack install trilinos@13.2.0+cuda+hdf5~mpi+openmp cuda_arch=72 ^python~pyexpat ^kokkos-nvcc-wrapper~mpi\r\n```\r\n\r\nbut attached is the script used to run that, as it sets other variables.  .txt was added to all file names so that github would accept them.  I also attach the build-out.txt file, which contains the full list of errors.\r\n\r\nAn example error is\r\n\r\n/home/bilder/contrib/gcc-9.4.0/lib/gcc/x86_64-pc-linux-gnu/9.4.0/include/avx512fintrin.h(9146): error: identifier \"__builtin_ia32_rndscaless_round\" is undefined\r\n\r\nwhich may indicate that trilinos is trying to include avx512 instructions that don't exist or are not implemented?\r\n\r\n[runspack.sh.txt](https://github.com/spack/spack/files/7789132/runspack.sh.txt)\r\n[setupspack.sh.txt](https://github.com/spack/spack/files/7789133/setupspack.sh.txt)\r\n[spack.yaml.txt](https://github.com/spack/spack/files/7789140/spack.yaml.txt)\r\n[spack-build-out.txt](https://github.com/spack/spack/files/7789155/spack-build-out.txt)\r\n.\r\n\r\n### Error message\r\n\r\n```\r\ncd /home/research/cary/spack/stage/spack-stage-trilinos-13.2.0-qqmz7rt72db76rkdysb3lx6y3cimzkcg/spack-build-qqmz7rt/packages/kokkos-kernels/src && /home/research/cary/opt/linux-rocky8-zen2/gcc-9.4.0/kokkos-nvcc-wrapper-3.2.00-4n5jp35hi6jheb7giutnfl5rieynvt74/bin/nvcc_wrapper -Dkokkoskernels_EXPORTS -I/home/research/cary/spack/stage/spack-stage-trilinos-13.2.0-qqmz7rt72db76rkdysb3lx6y3cimzkcg/spack-build-qqmz7rt -I/home/research/cary/spack/stage/spack-stage-trilinos-13.2.0-qqmz7rt72db76rkdysb3lx6y3cimzkcg/spack-build-qqmz7rt/packages/kokkos-kernels/src -I/home/research/cary/spack/stage/spack-stage-trilinos-13.2.0-qqmz7rt72db76rkdysb3lx6y3cimzkcg/spack-src/packages/kokkos-kernels/src -I/home/research/cary/spack/stage/spack-stage-trilinos-13.2.0-qqmz7rt72db76rkdysb3lx6y3cimzkcg/spack-src/packages/kokkos-kernels/src/impl -I/home/research/cary/spack/stage/spack-stage-trilinos-13.2.0-qqmz7rt72db76rkdysb3lx6y3cimzkcg/spack-build-qqmz7rt/packages/kokkos-kernels/src/impl -I/home/research/cary/spack/stage/spack-stage-trilinos-13.2.0-qqmz7rt72db76rkdysb3lx6y3cimzkcg/spack-src/packages/kokkos-kernels/src/impl/tpls -I/home/research/cary/spack/stage/spack-stage-trilinos-13.2.0-qqmz7rt72db76rkdysb3lx6y3cimzkcg/spack-src/packages/kokkos-kernels/src/blas -I/home/research/cary/spack/stage/spack-stage-trilinos-13.2.0-qqmz7rt72db76rkdysb3lx6y3cimzkcg/spack-src/packages/kokkos-kernels/src/blas/impl -I/home/research/cary/spack/stage/spack-stage-trilinos-13.2.0-qqmz7rt72db76rkdysb3lx6y3cimzkcg/spack-src/packages/kokkos-kernels/src/sparse -I/home/research/cary/spack/stage/spack-stage-trilinos-13.2.0-qqmz7rt72db76rkdysb3lx6y3cimzkcg/spack-src/packages/kokkos-kernels/src/sparse/impl -I/home/research/cary/spack/stage/spack-stage-trilinos-13.2.0-qqmz7rt72db76rkdysb3lx6y3cimzkcg/spack-src/packages/kokkos-kernels/src/graph -I/home/research/cary/spack/stage/spack-stage-trilinos-13.2.0-qqmz7rt72db76rkdysb3lx6y3cimzkcg/spack-src/packages/kokkos-kernels/src/graph/impl -I/home/research/cary/spack/stage/spack-stage-trilinos-13.2.0-qqmz7rt72db76rkdysb3lx6y3cimzkcg/spack-src/packages/kokkos-kernels/src/batched -I/home/research/cary/spack/stage/spack-stage-trilinos-13.2.0-qqmz7rt72db76rkdysb3lx6y3cimzkcg/spack-src/packages/kokkos-kernels/src/common -I/home/research/cary/spack/stage/spack-stage-trilinos-13.2.0-qqmz7rt72db76rkdysb3lx6y3cimzkcg/spack-build-qqmz7rt/packages/kokkos/algorithms/src -I/home/research/cary/spack/stage/spack-stage-trilinos-13.2.0-qqmz7rt72db76rkdysb3lx6y3cimzkcg/spack-src/packages/kokkos/algorithms/src -I/home/research/cary/spack/stage/spack-stage-trilinos-13.2.0-qqmz7rt72db76rkdysb3lx6y3cimzkcg/spack-build-qqmz7rt/packages/kokkos/containers/src -I/home/research/cary/spack/stage/spack-stage-trilinos-13.2.0-qqmz7rt72db76rkdysb3lx6y3cimzkcg/spack-src/packages/kokkos/containers/src -I/home/research/cary/spack/stage/spack-stage-trilinos-13.2.0-qqmz7rt72db76rkdysb3lx6y3cimzkcg/spack-build-qqmz7rt/packages/kokkos/core/src -I/home/research/cary/spack/stage/spack-stage-trilinos-13.2.0-qqmz7rt72db76rkdysb3lx6y3cimzkcg/spack-src/packages/kokkos/core/src -I/home/research/cary/spack/stage/spack-stage-trilinos-13.2.0-qqmz7rt72db76rkdysb3lx6y3cimzkcg/spack-build-qqmz7rt/packages/kokkos -I/home/research/cary/opt/linux-rocky8-zen2/gcc-9.4.0/hwloc-2.6.0-ois5nhxvr7jurardayfyrrfmjs3y3cfj/include -I/home/research/cary/opt/linux-rocky8-zen2/gcc-9.4.0/amdlibflame-3.1-pzioontfzjlj6mysxmqosynzdzdrdau4/include -I/home/research/cary/opt/linux-rocky8-zen2/gcc-9.4.0/amdblis-3.1-s7uqgliwjsadqlbqcvsji4owtcqugmot/include -march=znver2 -mtune=znver2  -Xcompiler -fopenmp -expt-extended-lambda -Wext-lambda-captures-this -arch=sm_72  -O2 -g -DNDEBUG -fPIC -std=c++14 -MD -MT packages/kokkos-kernels/src/CMakeFiles/kokkoskernels.dir/impl/generated_specializations_cpp/trmm/Blas3_trmm_eti_DOUBLE_LAYOUTLEFT_EXECSPACE_CUDA_MEMSPACE_CUDASPACE.cpp.o -MF CMakeFiles/kokkoskernels.dir/impl/generated_specializations_cpp/trmm/Blas3_trmm_eti_DOUBLE_LAYOUTLEFT_EXECSPACE_CUDA_MEMSPACE_CUDASPACE.cpp.o.d -o CMakeFiles/kokkoskernels.dir/impl/generated_specializations_cpp/trmm/Blas3_trmm_eti_DOUBLE_LAYOUTLEFT_EXECSPACE_CUDA_MEMSPACE_CUDASPACE.cpp.o -c /home/research/cary/spack/stage/spack-stage-trilinos-13.2.0-qqmz7rt72db76rkdysb3lx6y3cimzkcg/spack-build-qqmz7rt/packages/kokkos-kernels/src/impl/generated_specializations_cpp/trmm/Blas3_trmm_eti_DOUBLE_LAYOUTLEFT_EXECSPACE_CUDA_MEMSPACE_CUDASPACE.cpp\r\n/home/bilder/contrib/gcc-9.4.0/lib/gcc/x86_64-pc-linux-gnu/9.4.0/include/avx512fintrin.h(9146): error: identifier \"__builtin_ia32_rndscaless_round\" is undefined\r\n\r\n/home/bilder/contrib/gcc-9.4.0/lib/gcc/x86_64-pc-linux-gnu/9.4.0/include/avx512fintrin.h(9155): error: identifier \"__builtin_ia32_rndscalesd_round\" is undefined\r\n\r\n/home/bilder/contrib/gcc-9.4.0/lib/gcc/x86_64-pc-linux-gnu/9.4.0/include/avx512fintrin.h(14797): error: identifier \"__builtin_ia32_rndscaless_round\" is undefined\r\n\r\n/home/bilder/contrib/gcc-9.4.0/lib/gcc/x86_64-pc-linux-gnu/9.4.0/include/avx512fintrin.h(14806): error: identifier \"__builtin_ia32_rndscalesd_round\" is undefined\r\n\r\n/home/bilder/contrib/gcc-9.4.0/lib/gcc/x86_64-pc-linux-gnu/9.4.0/include/avx512dqintrin.h(1365): error: identifier \"__builtin_ia32_fpclassss\" is undefined\r\n\r\n/home/bilder/contrib/gcc-9.4.0/lib/gcc/x86_64-pc-linux-gnu/9.4.0/include/avx512dqintrin.h(1372): error: identifier \"__builtin_ia32_fpclasssd\" is undefined\r\n\r\n6 errors detected in the compilation of \"/home/research/cary/spack/stage/spack-stage-trilinos-13.2.0-qqmz7rt72db76rkdysb3lx6y3cimzkcg/spack-build-qqmz7rt/packages/kokkos-kernels/src/impl/generated_specializations_cpp/trsm/Blas3_trsm_eti_DOUBLE_LAYOUTLEFT_EXECSPACE_CUDA_MEMSPACE_CUDASPACE.cpp\".\r\nmake[2]: *** [packages/kokkos-kernels/src/CMakeFiles/kokkoskernels.dir/build.make:1731: packages/kokkos-kernels/src/CMakeFiles/kokkoskernels.dir/impl/generated_specializations_cpp/trsm/Blas3_trsm_eti_DOUBLE_LAYOUTLEFT_EXECSPACE_CUDA_MEMSPACE_CUDASPACE.cpp.o] Error 2\r\n```\r\n\r\n### Information on your system\r\n\r\n$ spack debug report\r\n* **Spack:** 0.17.1-668-e0d8964453\r\n* **Python:** 3.6.8\r\n* **Platform:** linux-rocky8-zen2\r\n* **Concretizer:** clingo\r\n\r\n\r\n### General information\r\n\r\n- [X] I have run `spack debug report` and reported the version of Spack/Python/Platform\r\n- [X] I have searched the issues of this repo and believe this is not a duplicate\r\n- [X] I have run the failing commands in debug mode and reported the output",
    "user": "jrobcary",
    "url": "https://api.github.com/repos/spack/spack/issues/28175",
    "updated_at": "2021-12-30 00:30:09",
    "created_at": "2021-12-29 14:02:56",
    "closed_at": "2021-12-30 00:30:09",
    "state": "closed",
    "title": "Build error: kokkos-kernels +openmp+cuda arch=zen2",
    "number": 28175,
    "milestone": null,
    "labels": [
        "build-error"
    ],
    "id": 1090541388,
    "html_url": "https://github.com/spack/spack/issues/28175",
    "assignees": [],
    "comments": 18
}