{
    "body": "The package `hdf5-blosc` contains the line `from __future__ import print_function`. This seems to break Spack; the error message is\r\n\r\n```\r\nfullname= hdf5-blosc\r\nspec_like= hdf5-blosc%gcc@6.3.0-spack  args= ()  kwargs= {}\r\nspec_like= hdf5-blosc%gcc@6.3.0-spack  args= ()  kwargs= {}\r\nspec_like= hdf5-blosc  args= ()  kwargs= {}\r\nspec.name= hdf5-blosc\r\nspec_like= hdf5-blosc  args= ()  kwargs= {}\r\nspec_like= hdf5-blosc%gcc@6.3.0-spack  args= ()  kwargs= {}\r\nspec_like= hdf5-blosc  args= ()  kwargs= {}\r\nspec.name= hdf5-blosc\r\nspec_like= hdf5-blosc  args= ()  kwargs= {}\r\nspec_like= hdf5-blosc  args= ()  kwargs= {}\r\nspec.name= hdf5-blosc\r\nspec_like= hdf5-blosc  args= ()  kwargs= {}\r\nspec_like= __future__  args= ()  kwargs= {}\r\nspec.name= __future__\r\nspec_like= __future__  args= ()  kwargs= {}\r\nspec_like= __future_-  args= ()  kwargs= {}\r\nspec.name= __future_-\r\nspec_like= __future_-  args= ()  kwargs= {}\r\nspec_like= __future-_  args= ()  kwargs= {}\r\nspec.name= __future-_\r\nspec_like= __future-_  args= ()  kwargs= {}\r\nspec_like= __future--  args= ()  kwargs= {}\r\nspec.name= __future--\r\nspec_like= __future--  args= ()  kwargs= {}\r\nspec_like= _-future__  args= ()  kwargs= {}\r\nspec.name= _-future__\r\nspec_like= _-future__  args= ()  kwargs= {}\r\nspec_like= _-future_-  args= ()  kwargs= {}\r\nspec.name= _-future_-\r\nspec_like= _-future_-  args= ()  kwargs= {}\r\nspec_like= _-future-_  args= ()  kwargs= {}\r\nspec.name= _-future-_\r\nspec_like= _-future-_  args= ()  kwargs= {}\r\nspec_like= _-future--  args= ()  kwargs= {}\r\nspec.name= _-future--\r\nspec_like= _-future--  args= ()  kwargs= {}\r\nspec_like= -_future__  args= ()  kwargs= {}\r\nspec.name= None\r\nspec_like= None  args= ()  kwargs= {}\r\nTraceback (most recent call last):\r\n  File \"/Users/eschnett/src/spack/bin/spack\", line 220, in <module>\r\n    main(sys.argv)\r\n  File \"/Users/eschnett/src/spack/bin/spack\", line 216, in main\r\n    _main(args, unknown)\r\n  File \"/Users/eschnett/src/spack/bin/spack\", line 183, in _main\r\n    return_val = command(parser, args)\r\n  File \"/Users/eschnett/src/spack/lib/spack/spack/cmd/install.py\", line 317, in install\r\n    specs = spack.cmd.parse_specs(args.package, concretize=True)\r\n  File \"/Users/eschnett/src/spack/lib/spack/spack/cmd/__init__.py\", line 116, in parse_specs\r\n    spec.concretize()  # implies normalize\r\n  File \"/Users/eschnett/src/spack/lib/spack/spack/spec.py\", line 1681, in concretize\r\n    changes = (self.normalize(force),\r\n  File \"/Users/eschnett/src/spack/lib/spack/spack/spec.py\", line 1991, in normalize\r\n    any_change = self._normalize_helper(visited, spec_deps, provider_index)\r\n  File \"/Users/eschnett/src/spack/lib/spack/spack/spec.py\", line 1945, in _normalize_helper\r\n    pkg_dep, deptypes, visited, spec_deps, provider_index)\r\n  File \"/Users/eschnett/src/spack/lib/spack/spack/spec.py\", line 1879, in _merge_dependency\r\n    index = ProviderIndex([dep], restrict=True)\r\n  File \"/Users/eschnett/src/spack/lib/spack/spack/provider_index.py\", line 88, in __init__\r\n    self.update(spec)\r\n  File \"/Users/eschnett/src/spack/lib/spack/spack/provider_index.py\", line 100, in update\r\n    pkg = spec.package\r\n  File \"/Users/eschnett/src/spack/lib/spack/spack/spec.py\", line 1121, in package\r\n    return spack.repo.get(self)\r\n  File \"/Users/eschnett/src/spack/lib/spack/spack/repository.py\", line 75, in converter\r\n    return function(self, spec_like, *args, **kwargs)\r\n  File \"/Users/eschnett/src/spack/lib/spack/spack/repository.py\", line 318, in get\r\n    return self.repo_for_pkg(spec).get(spec)\r\n  File \"/Users/eschnett/src/spack/lib/spack/spack/repository.py\", line 75, in converter\r\n    return function(self, spec_like, *args, **kwargs)\r\n  File \"/Users/eschnett/src/spack/lib/spack/spack/repository.py\", line 577, in get\r\n    package_class = self.get_pkg_class(spec.name)\r\n  File \"/Users/eschnett/src/spack/lib/spack/spack/repository.py\", line 832, in get_pkg_class\r\n    module = self._get_pkg_module(pkg_name)\r\n  File \"/Users/eschnett/src/spack/lib/spack/spack/repository.py\", line 812, in _get_pkg_module\r\n    module = imp.load_source(fullname, file_path)\r\n  File \"/Users/eschnett/src/spack/var/spack/repos/builtin/packages/hdf5-blosc/package.py\", line 25, in <module>\r\n    from __future__ import print_function\r\n  File \"/Users/eschnett/src/spack/lib/spack/spack/repository.py\", line 263, in find_module\r\n    if repo.real_name(module_name):\r\n  File \"/Users/eschnett/src/spack/lib/spack/spack/repository.py\", line 493, in real_name\r\n    if name in self:\r\n  File \"/Users/eschnett/src/spack/lib/spack/spack/repository.py\", line 847, in __contains__\r\n    return self.exists(pkg_name)\r\n  File \"/Users/eschnett/src/spack/lib/spack/spack/repository.py\", line 781, in exists\r\n    filename = self.filename_for_package_name(pkg_name)\r\n  File \"/Users/eschnett/src/spack/lib/spack/spack/repository.py\", line 75, in converter\r\n    return function(self, spec_like, *args, **kwargs)\r\n  File \"/Users/eschnett/src/spack/lib/spack/spack/repository.py\", line 691, in filename_for_package_name\r\n    pkg_dir = self.dirname_for_package_name(spec.name)\r\n  File \"/Users/eschnett/src/spack/lib/spack/spack/repository.py\", line 74, in converter\r\n    spec_like = spack.spec.Spec(spec_like)\r\n  File \"/Users/eschnett/src/spack/lib/spack/spack/spec.py\", line 926, in __init__\r\n    raise TypeError(\"Can't make spec out of %s\" % type(spec_like))\r\nTypeError: Can't make spec out of <type 'NoneType'>\r\n```\r\n\r\nwhere I've added a few `print` functions to find out what is going on. Apparently, Spack is trying to interpret `future` as a spec.\r\n\r\nRemove the `import __future__` seems to make everything work again. The similar package `hdf5` does not contain such an import either, although both packages use the new `print` function.",
    "user": "eschnett",
    "url": "https://api.github.com/repos/spack/spack/issues/3676",
    "updated_at": "2017-08-16 15:34:53",
    "created_at": "2017-04-03 20:18:49",
    "closed_at": "2017-08-16 15:34:53",
    "state": "closed",
    "title": "__future__ breaks Spack",
    "number": 3676,
    "milestone": null,
    "labels": [
        "error-messages"
    ],
    "id": 219049495,
    "html_url": "https://github.com/spack/spack/issues/3676",
    "assignees": [],
    "comments": 4
}