{
    "body": "### Steps to reproduce the issue\n\n```console\r\n$ spack spec -I binutils+libiberty\r\nInput spec\r\n--------------------------------\r\n -   binutils+libiberty\r\n\r\nConcretized\r\n--------------------------------\r\n -   binutils@2.38%gcc@9.3.0~gas~gold~headers~interwork~ld+libiberty~lto+nls+plugins libs=shared,static arch=linux-ubuntu20.04-westmere\r\n -       ^diffutils@3.7%gcc@9.3.0 arch=linux-ubuntu20.04-westmere\r\n[+]      ^gettext@0.21%gcc@9.3.0+bzip2+curses+git~libunistring+libxml2+tar+xz arch=linux-ubuntu20.04-westmere\r\n[+]          ^bzip2@1.0.8%gcc@9.3.0~debug~pic+shared arch=linux-ubuntu20.04-westmere\r\n[+]          ^libiconv@1.16%gcc@9.3.0 libs=shared,static arch=linux-ubuntu20.04-westmere\r\n[+]          ^libxml2@2.9.12%gcc@9.3.0~python arch=linux-ubuntu20.04-westmere\r\n[+]              ^pkgconf@1.8.0%gcc@9.3.0 arch=linux-ubuntu20.04-westmere\r\n[+]              ^xz@5.2.4%gcc@9.3.0~pic libs=shared,static arch=linux-ubuntu20.04-westmere\r\n[+]              ^zlib@1.2.11%gcc@9.3.0+optimize+pic+shared arch=linux-ubuntu20.04-westmere\r\n[+]          ^ncurses@6.2%gcc@9.3.0~symlinks+termlib abi=none arch=linux-ubuntu20.04-westmere\r\n[+]          ^tar@1.34%gcc@9.3.0 arch=linux-ubuntu20.04-westmere\r\n -       ^texinfo@6.7%gcc@9.3.0 patches=12f6edb,1732115 arch=linux-ubuntu20.04-westmere\r\n```\r\nThis works with binutils@2.37 and without +libiberty\n\n### Error message\n\n<details><summary>Error message</summary><pre>\r\n==> binutils: Executing phase: 'install'\r\n==> Error: ProcessError: Command exited with status 2:\r\n    'make' '-j16' 'install'\r\n\r\n9 errors found in build log:\r\n     2983    checking for O_CLOEXEC... /bin/bash ./libtool  --tag=CC   --mode=compile /home/wspear/bin/SPACK/spack/lib/spack/env/gcc/gcc -DHAVE_CONFIG_H -I.  -I. -I. -I../bfd -I./../include -I./../bfd\r\n             -W -Wall -Wstrict-prototypes -Wmissing-prototypes -Wshadow -Wstack-usage=262144 -g -O2     -c -o mt-dis.lo mt-dis.c\r\n     2984    libtool: compile:  /home/wspear/bin/SPACK/spack/lib/spack/env/gcc/gcc -DHAVE_CONFIG_H -I. -I. -I. -I../bfd -I./../include -I./../bfd -W -Wall -Wstrict-prototypes -Wmissing-prototypes -Wshadow\r\n              -Wstack-usage=262144 -g -O2 -c mt-dis.c  -fPIC -DPIC -o .libs/mt-dis.o\r\n     2985    yes\r\n     2986    checking for makeinfo... /tmp/wspear/spack-stage/spack-stage-binutils-2.38-22wrl3df3u4mr6rmovgqi2ju4bfyw537/spack-src/missing makeinfo --split-size=5000000\r\n     2987    libtool: compile:  /home/wspear/bin/SPACK/spack/lib/spack/env/gcc/gcc -DHAVE_CONFIG_H -I. -I. -I. -I../bfd -I./../include -I./../bfd -W -Wall -Wstrict-prototypes -Wmissing-prototypes -Wshadow\r\n              -Wstack-usage=262144 -g -O2 -c mt-desc.c -o mt-desc.o >/dev/null 2>&1\r\n     2988    /tmp/wspear/spack-stage/spack-stage-binutils-2.38-22wrl3df3u4mr6rmovgqi2ju4bfyw537/spack-src/missing: 81: makeinfo: not found\r\n  >> 2989    WARNING: 'makeinfo' is missing on your system.\r\n     2990             You should only need it if you modified a '.texi' file, or\r\n     2991             any other file indirectly affecting the aspect of the manual.\r\n     2992             You might want to install the Texinfo package:\r\n     2993             <http://www.gnu.org/software/texinfo/>\r\n     2994             The spurious makeinfo call might also be the consequence of\r\n     2995             using a buggy 'make' (AIX, DU, IRIX), in which case you might\r\n\r\n     ...\r\n\r\n     3987    See any operating system documentation about shared libraries for\r\n     3988    more information, such as the ld(1) and ld.so(8) manual pages.\r\n     3989    ----------------------------------------------------------------------\r\n     3990    make[3]: Leaving directory '/tmp/wspear/spack-stage/spack-stage-binutils-2.38-22wrl3df3u4mr6rmovgqi2ju4bfyw537/spack-src/libctf'\r\n     3991    make[2]: Leaving directory '/tmp/wspear/spack-stage/spack-stage-binutils-2.38-22wrl3df3u4mr6rmovgqi2ju4bfyw537/spack-src/libctf'\r\n     3992    /usr/bin/ld: /home/wspear/bin/SPACK/spack/opt/spack/linux-ubuntu20.04-westmere/gcc-9.3.0/binutils-2.38-22wrl3df3u4mr6rmovgqi2ju4bfyw537/lib/libiberty.a(regex.o): relocation R_X86_64_PC32 agai\r\n             nst symbol `xre_max_failures' can not be used when making a shared object; recompile with -fPIC\r\n  >> 3993    /usr/bin/ld: final link failed: bad value\r\n  >> 3994    collect2: error: ld returned 1 exit status\r\n  >> 3995    libtool: install: error: relink `libopcodes.la' with the above command before installing it\r\n  >> 3996    make[4]: *** [Makefile:847: install-bfdlibLTLIBRARIES] Error 1\r\n     3997    make[4]: Leaving directory '/tmp/wspear/spack-stage/spack-stage-binutils-2.38-22wrl3df3u4mr6rmovgqi2ju4bfyw537/spack-src/opcodes'\r\n  >> 3998    make[3]: *** [Makefile:1260: install-am] Error 2\r\n     3999    make[3]: Leaving directory '/tmp/wspear/spack-stage/spack-stage-binutils-2.38-22wrl3df3u4mr6rmovgqi2ju4bfyw537/spack-src/opcodes'\r\n  >> 4000    make[2]: *** [Makefile:1148: install-recursive] Error 1\r\n     4001    make[2]: Leaving directory '/tmp/wspear/spack-stage/spack-stage-binutils-2.38-22wrl3df3u4mr6rmovgqi2ju4bfyw537/spack-src/opcodes'\r\n  >> 4002    make[1]: *** [Makefile:3609: install-opcodes] Error 2\r\n     4003    make[1]: Leaving directory '/tmp/wspear/spack-stage/spack-stage-binutils-2.38-22wrl3df3u4mr6rmovgqi2ju4bfyw537/spack-src'\r\n  >> 4004    make: *** [Makefile:2540: install] Error 2\r\n\r\nSee build log for details:\r\n  /tmp/wspear/spack-stage/spack-stage-binutils-2.38-22wrl3df3u4mr6rmovgqi2ju4bfyw537/spack-build-out.txt\r\n</pre></details>\r\n\n\n### Information on your system\n\n* **Spack:** 0.17.1-1335-b1f223d224\r\n* **Python:** 3.8.10\r\n* **Platform:** linux-ubuntu20.04-westmere\r\n* **Concretizer:** clingo\r\n\n\n### Additional information\n\n@alalazo\r\n@eugeneswalker \r\n[config.log](https://github.com/spack/spack/files/8129005/config.log)\r\n[spack-build-out.txt](https://github.com/spack/spack/files/8129006/spack-build-out.txt)\r\n[spack-build-env.txt](https://github.com/spack/spack/files/8129013/spack-build-env.txt)\r\n\r\nI tried adding\r\n`depends_on('texinfo', type='build', when='@2.37.100: +libiberty')`\r\nTo the package file under the existing depends_on(texinfo but that didn't make any difference. I may have missed something there.\n\n### General information\n\n- [X] I have run `spack debug report` and reported the version of Spack/Python/Platform\n- [X] I have run `spack maintainers <name-of-the-package>` and **@mentioned** any maintainers\n- [X] I have uploaded the build log and environment files\n- [X] I have searched the issues of this repo and believe this is not a duplicate",
    "user": "wspear",
    "url": "https://api.github.com/repos/spack/spack/issues/29168",
    "updated_at": "2022-02-24 01:51:37",
    "created_at": "2022-02-24 01:51:37",
    "closed_at": "None",
    "state": "open",
    "title": "Installation issue: binutils",
    "number": 29168,
    "milestone": null,
    "labels": [
        "build-error"
    ],
    "id": 1148769575,
    "html_url": "https://github.com/spack/spack/issues/29168",
    "assignees": [],
    "comments": 0
}