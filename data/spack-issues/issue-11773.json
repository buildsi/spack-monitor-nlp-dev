{
    "body": "### Steps to reproduce the issue\r\n\r\n```console\r\n$ spack install nettle %gcc@4.8.5\r\n...\r\n==> Error: ProcessError: Command exited with status 2:\r\n    'make' '-j80'\r\n\r\n3 errors found in build log:\r\n     643    && true\r\n     644    /opt/software/uoa/2019/spack/lib/spack/env/gcc/gcc -I.  -DHAVE_CONFIG_H -g -O2 -ggdb3 -Wno-pointer-sign -Wall -W   -Wmissing-prototypes -Wmissing-declarations -Wstrict-prototypes   -Wpointer-arith -Wbad-function-cast -Wne\r\n            sted-externs -fpic -MT dsa-sha256-sign.o -MD -MP -MF dsa-sha256-sign.o.d -c dsa-sha256-sign.c \\\r\n     645    && true\r\n     646    rsa-sign-tr.c: In function 'sec_equal':\r\n     647    /opt/software/uoa/2019/spack/lib/spack/env/gcc/gcc -I.  -DHAVE_CONFIG_H -g -O2 -ggdb3 -Wno-pointer-sign -Wall -W   -Wmissing-prototypes -Wmissing-declarations -Wstrict-prototypes   -Wpointer-arith -Wbad-function-cast -Wne\r\n            sted-externs -fpic -MT dsa-sha256-verify.o -MD -MP -MF dsa-sha256-verify.o.d -c dsa-sha256-verify.c \\\r\n     648    && true\r\n  >> 649    rsa-sign-tr.c:243:3: error: 'for' loop initial declarations are only allowed in C99 mode\r\n     650       for (size_t i = 0; i < limbs; i++)\r\n     651       ^\r\n     652    rsa-sign-tr.c:243:3: note: use option -std=c99 or -std=gnu99 to compile your code\r\n     653    /opt/software/uoa/2019/spack/lib/spack/env/gcc/gcc -I.  -DHAVE_CONFIG_H -g -O2 -ggdb3 -Wno-pointer-sign -Wall -W   -Wmissing-prototypes -Wmissing-declarations -Wstrict-prototypes   -Wpointer-arith -Wbad-function-cast -Wne\r\n            sted-externs -fpic -MT dsa2sexp.o -MD -MP -MF dsa2sexp.o.d -c dsa2sexp.c \\\r\n     654    && true\r\n     655    /opt/software/uoa/2019/spack/lib/spack/env/gcc/gcc -I.  -DHAVE_CONFIG_H -g -O2 -ggdb3 -Wno-pointer-sign -Wall -W   -Wmissing-prototypes -Wmissing-declarations -Wstrict-prototypes   -Wpointer-arith -Wbad-function-cast -Wne\r\n            sted-externs -fpic -MT sexp2dsa.o -MD -MP -MF sexp2dsa.o.d -c sexp2dsa.c \\\r\n     656    && true\r\n  >> 657    make[1]: *** [rsa-sign-tr.o] Error 1\r\n     658    make[1]: *** Waiting for unfinished jobs....\r\n     659    make[1]: Leaving directory `/tmp/root/spack-stage/spack-stage-sHHgXL/nettle-3.4.1'\r\n  >> 660    make: *** [all] Error 2\r\n\r\n```\r\n\r\n### Platform and user environment\r\n\r\nPlease report your OS here:\r\n```commandline\r\n$ uname -a \r\nLinux maxlogin2 3.10.0-957.10.1.el7.x86_64 #1 SMP Mon Mar 18 15:06:45 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux\r\n``` \r\n\r\n### Additional information\r\n\r\nMy target application is CP2K using Nettle as a dependency.\r\n\r\n```console\r\n$ ./spack spec --install-status nettle %gcc@4.8.5\r\nInput spec\r\n--------------------------------\r\n -   nettle%gcc@4.8.5\r\n\r\nConcretized\r\n--------------------------------\r\n -   nettle@3.4.1%gcc@4.8.5 arch=linux-centos7-x86_64\r\n[+]      ^gmp@6.1.2%gcc@4.8.5 arch=linux-centos7-x86_64\r\n[+]          ^autoconf@2.69%gcc@4.8.5 arch=linux-centos7-x86_64\r\n[+]              ^m4@1.4.18%gcc@4.8.5 patches=3877ab548f88597ab2327a2230ee048d2d07ace1062efe81fc92e91b7f39cd00,c0a408fbffb7255fcc75e26bd8edab116fc81d216bfd18b473668b7739a4158e,fc9b61654a3ba1a8d6cd78ce087e7c96366c290bc8d2c299f09828d793b853c8 +sigsegv arch=linux-centos7-x86_64\r\n[+]                  ^libsigsegv@2.11%gcc@4.8.5 arch=linux-centos7-x86_64\r\n[+]              ^perl@5.26.2%gcc@4.8.5+cpanm patches=0eac10ed90aeb0459ad8851f88081d439a4e41978e586ec743069e8b059370ac +shared+threads arch=linux-centos7-x86_64\r\n[+]                  ^gdbm@1.18.1%gcc@4.8.5 arch=linux-centos7-x86_64\r\n[+]                      ^readline@7.0%gcc@4.8.5 arch=linux-centos7-x86_64\r\n[+]                          ^ncurses@6.1%gcc@4.8.5~symlinks~termlib arch=linux-centos7-x86_64\r\n[+]                              ^pkgconf@1.6.0%gcc@4.8.5 arch=linux-centos7-x86_64\r\n[+]          ^automake@1.16.1%gcc@4.8.5 arch=linux-centos7-x86_64\r\n[+]          ^libtool@2.4.6%gcc@4.8.5 arch=linux-centos7-x86_64\r\n\r\n```\r\n\r\nYou might want to run this command on the `config.log` or any other similar file\r\nfound in the stage directory: \r\n```console\r\n./spack location -s nettle\r\n/opt/software/uoa/2019/spack/var/spack/stage/nettle-3.4.1-dzgj2ckkldnwi4e23k6s6zmbanbucbm3\r\n```\r\n\r\n```console\r\n$ ./spack -d install -j 1 nettle\r\n...\r\n==> [2019-06-18-09:43:00.288740] Error: ProcessError: Command exited with status 2:\r\n    'make'\r\n\r\n3 errors found in build log:\r\n     565    && true\r\n     566    /opt/software/uoa/2019/spack/lib/spack/env/gcc/gcc -I.  -DHAVE_CONFIG_H -g -O2 -ggdb3 -Wno-pointer-sign -Wall -W   -Wmissing-prototypes -Wmissing-declarations -Wstrict-prototypes   -Wpointer-arith -Wbad-function-cast -Wne\r\n            sted-externs -fpic -MT rsa-sign.o -MD -MP -MF rsa-sign.o.d -c rsa-sign.c \\\r\n     567    && true\r\n     568    /opt/software/uoa/2019/spack/lib/spack/env/gcc/gcc -I.  -DHAVE_CONFIG_H -g -O2 -ggdb3 -Wno-pointer-sign -Wall -W   -Wmissing-prototypes -Wmissing-declarations -Wstrict-prototypes   -Wpointer-arith -Wbad-function-cast -Wne\r\n            sted-externs -fpic -MT rsa-sign-tr.o -MD -MP -MF rsa-sign-tr.o.d -c rsa-sign-tr.c \\\r\n     569    && true\r\n     570    rsa-sign-tr.c: In function 'sec_equal':\r\n  >> 571    rsa-sign-tr.c:243:3: error: 'for' loop initial declarations are only allowed in C99 mode\r\n     572       for (size_t i = 0; i < limbs; i++)\r\n     573       ^\r\n     574    rsa-sign-tr.c:243:3: note: use option -std=c99 or -std=gnu99 to compile your code\r\n  >> 575    make[1]: *** [rsa-sign-tr.o] Error 1\r\n     576    make[1]: Leaving directory `/tmp/root/spack-stage/spack-stage-4Jz1N8/nettle-3.4.1'\r\n  >> 577    make: *** [all] Error 2\r\n\r\nSee build log for details:\r\n  /opt/software/uoa/2019/spack/var/spack/stage/nettle-3.4.1-dzgj2ckkldnwi4e23k6s6zmbanbucbm3/spack-build.out\r\nTraceback (most recent call last):\r\n  File \"/opt/software/uoa/2019/spack/lib/spack/spack/build_environment.py\", line 765, in child_process\r\n    return_value = function()\r\n  File \"/opt/software/uoa/2019/spack/lib/spack/spack/package.py\", line 1567, in build_process\r\n    phase(self.spec, self.prefix)\r\n  File \"/opt/software/uoa/2019/spack/lib/spack/spack/package.py\", line 99, in phase_wrapper\r\n    phase(spec, prefix)\r\n  File \"/opt/software/uoa/2019/spack/lib/spack/spack/build_systems/autotools.py\", line 263, in build\r\n    inspect.getmodule(self).make(*self.build_targets)\r\n  File \"/opt/software/uoa/2019/spack/lib/spack/spack/build_environment.py\", line 131, in __call__\r\n    return super(MakeExecutable, self).__call__(*args, **kwargs)\r\n  File \"/opt/software/uoa/2019/spack/lib/spack/spack/util/executable.py\", line 189, in __call__\r\n    proc.returncode, long_msg)\r\nProcessError: Command exited with status 2:\r\n    'make'\r\n```",
    "user": "ocfmatt",
    "url": "https://api.github.com/repos/spack/spack/issues/11773",
    "updated_at": "2019-07-03 01:07:46",
    "created_at": "2019-06-18 08:50:45",
    "closed_at": "2019-07-03 01:07:35",
    "state": "closed",
    "title": "Installation issue: Nettle",
    "number": 11773,
    "milestone": null,
    "labels": [
        "build-error"
    ],
    "id": 457341821,
    "html_url": "https://github.com/spack/spack/issues/11773",
    "assignees": [
        "scheibelp"
    ],
    "comments": 7
}