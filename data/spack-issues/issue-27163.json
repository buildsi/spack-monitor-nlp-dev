{
    "body": "### Steps to reproduce the issue\r\n\r\n`mpix-launch-swift@develop` build fails using:\r\n* `spack@develop` (b3711c0d9d07b8b0e673adc49f5742d90cf48a12 from `Tue Nov 2 10:55:50 2021 -0700`)\r\n* Ubuntu 20.04, GCC 9.3.0, x86_64 (shown here)\r\n\r\nConcrete spec: [mpix-launch-swift.spec.yaml.txt](https://github.com/spack/spack/files/7463142/mpix-launch-swift.spec.yaml.txt)\r\n \r\nConcretization:\r\n```\r\nInput spec\r\n--------------------------------\r\n -   mpix-launch-swift@develop%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n\r\nConcretized\r\n--------------------------------\r\n -   mpix-launch-swift@develop%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n[+]      ^mpich@3.4.2%gcc@9.3.0~argobots+fortran+hwloc+hydra+libxml2+pci+romio~slurm~verbs~wrapperrpath device=ch4 netmod=ofi pmi=pmi arch=linux-ubuntu20.04-x86_64\r\n[+]          ^findutils@4.8.0%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n[+]          ^hwloc@2.5.0%gcc@9.3.0~cairo~cuda~gl~libudev+libxml2~netloc~nvml~opencl+pci~rocm+shared arch=linux-ubuntu20.04-x86_64\r\n[+]              ^libpciaccess@0.16%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n[+]                  ^libtool@2.4.6%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n[+]                      ^m4@1.4.19%gcc@9.3.0+sigsegv patches=9dc5fbd0d5cb1037ab1e6d0ecc74a30df218d0a94bdd5a02759a97f62daca573,bfdffa7c2eb01021d5849b36972c069693654ad826c1a20b53534009a4ec7a89 arch=linux-ubuntu20.04-x86_64\r\n[+]                          ^libsigsegv@2.13%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n[+]                  ^pkgconf@1.8.0%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n[+]                  ^util-macros@1.19.3%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n[+]              ^libxml2@2.9.12%gcc@9.3.0~python arch=linux-ubuntu20.04-x86_64\r\n[+]                  ^libiconv@1.16%gcc@9.3.0 libs=shared,static arch=linux-ubuntu20.04-x86_64\r\n[+]                  ^xz@5.2.5%gcc@9.3.0+pic libs=shared,static arch=linux-ubuntu20.04-x86_64\r\n[+]                  ^zlib@1.2.11%gcc@9.3.0+optimize+pic+shared arch=linux-ubuntu20.04-x86_64\r\n[+]              ^ncurses@6.2%gcc@9.3.0~symlinks+termlib abi=none arch=linux-ubuntu20.04-x86_64\r\n[+]          ^libfabric@1.13.1%gcc@9.3.0~debug~kdreg fabrics=rxm,sockets,tcp,udp arch=linux-ubuntu20.04-x86_64\r\n[+]      ^stc@0.9.0%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n[+]          ^ant@1.10.7%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n[+]              ^openjdk@11.0.12_7%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n[+]          ^autoconf@2.69%gcc@9.3.0 patches=35c449281546376449766f92d49fc121ca50e330e60fefcfc9be2af3253082c2,7793209b33013dc0f81208718c68440c5aae80e7a1c4b8d336e382525af791a7,a49dd5bac3b62daa0ff688ab4d508d71dbd2f4f8d7e2a02321926346161bf3ee arch=linux-ubuntu20.04-x86_64\r\n[+]              ^perl@5.34.0%gcc@9.3.0+cpanm+shared+threads arch=linux-ubuntu20.04-x86_64\r\n[+]                  ^berkeley-db@18.1.40%gcc@9.3.0+cxx~docs+stl patches=b231fcc4d5cff05e5c3a4814f6a5af0e9a966428dc2176540d2c05aff41de522 arch=linux-ubuntu20.04-x86_64\r\n[+]                  ^bzip2@1.0.8%gcc@9.3.0~debug~pic+shared arch=linux-ubuntu20.04-x86_64\r\n[+]                      ^diffutils@3.8%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n[+]                  ^gdbm@1.19%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n[+]                      ^readline@8.1%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n[+]          ^automake@1.16.3%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n[+]          ^turbine@1.3.0%gcc@9.3.0~hdf5~python~r arch=linux-ubuntu20.04-x86_64\r\n[+]              ^adlbx@1.0.0%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n[+]                  ^exmcutils@0.6.0%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n[+]              ^swig@4.0.2%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n[+]                  ^pcre@8.44%gcc@9.3.0~jit+multibyte+utf arch=linux-ubuntu20.04-x86_64\r\n[+]              ^tcl@8.6.11%gcc@9.3.0 arch=linux-ubuntu20.04-x86_64\r\n[+]              ^zsh@5.8%gcc@9.3.0+skip-tcsetpgrp-test arch=linux-ubuntu20.04-x86_64\r\n```\r\n\r\nReproduced here using Docker container image `ecpe4s/ubuntu20.04-runner-x86_64:2021-11-01`\r\n```\r\n$> spack mirror add E4S https://cache.e4s.io\r\n$> spack buildcache keys -it\r\n\r\n$> spack install --cache-only --only dependencies --include-build-deps -f ./mpix-launch-swift.spec.yaml\r\n\r\n$> spack install --no-cache -f ./mpix-launch-swift.spec.yaml\r\n...\r\n==> Installing mpix-launch-swift-develop-ionfjuu3l3kmea3nubygleuxyv6muswu\r\n==> Warning: Missing a source id for mpix-launch-swift@develop\r\n==> No patches needed for mpix-launch-swift\r\n==> mpix-launch-swift: Executing phase: 'edit'\r\n==> mpix-launch-swift: Executing phase: 'build'\r\n==> Error: ProcessError: Command exited with status 2:\r\n    'make' '-j16'\r\n\r\n2 warnings found in build log:\r\n     19    mpicc -fPIC -Isrc   -c -o src/MPIX_Comm_launch.o src/MPIX_Comm_launch.c\r\n     20    mpicc -fPIC -Isrc   -c -o example/child.o example/child.c\r\n     21    mpicc -g -o example/child example/child.o -fPIC\r\n     22    mpicc -g -o example/parent example/parent.o src/MPIX_Comm_launch.o -fPIC\r\n     23    make[1]: Leaving directory '/tmp/root/spack-stage/spack-stage-mpix-launch-swift-develop-ionfjuu3l3kmea3nubygleuxyv6muswu/spack-src/mpix_launch'\r\n     24    cd src && CFLAGS=-std=c99 bash build.sh\r\n  >> 25    make[1]: warning: jobserver unavailable: using -j1.  Add '+' to parent make rule.\r\n     26    make[1]: Entering directory '/tmp/root/spack-stage/spack-stage-mpix-launch-swift-develop-ionfjuu3l3kmea3nubygleuxyv6muswu/spack-src/mpix_launch'\r\n     27    make[1]: Nothing to be done for 'all'.\r\n     28    make[1]: Leaving directory '/tmp/root/spack-stage/spack-stage-mpix-launch-swift-develop-ionfjuu3l3kmea3nubygleuxyv6muswu/spack-src/mpix_launch'\r\n  >> 29    make[1]: warning: jobserver unavailable: using -j1.  Add '+' to parent make rule.\r\n     30    make[1]: Entering directory '/tmp/root/spack-stage/spack-stage-mpix-launch-swift-develop-ionfjuu3l3kmea3nubygleuxyv6muswu/spack-src/src'\r\n     31    swig -I./include launch.i\r\n     32    No target language specified.\r\n     33    Use 'swig -help' for more information.\r\n     34    make[1]: *** [Makefile:11: launch_wrap.c] Error 1\r\n     35    make[1]: Leaving directory '/tmp/root/spack-stage/spack-stage-mpix-launch-swift-develop-ionfjuu3l3kmea3nubygleuxyv6muswu/spack-src/src'\r\n```\r\n\r\nFrom the spack-build-out.txt (attached below):\r\n```\r\n$> head spack-build-out.txt\r\n==> mpix-launch-swift: Executing phase: 'edit'\r\n==> [2021-11-02-11:09:19.352360] Using default implementation: skipping edit phase.\r\n==> mpix-launch-swift: Executing phase: 'build'\r\n==> [2021-11-02-11:09:19.363276] 'make' '-j16'\r\n/bin/sh: 1: Syntax error: end of file unexpected (expecting \")\")\r\n\r\ngit submodule update --init --recursive\r\nSubmodule 'mpix_launch' (https://bitbucket.org/mdorier/mpix_launch.git) registered for path 'mpix_launch'\r\nCloning into '/tmp/root/spack-stage/spack-stage-mpix-launch-swift-develop-ionfjuu3l3kmea3nubygleuxyv6muswu/spack-src/mpix_launch'...\r\nSubmodule path 'mpix_launch': checked out '713f0ce846037cdaf6e34ea4a0cbb37574b60968'\r\n...\r\n```\r\n\r\nI'm seeing the same issue on:\r\n* Ubuntu 18.04, GCC 7.5.0, x86_64 and ppc64le\r\n* Ubuntu 20.04, GCC 9.3.0, x86_64 and ppc64le\r\n\r\n### Information on your system\r\n\r\n* **Spack:** 0.16.3-5205-b3711c0d9d\r\n* **Python:** 3.8.10\r\n* **Platform:** linux-ubuntu20.04-cascadelake\r\n* **Concretizer:** clingo\r\n\r\n### Additional information\r\n\r\n[spack-build-out.txt](https://github.com/spack/spack/files/7463114/spack-build-out.txt)\r\n[spack-build-env.txt](https://github.com/spack/spack/files/7463115/spack-build-env.txt)\r\n\r\n@kshitij-v-mehta\r\n@andre-merzky\r\n\r\n### General information\r\n\r\n- [X] I have run `spack debug report` and reported the version of Spack/Python/Platform\r\n- [X] I have run `spack maintainers <name-of-the-package>` and **@mentioned** any maintainers\r\n- [X] I have uploaded the build log and environment files\r\n- [X] I have searched the issues of this repo and believe this is not a duplicate",
    "user": "eugeneswalker",
    "url": "https://api.github.com/repos/spack/spack/issues/27163",
    "updated_at": "2021-11-02 18:22:52",
    "created_at": "2021-11-02 18:22:21",
    "closed_at": "None",
    "state": "open",
    "title": "mpix-launch-swift build fails: syntax error: end of file unexpected (expecting \")\")",
    "number": 27163,
    "milestone": null,
    "labels": [
        "build-error",
        "e4s"
    ],
    "id": 1042677787,
    "html_url": "https://github.com/spack/spack/issues/27163",
    "assignees": [],
    "comments": 0
}