{
    "body": "### Steps to reproduce the issue\r\n\r\n```console\r\n$ spack spec -I superlu-dist %cce@13.0.1 ^cray-mpich@7.7.18 ^netlib-lapack %cce@13.0.1 ^cmake@3.22.2%gcc@7.5.0\r\n\r\nInput spec\r\n--------------------------------\r\n -   superlu-dist%cce@13.0.1\r\n -       ^cmake@3.22.2%gcc@7.5.0\r\n -       ^cray-mpich@7.7.18\r\n -       ^netlib-lapack%cce@13.0.1\r\n\r\nConcretized\r\n--------------------------------\r\n -   superlu-dist@7.2.0%cce@13.0.1~cuda~int64~ipo~openmp~rocm+shared build_type=Release patches=8da9e21 arch=cray-cnl7-haswell\r\n[+]      ^cmake@3.22.2%gcc@7.5.0~doc+ncurses+openssl+ownlibs~qt build_type=Release arch=cray-cnl7-haswell\r\n[+]          ^ncurses@6.2%gcc@7.5.0~symlinks+termlib abi=none arch=cray-cnl7-haswell\r\n -               ^pkg-config@0.29.2%gcc@7.5.0+internal_glib arch=cray-cnl7-haswell\r\n[+]          ^openssl@1.1.1m%gcc@7.5.0~docs certs=system arch=cray-cnl7-haswell\r\n[+]              ^perl@5.34.0%gcc@7.5.0+cpanm+shared+threads arch=cray-cnl7-haswell\r\n[+]                  ^berkeley-db@18.1.40%gcc@7.5.0+cxx~docs+stl patches=b231fcc arch=cray-cnl7-haswell\r\n[+]                  ^bzip2@1.0.8%gcc@7.5.0~debug~pic+shared arch=cray-cnl7-haswell\r\n -                       ^diffutils@3.6%gcc@7.5.0 arch=cray-cnl7-haswell\r\n[+]                  ^gdbm@1.19%gcc@7.5.0 arch=cray-cnl7-haswell\r\n[+]                      ^readline@8.1%gcc@7.5.0 arch=cray-cnl7-haswell\r\n[+]                  ^zlib@1.2.11%gcc@7.5.0+optimize+pic+shared arch=cray-cnl7-haswell\r\n[+]      ^cray-mpich@7.7.18%cce@13.0.1 arch=cray-cnl7-haswell\r\n[+]      ^metis@5.1.0%cce@13.0.1~gdb~int64~real64+shared build_type=Release patches=4991da9 arch=cray-cnl7-haswell\r\n[+]      ^netlib-lapack@3.9.1%cce@13.0.1~external-blas~ipo+lapacke+shared~xblas build_type=Release patches=8bde92b arch=cray-cnl7-haswell\r\n[+]      ^parmetis@4.0.3%cce@13.0.1~gdb~int64~ipo+shared build_type=Release patches=4f89253,50ed208,704b84f arch=cray-cnl7-haswell\r\n```\r\n\r\n### Error message\r\n\r\n<details><summary>Error message</summary><pre>\r\n[ 89%] Linking C executable pddrive3d\r\ncd /tmp/$user/spack-stage/spack-stage-superlu-dist-7.2.0-o42xqpat3daktcbw3dfsahqe7lg3g3ba/spack-build-o42xqpa/EXAMPLE && /usr/projects/user_contrib/spack.20220303/opt/spack/cray-cnl7-haswell/gcc-7.5.0/cmake-3.22.2-lcuvt25/bin/cmake -E cmake_link_script CMakeFiles/pddrive3d.dir/link.txt --verbose=1\r\n/usr/projects/user_contrib/spack.20220303/lib/spack/env/cce/cc -I/usr/projects/user_contrib/spack.20220303/opt/spack/cray-cnl7-haswell/cce-13.0.1/metis-5.1.0-cx6bl63/include -I/usr/projects/user_contrib/spack.20220303/opt/spack/cray-cnl7-haswell/cce-13.0.1/parmetis-4.0.3-czqvsg3/include -DUSE_VENDOR_BLAS  -std=c99 -O3 -DNDEBUG  -Wl,-rpath,/usr/projects/user_contrib/spack.20220303/opt/spack/cray-cnl7-haswell/cce-13.0.1/superlu-dist-7.2.0-o42xqpa/SRC   -Wl,-rpath,/usr/projects/user_contrib/spack.20220303/opt/spack/cray-cnl7-haswell/cce-13.0.1/superlu-dist-7.2.0-o42xqpa//usr/projects/user_contrib/spack.20220303/opt/spack/cray-cnl7-haswell/cce-13.0.1/superlu-dist-7.2.0-o42xqpa/lib CMakeFiles/pddrive3d.dir/pddrive3d.c.o CMakeFiles/pddrive3d.dir/dcreate_matrix.c.o CMakeFiles/pddrive3d.dir/dcreate_matrix3d.c.o -o pddrive3d  -Wl,-rpath,/tmp/$user/spack-stage/spack-stage-superlu-dist-7.2.0-o42xqpat3daktcbw3dfsahqe7lg3g3ba/spack-build-o42xqpa/SRC:/usr/projects/user_contrib/spack.20220303/opt/spack/cray-cnl7-haswell/cce-13.0.1/netlib-lapack-3.9.1-sv2kk43/lib64: ../SRC/libsuperlu_dist.so.7.2.0 /usr/projects/user_contrib/spack.20220303/opt/spack/cray-cnl7-haswell/cce-13.0.1/netlib-lapack-3.9.1-sv2kk43/lib64/libblas.so -lm -L/usr/projects/user_contrib/spack.20220303/opt/spack/cray-cnl7-haswell/cce-13.0.1/parmetis-4.0.3-czqvsg3/lib -lparmetis -L/usr/projects/user_contrib/spack.20220303/opt/spack/cray-cnl7-haswell/cce-13.0.1/metis-5.1.0-cx6bl63/lib -lmetis \r\nld.lld: error: /usr/projects/user_contrib/spack.20220303/opt/spack/cray-cnl7-haswell/cce-13.0.1/netlib-lapack-3.9.1-sv2kk43/lib64/libblas.so: undefined reference to _isamax_ [--no-allow-shlib-undefined]\r\nld.lld: error: /usr/projects/user_contrib/spack.20220303/opt/spack/cray-cnl7-haswell/cce-13.0.1/netlib-lapack-3.9.1-sv2kk43/lib64/libblas.so: undefined reference to _idamax_ [--no-allow-shlib-undefined]\r\nclang-13: error: linker command failed with exit code 1 (use -v to see invocation)\r\nmake[2]: *** [EXAMPLE/CMakeFiles/pddrive3d2.dir/build.make:134: EXAMPLE/pddrive3d2] Error 1\r\n</pre></details>\r\n\r\n### Information on your system\r\n\r\n```console\r\n$ spack debug report\r\n\r\n* **Spack:** 0.17.1-1423-e2b87ade06\r\n* **Python:** 3.6.13\r\n* **Platform:** cray-sles15-haswell\r\n* **Concretizer:** clingo\r\n```\r\n\r\n### Additional information\r\n\r\n<details><summary>CMake command and output</summary><pre>\r\n==> superlu-dist: Executing phase: 'cmake'\r\n==> [2022-03-11-11:42:27.392233] Module name: cce/13.0.1\r\n==> [2022-03-11-11:42:27.392407] Package directory variable prefix: CCE\r\n==> [2022-03-11-11:42:27.404783] 'cmake' '-G' 'Unix Makefiles' '-DCMAKE_INSTALL_PREFIX:STRING=/usr/projects/user_contrib/spack.20220303/opt/spack/cray-cnl7-haswell/cce-13.0.1/superlu-dist-7.2.0-o42xqpa' '-DCMAKE_BUILD_TYPE:STRING=Release' '-DCMAKE_INTERPROCEDURAL_OPTIMIZATION:BOOL=OFF' '-DCMAKE_VERBOSE_MAKEFILE:BOOL=ON' '-DCMAKE_INSTALL_RPATH_USE_LINK_PATH:BOOL=OFF' '-DCMAKE_INSTALL_RPATH:STRING=/usr/projects/user_contrib/spack.20220303/opt/spack/cray-cnl7-haswell/cce-13.0.1/superlu-dist-7.2.0-o42xqpa/lib;/usr/projects/user_contrib/spack.20220303/opt/spack/cray-cnl7-haswell/cce-13.0.1/superlu-dist-7.2.0-o42xqpa/lib64;/opt/cray/pe/mpt/7.7.18/gni/mpich-crayclang/10.0/lib;/usr/projects/user_contrib/spack.20220303/opt/spack/cray-cnl7-haswell/cce-13.0.1/metis-5.1.0-cx6bl63/lib;/usr/projects/user_contrib/spack.20220303/opt/spack/cray-cnl7-haswell/cce-13.0.1/parmetis-4.0.3-czqvsg3/lib;/usr/projects/user_contrib/spack.20220303/opt/spack/cray-cnl7-haswell/cce-13.0.1/netlib-lapack-3.9.1-sv2kk43/lib64;/opt/cray/pe/cce/13.0.1' '-DCMAKE_PREFIX_PATH:STRING=/usr/projects/user_contrib/spack.20220303/opt/spack/cray-cnl7-haswell/cce-13.0.1/parmetis-4.0.3-czqvsg3;/usr/projects/user_contrib/spack.20220303/opt/spack/cray-cnl7-haswell/cce-13.0.1/netlib-lapack-3.9.1-sv2kk43;/usr/projects/user_contrib/spack.20220303/opt/spack/cray-cnl7-haswell/cce-13.0.1/metis-5.1.0-cx6bl63;/usr/projects/user_contrib/spack.20220303/opt/spack/cray-cnl7-haswell/gcc-7.5.0/cmake-3.22.2-lcuvt25;/opt/cray/pe/mpt/7.7.18/gni/mpich-crayclang/10.0' '-DCMAKE_C_FLAGS=-std=c99' '-DCMAKE_CXX_FLAGS=-std=c++11' '-DCMAKE_C_COMPILER:STRING=/usr/projects/user_contrib/spack.20220303/lib/spack/env/cce/cc' '-DCMAKE_CXX_COMPILER:STRING=/usr/projects/user_contrib/spack.20220303/lib/spack/env/cce/case-insensitive/CC' '-DCMAKE_INSTALL_LIBDIR:STRING:STRING=/usr/projects/user_contrib/spack.20220303/opt/spack/cray-cnl7-haswell/cce-13.0.1/superlu-dist-7.2.0-o42xqpa/lib' '-DCMAKE_INSTALL_BINDIR:STRING:STRING=/usr/projects/user_contrib/spack.20220303/opt/spack/cray-cnl7-haswell/cce-13.0.1/superlu-dist-7.2.0-o42xqpa/bin' '-DTPL_BLAS_LIBRARIES:STRING=/usr/projects/user_contrib/spack.20220303/opt/spack/cray-cnl7-haswell/cce-13.0.1/netlib-lapack-3.9.1-sv2kk43/lib64/libblas.so' '-DTPL_LAPACK_LIBRARIES:STRING=/usr/projects/user_contrib/spack.20220303/opt/spack/cray-cnl7-haswell/cce-13.0.1/netlib-lapack-3.9.1-sv2kk43/lib64/liblapack.so' '-DUSE_XSDK_DEFAULTS:BOOL=ON' '-DTPL_PARMETIS_LIBRARIES:STRING=-L/usr/projects/user_contrib/spack.20220303/opt/spack/cray-cnl7-haswell/cce-13.0.1/parmetis-4.0.3-czqvsg3/lib -lparmetis;-L/usr/projects/user_contrib/spack.20220303/opt/spack/cray-cnl7-haswell/cce-13.0.1/metis-5.1.0-cx6bl63/lib -lmetis' '-DTPL_PARMETIS_INCLUDE_DIRS:STRING=/usr/projects/user_contrib/spack.20220303/opt/spack/cray-cnl7-haswell/cce-13.0.1/parmetis-4.0.3-czqvsg3/include;/usr/projects/user_contrib/spack.20220303/opt/spack/cray-cnl7-haswell/cce-13.0.1/metis-5.1.0-cx6bl63/include' '-DXSDK_INDEX_SIZE:STRING=32' '-Denable_openmp:BOOL=OFF' '-DCMAKE_DISABLE_FIND_PACKAGE_OpenMP:BOOL=ON' '-DBUILD_SHARED_LIBS:BOOL=ON' '/tmp/$user/spack-stage/spack-stage-superlu-dist-7.2.0-o42xqpat3daktcbw3dfsahqe7lg3g3ba/spack-src'\r\n-- The C compiler identification is Clang 13.0.1\r\n-- The CXX compiler identification is Clang 13.0.1\r\n-- Cray Programming Environment 2.7.10 C\r\n-- Detecting C compiler ABI info\r\n-- Detecting C compiler ABI info - done\r\n-- Check for working C compiler: /usr/projects/user_contrib/spack.20220303/lib/spack/env/cce/cc - skipped\r\n-- Detecting C compile features\r\n-- Detecting C compile features - done\r\n-- Cray Programming Environment 2.7.10 CXX\r\n-- Detecting CXX compiler ABI info\r\n-- Detecting CXX compiler ABI info - done\r\n-- Check for working CXX compiler: /usr/projects/user_contrib/spack.20220303/lib/spack/env/cce/case-insensitive/CC - skipped\r\n-- Detecting CXX compile features\r\n-- Detecting CXX compile features - done\r\n-- The Fortran compiler identification is Cray 13.0.1\r\n-- Cray Programming Environment 2.7.10 Fortran\r\n-- Detecting Fortran compiler ABI info\r\n-- Detecting Fortran compiler ABI info - done\r\n-- Check for working Fortran compiler: /usr/projects/user_contrib/spack.20220303/lib/spack/env/cce/ftn - skipped\r\n-- SuperLU_DIST will be built as a shared library.\r\n-- SuperLU_DIST will also be built as a static library.\r\n-- Found MPI_C: /usr/projects/user_contrib/spack.20220303/lib/spack/env/cce/cc (found version \"3.1\") \r\n-- Found MPI_CXX: /usr/projects/user_contrib/spack.20220303/lib/spack/env/cce/case-insensitive/CC (found version \"3.1\") \r\n-- Found MPI_Fortran: /usr/projects/user_contrib/spack.20220303/lib/spack/env/cce/ftn (found version \"3.1\") \r\n-- Found MPI: TRUE (found version \"3.1\")  \r\n-- Using TPL_BLAS_LIBRARIES='/usr/projects/user_contrib/spack.20220303/opt/spack/cray-cnl7-haswell/cce-13.0.1/netlib-lapack-3.9.1-sv2kk43/lib64/libblas.so'\r\n-- Will not link with LAPACK.\r\n-- Enabled support for PARMETIS.\r\n-- EXTRA_LIB_EXPORT='-l-l:libunwind.so -lc -l-l:libunwind.so -lm -latomic -lpthread -lcsup -lu -lf -lcraymath -lfi -lmodules -lquadmath -lpgas-dmapp -lstdc++ -lmpich_crayclang -lrca -lhugetlbfs -lAtpSigHandler '\r\n-- EXTRA_FLIB_EXPORT=' -lAtpSigHandler -lhugetlbfs -lrca -lmpich_crayclang -lmpichf90_crayclang -lstdc++ -lpgas-dmapp -lquadmath -lmodules -lfi -lcraymath -lf -lu -lcsup -lgfortran -lstdc++ -lpthread -lc -lcsup -lm -lclang_rt.craypgo-x86_64 -lgcc -lclang_rt.builtins-x86_64'\r\n-- superlu_dist_fortran will be built as a dynamic library.\r\n-- Will not link with CombBLAS.\r\n-- Detecting Fortran/C Interface\r\n-- Detecting Fortran/C Interface - Found GLOBAL but not MODULE mangling\r\n-- Verifying Fortran/CXX Compiler Compatibility\r\n-- Verifying Fortran/CXX Compiler Compatibility - Success\r\n-- Configuring done\r\n-- Generating done\r\nCMake Warning:\r\n  Manually-specified variables were not used by the project:\r\n\r\n    CMAKE_DISABLE_FIND_PACKAGE_OpenMP\r\n    TPL_LAPACK_LIBRARIES\r\n\r\n-- Build files have been written to: /tmp/$user/spack-stage/spack-stage-superlu-dist-7.2.0-o42xqpat3daktcbw3dfsahqe7lg3g3ba/spack-build-o42xqpa\r\n</pre></details>\r\n\r\ncc'ing maintainers :  @xiaoye @gchavez2 @balay @pghysels @liuyangzhuan\r\n\r\nI didn't upload the build and environment logs because of company policy.  I can certainly provide excerpts (after review) if they are useful.\r\n\r\n\r\n### General information\r\n\r\n- [X] I have run `spack debug report` and reported the version of Spack/Python/Platform\r\n- [X] I have run `spack maintainers <name-of-the-package>` and **@mentioned** any maintainers\r\n- [X] I have uploaded the build log and environment files\r\n- [X] I have searched the issues of this repo and believe this is not a duplicate",
    "user": "KineticTheory",
    "url": "https://api.github.com/repos/spack/spack/issues/29466",
    "updated_at": "2022-03-12 00:56:23",
    "created_at": "2022-03-11 18:14:35",
    "closed_at": "None",
    "state": "open",
    "title": "Installation issue: superlu-dist@7.2.0 %cce@13.0.1",
    "number": 29466,
    "milestone": null,
    "labels": [
        "build-error"
    ],
    "id": 1166716859,
    "html_url": "https://github.com/spack/spack/issues/29466",
    "assignees": [],
    "comments": 9
}