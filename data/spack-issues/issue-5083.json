{
    "body": "fixes #4965\r\n\r\nUsers can now add an optional custom message to the conflicts directive. Layout on screen has been changed to improve readability and the long spec is shown in tree format. Two conflicts in `espresso` have been modified to showcase the feature.\r\n\r\nIn the current branch the error message is:\r\n```console\r\n$ spack spec espresso+scalapack~mpi\r\nInput spec\r\n--------------------------------\r\nespresso~mpi+scalapack\r\n\r\nNormalized\r\n--------------------------------\r\nespresso~mpi+scalapack\r\n    ^blas\r\n    ^fftw~mpi\r\n    ^lapack\r\n\r\nConcretized\r\n--------------------------------\r\n==> Error: Conflicts in concretized spec \"espresso@6.1.0%gcc@4.8+elpa~hdf5~mpi~openmp+scalapack arch=linux-ubuntu14-x86_64 /bzaylez\"\r\n\r\nList of matching conflicts for spec:\r\n\r\n    espresso@6.1.0%gcc@4.8+elpa~hdf5~mpi~openmp+scalapack arch=linux-ubuntu14-x86_64 \r\n        ^elpa@2016.05.004%gcc@4.8~openmp arch=linux-ubuntu14-x86_64 \r\n            ^netlib-scalapack@2.0.2%gcc@4.8 build_type=RelWithDebInfo ~pic+shared arch=linux-ubuntu14-x86_64 \r\n                ^cmake@3.9.0%gcc@4.8~doc+ncurses+openssl+ownlibs~qt arch=linux-ubuntu14-x86_64 \r\n                    ^ncurses@6.0%gcc@4.8~symlinks arch=linux-ubuntu14-x86_64 \r\n                        ^pkg-config@0.29.2%gcc@4.8+internal_glib arch=linux-ubuntu14-x86_64 \r\n                    ^openssl@1.0.2k%gcc@4.8 arch=linux-ubuntu14-x86_64 \r\n                        ^zlib@1.2.11%gcc@4.8+pic+shared arch=linux-ubuntu14-x86_64 \r\n                ^openblas@0.2.20%gcc@4.8~openmp+pic+shared arch=linux-ubuntu14-x86_64 \r\n                ^openmpi@2.1.1%gcc@4.8~cuda fabrics= ~java schedulers= ~sqlite3~thread_multiple+vt arch=linux-ubuntu14-x86_64 \r\n                    ^hwloc@1.11.7%gcc@4.8~cuda+libxml2+pci arch=linux-ubuntu14-x86_64 \r\n                        ^libpciaccess@0.13.5%gcc@4.8 arch=linux-ubuntu14-x86_64 \r\n                            ^libtool@2.4.6%gcc@4.8 arch=linux-ubuntu14-x86_64 \r\n                                ^m4@1.4.18%gcc@4.8+sigsegv arch=linux-ubuntu14-x86_64 \r\n                                    ^libsigsegv@2.11%gcc@4.8 arch=linux-ubuntu14-x86_64 \r\n                            ^util-macros@1.19.1%gcc@4.8 arch=linux-ubuntu14-x86_64 \r\n                        ^libxml2@2.9.4%gcc@4.8~python arch=linux-ubuntu14-x86_64 \r\n                            ^xz@5.2.3%gcc@4.8 arch=linux-ubuntu14-x86_64 \r\n        ^fftw@3.3.6-pl2%gcc@4.8+double+float+long_double~mpi~openmp~pfft_patches~quad arch=linux-ubuntu14-x86_64 \r\n\r\n1. \"+elpa\" conflicts with \"espresso~mpi\" [elpa is a parallel library and needs MPI support]\r\n2. \"+scalapack\" conflicts with \"espresso~mpi\" [scalapack is a parallel library and needs MPI support]\r\n```\r\nwhile in `develop` it looks like:\r\n```console\r\n$ spack spec espresso+scalapack~mpi\r\nInput spec\r\n--------------------------------\r\nespresso~mpi+scalapack\r\n\r\nNormalized\r\n--------------------------------\r\nespresso~mpi+scalapack\r\n    ^blas\r\n    ^fftw~mpi\r\n    ^lapack\r\n\r\nConcretized\r\n--------------------------------\r\n==> Error: Conflicts in concretized spec \"espresso@6.1.0%gcc@4.8+elpa~hdf5~mpi~openmp+scalapack arch=linux-ubuntu14-x86_64 /bzaylez\"\r\n\r\nList of matching conflicts:\r\n\r\n1. \"+elpa\" conflicts with \"espresso~mpi\" in spec \"espresso@6.1.0%gcc@4.8+elpa~hdf5~mpi~openmp+scalapack arch=linux-ubuntu14-x86_64 ^cmake@3.9.0%gcc@4.8~doc+ncurses+openssl+ownlibs~qt arch=linux-ubuntu14-x86_64 ^elpa@2016.05.004%gcc@4.8~openmp arch=linux-ubuntu14-x86_64 ^fftw@3.3.6-pl2%gcc@4.8+double+float+long_double~mpi~openmp~pfft_patches~quad arch=linux-ubuntu14-x86_64 ^hwloc@1.11.7%gcc@4.8~cuda+libxml2+pci arch=linux-ubuntu14-x86_64 ^libpciaccess@0.13.5%gcc@4.8 arch=linux-ubuntu14-x86_64 ^libsigsegv@2.11%gcc@4.8 arch=linux-ubuntu14-x86_64 ^libtool@2.4.6%gcc@4.8 arch=linux-ubuntu14-x86_64 ^libxml2@2.9.4%gcc@4.8~python arch=linux-ubuntu14-x86_64 ^m4@1.4.18%gcc@4.8+sigsegv arch=linux-ubuntu14-x86_64 ^ncurses@6.0%gcc@4.8~symlinks arch=linux-ubuntu14-x86_64 ^netlib-scalapack@2.0.2%gcc@4.8 build_type=RelWithDebInfo ~pic+shared arch=linux-ubuntu14-x86_64 ^openblas@0.2.20%gcc@4.8~openmp+pic+shared arch=linux-ubuntu14-x86_64 ^openmpi@2.1.1%gcc@4.8~cuda fabrics= ~java schedulers= ~sqlite3~thread_multiple+vt arch=linux-ubuntu14-x86_64 ^openssl@1.0.2k%gcc@4.8 arch=linux-ubuntu14-x86_64 ^pkg-config@0.29.2%gcc@4.8+internal_glib arch=linux-ubuntu14-x86_64 ^util-macros@1.19.1%gcc@4.8 arch=linux-ubuntu14-x86_64 ^xz@5.2.3%gcc@4.8 arch=linux-ubuntu14-x86_64 ^zlib@1.2.11%gcc@4.8+pic+shared arch=linux-ubuntu14-x86_64\"\r\n2. \"+scalapack\" conflicts with \"espresso~mpi\" in spec \"espresso@6.1.0%gcc@4.8+elpa~hdf5~mpi~openmp+scalapack arch=linux-ubuntu14-x86_64 ^cmake@3.9.0%gcc@4.8~doc+ncurses+openssl+ownlibs~qt arch=linux-ubuntu14-x86_64 ^elpa@2016.05.004%gcc@4.8~openmp arch=linux-ubuntu14-x86_64 ^fftw@3.3.6-pl2%gcc@4.8+double+float+long_double~mpi~openmp~pfft_patches~quad arch=linux-ubuntu14-x86_64 ^hwloc@1.11.7%gcc@4.8~cuda+libxml2+pci arch=linux-ubuntu14-x86_64 ^libpciaccess@0.13.5%gcc@4.8 arch=linux-ubuntu14-x86_64 ^libsigsegv@2.11%gcc@4.8 arch=linux-ubuntu14-x86_64 ^libtool@2.4.6%gcc@4.8 arch=linux-ubuntu14-x86_64 ^libxml2@2.9.4%gcc@4.8~python arch=linux-ubuntu14-x86_64 ^m4@1.4.18%gcc@4.8+sigsegv arch=linux-ubuntu14-x86_64 ^ncurses@6.0%gcc@4.8~symlinks arch=linux-ubuntu14-x86_64 ^netlib-scalapack@2.0.2%gcc@4.8 build_type=RelWithDebInfo ~pic+shared arch=linux-ubuntu14-x86_64 ^openblas@0.2.20%gcc@4.8~openmp+pic+shared arch=linux-ubuntu14-x86_64 ^openmpi@2.1.1%gcc@4.8~cuda fabrics= ~java schedulers= ~sqlite3~thread_multiple+vt arch=linux-ubuntu14-x86_64 ^openssl@1.0.2k%gcc@4.8 arch=linux-ubuntu14-x86_64 ^pkg-config@0.29.2%gcc@4.8+internal_glib arch=linux-ubuntu14-x86_64 ^util-macros@1.19.1%gcc@4.8 arch=linux-ubuntu14-x86_64 ^xz@5.2.3%gcc@4.8 arch=linux-ubuntu14-x86_64 ^zlib@1.2.11%gcc@4.8+pic+shared arch=linux-ubuntu14-x86_64\"\r\n```",
    "user": "alalazo",
    "url": "https://api.github.com/repos/spack/spack/issues/5083",
    "updated_at": "2017-08-21 16:20:34",
    "created_at": "2017-08-14 09:38:27",
    "closed_at": "2017-08-21 16:20:08",
    "state": "closed",
    "title": "Added custom messages for conflicts directive",
    "number": 5083,
    "milestone": null,
    "labels": [
        "feature"
    ],
    "id": 249979933,
    "html_url": "https://github.com/spack/spack/pull/5083",
    "assignees": [],
    "comments": 2
}