{
    "body": "Whenever I install any Spack package, I see the following message during installation:\r\n```console\r\n$ spack install zlib\r\n==> 1184: Installing zlib\r\n==> Finding buildcaches in /private/var/folders/21/hwq39zyj4g36x6zjfyl5l8080000gn/T/pytest-of-Adam/pytest-2/test_ci_rebuild_basic0/working_dir/local_mirror/build_cache\r\n==> Fetching file:///private/var/folders/21/hwq39zyj4g36x6zjfyl5l8080000gn/T/pytest-of-Adam/pytest-2/test_ci_rebuild_basic0/working_dir/local_mirror/build_cache/darwin-catalina-ivybridge-gcc-9.2.0-zlib-1.2.11-3svy7xryk3dwdoxzjwc6e7wpfiuixutw.spec.yaml\r\ncurl: (37) Couldn't open file /private/var/folders/21/hwq39zyj4g36x6zjfyl5l8080000gn/T/pytest-of-Adam/pytest-2/test_ci_rebuild_basic0/working_dir/local_mirror/build_cache/darwin-catalina-ivybridge-gcc-9.2.0-zlib-1.2.11-3svy7xryk3dwdoxzjwc6e7wpfiuixutw.spec.yaml\r\n==> Failed to fetch file from URL: file:///private/var/folders/21/hwq39zyj4g36x6zjfyl5l8080000gn/T/pytest-of-Adam/pytest-2/test_ci_rebuild_basic0/working_dir/local_mirror/build_cache/darwin-catalina-ivybridge-gcc-9.2.0-zlib-1.2.11-3svy7xryk3dwdoxzjwc6e7wpfiuixutw.spec.yaml\r\n    Curl failed with error 37\r\n==> Fetching from file:///private/var/folders/21/hwq39zyj4g36x6zjfyl5l8080000gn/T/pytest-of-Adam/pytest-2/test_ci_rebuild_basic0/working_dir/local_mirror/build_cache/darwin-catalina-ivybridge-gcc-9.2.0-zlib-1.2.11-3svy7xryk3dwdoxzjwc6e7wpfiuixutw.spec.yaml failed.\r\n```\r\nI'm not trying to use buildcaches, and this error message shouldn't be reported. I think this might be due to a file leftover during `spack test`.\r\n\r\n### Spack version\r\n\r\n```console\r\n$ spack --version\r\n0.14.0-149-6412b9e71a\r\n```\r\n\r\n### Steps to reproduce the issue\r\n\r\n```console\r\n$ spack install zlib\r\n```\r\nPossibly after running `spack test`, or hitting <kbd>Ctrl</kbd>+<kbd>C</kbd> during `spack test`.\r\n\r\n### Error Message\r\n\r\n```console\r\n$ spack -d install zlib\r\n...\r\n==> [2020-03-06-11:30:10.443306, 1418] 1418: Installing zlib\r\n==> [2020-03-06-11:30:10.443412, 1418] Searching for binary cache of zlib\r\n==> [2020-03-06-11:30:10.443908, 1418] Reading config file /Users/Adam/.spack/darwin/mirrors.yaml\r\n==> [2020-03-06-11:30:10.449331, 1418] Finding buildcaches in /private/var/folders/21/hwq39zyj4g36x6zjfyl5l8080000gn/T/pytest-of-Adam/pytest-2/test_ci_rebuild_basic0/working_dir/local_mirror/build_cache\r\n==> [2020-03-06-11:30:10.449720, 1418] Creating stage lock build_cache\r\n==> [2020-03-06-11:30:10.450151, 1418] WRITE LOCK (build_cache): /var/folders/21/hwq39zyj4g36x6zjfyl5l8080000gn/T/Adam/spack-stage/.lock[6733663562491073450:1] [Acquiring] \r\n==> [2020-03-06-11:30:10.450686, 1418] write locking [6733663562491073450:1]: timeout 60 sec\r\n==> [2020-03-06-11:30:10.450829, 1418] WRITE LOCK (build_cache): /var/folders/21/hwq39zyj4g36x6zjfyl5l8080000gn/T/Adam/spack-stage/.lock[6733663562491073450:1] [Acquired at 11:30:10.450783] \r\n==> [2020-03-06-11:30:10.451164, 1418] Fetching file:///private/var/folders/21/hwq39zyj4g36x6zjfyl5l8080000gn/T/pytest-of-Adam/pytest-2/test_ci_rebuild_basic0/working_dir/local_mirror/build_cache/darwin-catalina-ivybridge-gcc-9.2.0-zlib-1.2.11-3svy7xryk3dwdoxzjwc6e7wpfiuixutw.spec.yaml\r\n==> [2020-03-06-11:30:10.452477, 1418] '/Users/Adam/.spack/darwin/.spack-env/view/bin/curl' '-C' '-' '-o' '/var/folders/21/hwq39zyj4g36x6zjfyl5l8080000gn/T/Adam/spack-stage/build_cache/darwin-catalina-ivybridge-gcc-9.2.0-zlib-1.2.11-3svy7xryk3dwdoxzjwc6e7wpfiuixutw.spec.yaml.part' '-f' '-D' '-' '-L' 'file:///private/var/folders/21/hwq39zyj4g36x6zjfyl5l8080000gn/T/pytest-of-Adam/pytest-2/test_ci_rebuild_basic0/working_dir/local_mirror/build_cache/darwin-catalina-ivybridge-gcc-9.2.0-zlib-1.2.11-3svy7xryk3dwdoxzjwc6e7wpfiuixutw.spec.yaml' '-#' '--connect-timeout' '10'\r\ncurl: (37) Couldn't open file /private/var/folders/21/hwq39zyj4g36x6zjfyl5l8080000gn/T/pytest-of-Adam/pytest-2/test_ci_rebuild_basic0/working_dir/local_mirror/build_cache/darwin-catalina-ivybridge-gcc-9.2.0-zlib-1.2.11-3svy7xryk3dwdoxzjwc6e7wpfiuixutw.spec.yaml\r\n==> [2020-03-06-11:30:10.493313, 1418] Failed to fetch file from URL: file:///private/var/folders/21/hwq39zyj4g36x6zjfyl5l8080000gn/T/pytest-of-Adam/pytest-2/test_ci_rebuild_basic0/working_dir/local_mirror/build_cache/darwin-catalina-ivybridge-gcc-9.2.0-zlib-1.2.11-3svy7xryk3dwdoxzjwc6e7wpfiuixutw.spec.yaml\r\n    Curl failed with error 37\r\n==> [2020-03-06-11:30:10.493683, 1418] Fetching from file:///private/var/folders/21/hwq39zyj4g36x6zjfyl5l8080000gn/T/pytest-of-Adam/pytest-2/test_ci_rebuild_basic0/working_dir/local_mirror/build_cache/darwin-catalina-ivybridge-gcc-9.2.0-zlib-1.2.11-3svy7xryk3dwdoxzjwc6e7wpfiuixutw.spec.yaml failed.\r\n==> [2020-03-06-11:30:10.493780, 1418] FailedDownloadError: Failed to fetch file from URL: file:///private/var/folders/21/hwq39zyj4g36x6zjfyl5l8080000gn/T/pytest-of-Adam/pytest-2/test_ci_rebuild_basic0/working_dir/local_mirror/build_cache/darwin-catalina-ivybridge-gcc-9.2.0-zlib-1.2.11-3svy7xryk3dwdoxzjwc6e7wpfiuixutw.spec.yaml\r\n...\r\n```\r\n\r\n### Information on your system\r\n\r\nmacOS 10.15.3\r\n\r\n### General information\r\n\r\n- [x] I have run `spack --version` and reported the version of Spack\r\n- [x] I have searched the issues of this repo and believe this is not a duplicate\r\n- [x] I have run the failing commands in debug mode and reported the output",
    "user": "adamjstewart",
    "url": "https://api.github.com/repos/spack/spack/issues/15376",
    "updated_at": "2020-03-10 01:49:25",
    "created_at": "2020-03-06 17:38:21",
    "closed_at": "None",
    "state": "open",
    "title": "mirror configured during spack test is not cleaned up causing buildcache command to fail fetching spec.yaml file in it",
    "number": 15376,
    "milestone": null,
    "labels": [
        "bug",
        "tests",
        "error-messages",
        "impact-medium"
    ],
    "id": 577079067,
    "html_url": "https://github.com/spack/spack/issues/15376",
    "assignees": [
        "tldahlgren"
    ],
    "comments": 8
}