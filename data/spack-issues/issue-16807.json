{
    "body": "Trying to build `petsc@3.13.1` with `gcc@7.3.0` fails on all tested platforms using `spack@develop` commit id `c4031f045512` from 25-May-2020:\r\n* ubuntu 18.04 x86_64 and ppc64le\r\n* rhel7, rhel8 x86_64\r\n* centos7, centos8 x86_64\r\n\r\n```\r\n$> spack install petsc@3.13.1\r\n...\r\n6 errors found in build log:\r\n     1277              CC arch-linux-c-opt/obj/mat/impls/aij/mpi/mpimatmatmatmult.o\r\n     1278              CC arch-linux-c-opt/obj/mat/impls/aij/mpi/mpimattransposematmult.o\r\n     1279              CC arch-linux-c-opt/obj/mat/impls/aij/mpi/aijsell/mpiaijsell.o\r\n     1280              CC arch-linux-c-opt/obj/mat/impls/aij/mpi/ftn-custom/zmpiaijf.o\r\n     1281              CC arch-linux-c-opt/obj/mat/impls/aij/mpi/superlu_dist/superlu_dist.o\r\n     1282    /tmp/root/spack-stage/spack-stage-petsc-3.13.1-fwi7ts6xtrozcutiuewcp73vum2cyard/spack-src/src/mat/impls/aij/mpi/su\r\n             perlu_dist/superlu_dist.c: In function 'MatView_Info_SuperLU_DIST':\r\n  >> 1283    /tmp/root/spack-stage/spack-stage-petsc-3.13.1-fwi7ts6xtrozcutiuewcp73vum2cyard/spack-src/src/mat/impls/aij/mpi/su\r\n             perlu_dist/superlu_dist.c:435:8: error: 'LargeDiag_AWPM' undeclared (first use in this function); did you mean 'La\r\n             rgeDiag_HWPM'?\r\n     1284       case LargeDiag_AWPM:\r\n     1285            ^~~~~~~~~~~~~~\r\n     1286            LargeDiag_HWPM\r\n     1287    /tmp/root/spack-stage/spack-stage-petsc-3.13.1-fwi7ts6xtrozcutiuewcp73vum2cyard/spack-src/src/mat/impls/aij/mpi/su\r\n             perlu_dist/superlu_dist.c:435:8: note: each undeclared identifier is reported only once for each function it appea\r\n             rs in\r\n     1288    /tmp/root/spack-stage/spack-stage-petsc-3.13.1-fwi7ts6xtrozcutiuewcp73vum2cyard/spack-src/src/mat/impls/aij/mpi/su\r\n             perlu_dist/superlu_dist.c: In function 'MatGetFactor_aij_superlu_dist':\r\n  >> 1289    /tmp/root/spack-stage/spack-stage-petsc-3.13.1-fwi7ts6xtrozcutiuewcp73vum2cyard/spack-src/src/mat/impls/aij/mpi/su\r\n             perlu_dist/superlu_dist.c:582:25: error: 'LargeDiag_AWPM' undeclared (first use in this function); did you mean 'L\r\n             argeDiag_HWPM'?\r\n     1290           options.RowPerm = LargeDiag_AWPM;\r\n     1291                             ^~~~~~~~~~~~~~\r\n     1292                             LargeDiag_HWPM\r\n     1293    gmakefile:159: recipe for target 'arch-linux-c-opt/obj/mat/impls/aij/mpi/superlu_dist/superlu_dist.o' failed\r\n  >> 1294    make[3]: *** [arch-linux-c-opt/obj/mat/impls/aij/mpi/superlu_dist/superlu_dist.o] Error 1\r\n     1295    make[3]: *** Waiting for unfinished jobs....\r\n     1296              CC arch-linux-c-opt/obj/mat/impls/aij/mpi/crl/mcrl.o\r\n     1297              CC arch-linux-c-opt/obj/mat/impls/aij/mpi/aijperm/mpiaijperm.o\r\n     1298              CC arch-linux-c-opt/obj/vec/is/sf/impls/basic/sfpack.o\r\n     1299              CC arch-linux-c-opt/obj/mat/impls/aij/mpi/fdmpiaij.o\r\n     1300              CC arch-linux-c-opt/obj/mat/impls/aij/mpi/ftn-auto/mpiaijf.o\r\n\r\n     ...\r\n\r\n     1306              CC arch-linux-c-opt/obj/mat/impls/shell/shell.o\r\n     1307              CC arch-linux-c-opt/obj/mat/impls/aij/mpi/mpimatmatmult.o\r\n     1308              CC arch-linux-c-opt/obj/mat/impls/aij/mpi/mpiptap.o\r\n     1309              CC arch-linux-c-opt/obj/mat/impls/aij/mpi/mpiaij.o\r\n     1310              FC arch-linux-c-opt/obj/vec/f90-mod/petscvecmod.o\r\n     1311    /tmp/root/spack-stage/spack-stage-petsc-3.13.1-fwi7ts6xtrozcutiuewcp73vum2cyard/spack-src/lib/petsc/conf/rules:49:\r\n              recipe for target 'libs' failed\r\n  >> 1312    make[2]: *** [libs] Error 2\r\n     1313    **************************ERROR*************************************\r\n     1314      Error during compile, check arch-linux-c-opt/lib/petsc/conf/make.log\r\n     1315      Send it and arch-linux-c-opt/lib/petsc/conf/configure.log to petsc-maint@mcs.anl.gov\r\n     1316    ********************************************************************\r\n     1317    makefile:33: recipe for target 'all' failed\r\n  >> 1318    make[1]: *** [all] Error 1\r\n     1319    GNUmakefile:9: recipe for target 'all' failed\r\n  >> 1320    make: *** [all] Error 2\r\n```\r\n\r\nFull build log: [petsc-build-out.txt](https://github.com/spack/spack/files/4678146/petsc-build-out.txt)\r\n\r\nI suspect this is due to a commit to Spack within past couple of weeks because I had been building it regularly, without error, in the same way, on all the platforms listed above.\r\n\r\n@balay @s-sajid-ali @js947 \r\n",
    "user": "eugeneswalker",
    "url": "https://api.github.com/repos/spack/spack/issues/16807",
    "updated_at": "2021-04-29 17:04:35",
    "created_at": "2020-05-25 16:43:08",
    "closed_at": "2021-04-29 17:04:34",
    "state": "closed",
    "title": "Installation issue: petsc build fails on all platforms",
    "number": 16807,
    "milestone": null,
    "labels": [
        "build-error"
    ],
    "id": 624397744,
    "html_url": "https://github.com/spack/spack/issues/16807",
    "assignees": [],
    "comments": 13
}