{
    "body": "Hi all,\r\n\r\nI'm trying to add a new package, cbtf-argonavis-gui, which requires a qmake line that creates the Makefile.  The code in def install currently looks like this:\r\n```python\r\n    def install(self, spec, prefix):\r\n        options = ['-o Makefile openss-gui.pro']\r\n        qmake = which('qmake')\r\n        qmake(*options)\r\n        #qmake('-o Makefile openss-gui.pro')\r\n        make()\r\n        make(\"install\")\r\n```\r\n\r\nWhen ever I try to build, it appears that qmake doesn't think there is an option -o Makefile openss-gui.pro.   However, I can do that command outside of spack.   So, I'm wondering if anyone can spot what I'm doing wrong.   Here is the output from spack:\r\n```\r\n==> Error: ProcessError: Command exited with status 1:\r\n    '/home/jeg/spack/opt/spack/linux-fedora19-x86_64/gcc-4.8.3/qt-5.9.1-jqgklthpzv3yktdnjftatzwaibs4vazx/bin/qmake' '-o Makefile openss-gui.pro'\r\n/home/jeg/spack/var/spack/repos/builtin/packages/cbtf-argonavis-gui/package.py:93, in install:\r\n     89       def install(self, spec, prefix):\r\n     90   \r\n     91           options = ['-o Makefile openss-gui.pro']\r\n     92           qmake = which('qmake')\r\n  >> 93           qmake(*options)\r\n     94           #qmake('-o Makefile openss-gui.pro')\r\n     95           make()\r\n     96           make(\"install\")\r\n\r\nSee build log for details:\r\n  /tmp/jeg/spack-stage/spack-stage-3Garsy/cbtf-argonavis-gui/spack-build.out\r\n[jeg@localhost packages]$ cat /tmp/jeg/spack-stage/spack-stage-3Garsy/cbtf-argonavis-gui/spack-build.out\r\n==> '/home/jeg/spack/opt/spack/linux-fedora19-x86_64/gcc-4.8.3/qt-5.9.1-jqgklthpzv3yktdnjftatzwaibs4vazx/bin/qmake' '-o Makefile openss-gui.pro'\r\n*****Unknown option -o Makefile openss-gui.pro**\r\nUsage: /home/jeg/spack/opt/spack/linux-fedora19-x86_64/gcc-4.8.3/qt-5.9.1-jqgklthpzv3yktdnjftatzwaibs4vazx/bin/qmake [mode] [options] [files]\r\n```\r\n\r\nThis is my full cbtf-argonavis-gui/package.py file:\r\n```python\r\n[jeg@localhost packages]$ cat cbtf-argonavis-gui/package.py\r\n<header text removed>\r\nfrom spack import *\r\nclass CbtfArgonavisGui(Package):\r\n    \"\"\"CBTF Argo Navis GUI project contains the GUI that views CUDA performance\r\n       information.\r\n\r\n    \"\"\"\r\n    homepage = \"http://sourceforge.net/p/cbtf/wiki/Home/\"\r\n    # Mirror access template example\r\n    url = \"file:/home/jeg/cbtf-argonavis-gui-0.8.1.tar.gz\"\r\n    version('0.8.1', '9bdbffcc9259875bca80e2bc3a660cc7')\r\n    #version('0.8.1', branch='master',\r\n    #        git='https://github.com/OpenSpeedShop/cbtf-argonavis-gui.git')\r\n\r\n    depends_on(\"cmake@3.0.2\", type='build')\r\n    depends_on(\"openspeedshop+noqt3gui\")\r\n    depends_on('qt@4.8.6:')\r\n    depends_on(\"boost@1.50.0:1.59.0\")\r\n    depends_on(\"cbtf\")\r\n    depends_on(\"cbtf-krell\")\r\n    depends_on(\"cbtf-argonavis\")\r\n    depends_on(\"cuda\")\r\n    depends_on(\"mrnet@5.0.1:+lwthreads\", when='+cbtf')\r\n    depends_on(\"xerces-c@3.1.1:\")\r\n    depends_on(\"graphviz\")\r\n    depends_on(\"QtGraph\")\r\n    parallel = False\r\n\r\n    def setup_environment(self, spack_env, run_env):\r\n        \"\"\"Set up the compile and runtime environments for a package.\"\"\"\r\n        spack_env.set('BOOSTROOT', self.spec['boost'].prefix)\r\n        spack_env.set('CBTF_ROOT', self.spec['cbtf'].prefix)\r\n        spack_env.set('CBTF_KRELL_ROOT', self.spec['cbtf-krell'].prefix)\r\n        spack_env.set('CBTF_ARGONAVIS_ROOT', self.spec['cbtf-argonavis'].prefix)\r\n        spack_env.set('OSS_CBTF_ROOT', self.spec['openspeedshop'].prefix)\r\n        spack_env.set('GRAPHVIZ_ROOT', self.spec['graphviz'].prefix)\r\n        spack_env.set('QTGRAPHLIB_ROOT', self.spec['QtGraph'].prefix)\r\n        spack_env.set('KRELL_ROOT_MRNET', self.spec['mrnet'].prefix)\r\n        spack_env.set('KRELL_ROOT_XERCES', self.spec['xerces-c'].prefix)\r\n        #spack_env.set('QTDIR', self.spec['qt'].prefix)\r\n\r\n    def install(self, spec, prefix):\r\n        options = ['-o Makefile openss-gui.pro']\r\n        qmake = which('qmake')\r\n        qmake(*options)\r\n        #qmake('-o Makefile openss-gui.pro')\r\n        make()\r\n        make(\"install\")\r\n```",
    "user": "jgalarowicz",
    "url": "https://api.github.com/repos/spack/spack/issues/4745",
    "updated_at": "2017-07-13 13:45:37",
    "created_at": "2017-07-12 22:26:02",
    "closed_at": "2017-07-13 13:42:23",
    "state": "closed",
    "title": "Question about how to specify arguments to qmake in spack",
    "number": 4745,
    "milestone": null,
    "labels": [
        "question"
    ],
    "id": 242533951,
    "html_url": "https://github.com/spack/spack/issues/4745",
    "assignees": [],
    "comments": 2
}