{
    "body": "### Steps to reproduce the issue\r\n\r\n```console\r\n$ spack install hunspell\r\n==> Executing phase: 'autoreconf'\r\n==> [2019-08-08-14:30:07.109776] Warning: *********************************************************\r\n==> [2019-08-08-14:30:07.110472] Warning: * If the default procedure fails, consider implementing *\r\n==> [2019-08-08-14:30:07.111416] Warning: *        a custom AUTORECONF phase in the package       *\r\n==> [2019-08-08-14:30:07.112193] Warning: *********************************************************\r\n==> [2019-08-08-14:30:07.113555] '/usr/local/opt/libtool/bin/libtoolize'\r\n==> [2019-08-08-14:30:07.108623] Configure script not found: trying to generate it\r\n```\r\n\r\n### Platform and user environment\r\n\r\nPlease report your OS here:\r\n```commandline\r\n$ uname -a \r\nLinux nuvolari 4.15.0-29-generic #31-Ubuntu SMP Tue Jul 17 15:39:52 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux\r\n$ lsb_release -d\r\nDescription:\tUbuntu 18.04.1 LTS\r\n``` \r\nand, if relevant, post or attach:\r\n\r\n- `packages.yaml`:\r\n\r\n```yaml\r\npackages:\r\n  autoconf:\r\n    paths:\r\n      autoconf@2.69 %clang@10.0.1-apple: /usr/local/opt/autoconf\r\n  automake:\r\n    paths:\r\n      automake@1.16.1 %clang@10.0.1-apple: /usr/local/opt/automake\r\n  libtool:\r\n    paths:\r\n      libtool@2.4.6 %clang@10.0.1-apple: /usr/local/opt/libtool\r\n  m4:\r\n    paths:\r\n      m4@1.4.18 %clang@10.0.1-apple: /usr/local/opt/m4\r\n```\r\n\r\n### Additional information\r\n\r\nI'm fairly confident the issue here is due to https://github.com/spack/spack/blob/3bd854f991305abaa54d8b7f4ab804aac80ae7b4/lib/spack/spack/build_systems/autotools.py#L196, which seems to call `libtoolize` explicitly via `spec['libtool'].prefix.bin.join('libtoolize')`.\r\n\r\nThe `packages.yaml` configuration above uses a Homebrew installation of libtool prefixed at `/usr/local/opt/libtool`. Homebrew installs the `libtoolize` executable using the name `glibtoolize` instead, to avoid conflicting with BSD libtool on some versions of macOS. So, on my system, `spec['libtool'].prefix.bin.join('libtoolize')`resolves to `/usr/local/opt/libtool/bin/libtoolize`, which doesn't exist on my system. Any Spack user on macOS who installs `libtool` via Homebrew and adds that `libtool` installation to one of their `packages.yaml` files will encounter this issue. However, executing `autoreconf` invokes `glibtoolize` on my system, as it is supposed to. I'll note here the irony here of the well-intentioned comment at https://github.com/spack/spack/blob/3bd854f991305abaa54d8b7f4ab804aac80ae7b4/lib/spack/spack/build_systems/autotools.py#L194, just above this `libtoolize` invocation: \"This part should be redundant in principle, but won't hurt\".\r\n\r\nBelow the `libtoolize` call, there is also a call to `aclocal`, which is now considered bad practice because GNU Automake is deprecating `aclocal`; see https://www.gnu.org/software/automake/manual/automake.html#Future-of-aclocal. The GNU Automake maintainers recommend calling `autoreconf` instead.\r\n\r\nWhile the Spack error message recommends writing a custom `autoreconf` phase for this package, the implementation would be\r\n\r\n```python\r\n def autoreconf(self, spec, prefix):\r\n        autoreconf = which('autoreconf')\r\n        autoreconf('-fiv')\r\n```\r\n\r\nwhich seems, well, silly -- the default implementation is already calling `autoreconf` plus additional arguments, and should work just fine. So I'll be filing a PR to change the Autotools base package instead.",
    "user": "goxberry",
    "url": "https://api.github.com/repos/spack/spack/issues/12343",
    "updated_at": "2019-08-28 01:03:57",
    "created_at": "2019-08-08 22:08:52",
    "closed_at": "2019-08-28 01:03:57",
    "state": "closed",
    "title": "Installation issue: hunspell: autoreconf uses 'libtoolize' instead of 'glibtoolize' on macOS 10.14.6",
    "number": 12343,
    "milestone": null,
    "labels": [
        "build-error"
    ],
    "id": 478709324,
    "html_url": "https://github.com/spack/spack/issues/12343",
    "assignees": [],
    "comments": 1
}