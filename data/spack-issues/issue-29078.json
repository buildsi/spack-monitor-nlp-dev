{
    "body": "### Steps to reproduce the issue\r\n\r\n```console\r\n$ spack load intel-oneapi-compilers\r\n$ spack install fenics %gcc@9.3.1 arch=linux-centos7-x86_64 ^intel-oneapi-mkl ^openmpi+pmi+lustre schedulers=slurm ^slurm\r\n```\r\n\r\n\r\n### Error message\r\n\r\n<details><summary>Error message</summary><pre>\r\n==> Installing fenics-2019.1.0.post0-5vtmz2psdiclmp2epsdra5xkp5uovjls\r\n==> No binary for fenics-2019.1.0.post0-5vtmz2psdiclmp2epsdra5xkp5uovjls found: installing from source\r\n==> Using cached archive: /share/softs/spack/var/spack/cache/_source-cache/archive/61/61abdcdb13684ba2a3ba4afb7ea6c7907aa0896a46439d3af7e8848483d4392f.tar.gz\r\n==> Using cached archive: /share/softs/spack/var/spack/cache/_source-cache/archive/1c/1cc69e612df18feb5ebdc78cd902cfefda5ffc077735f0b67a1dcb1bf82e63c9\r\n==> Applied patch /share/softs/spack/var/spack/repos/builtin/packages/fenics/header_fix.patch\r\n==> Applied patch https://bitbucket.org/fenics-project/dolfin/issues/attachments/1116/fenics-project/dolfin/1602778118.04/1116/0001-Use-__BYTE_ORDER__-instead-of-removed-Boost-endian.h.patch\r\n==> fenics: Executing phase: 'cmake'\r\n==> Error: ProcessError: Command exited with status 1:\r\n    'cmake' '-G' 'Unix Makefiles' '-DCMAKE_INSTALL_PREFIX:STRING=/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/fenics-2019.1.0.post0-5vtmz2psdiclmp2epsdra5xkp5uovjls' '-DCMAKE_BUILD_TYPE:STRING=RelWithDebInfo' '-DCMAKE_INTERPROCEDURAL_OPTIMIZATION:BOOL=OFF' '-DCMAKE_VERBOSE_MAKEFILE:BOOL=ON' '-DCMAKE_INSTALL_RPATH_USE_LINK_PATH:BOOL=OFF' '-DCMAKE_INSTALL_RPATH:STRING=/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/fenics-2019.1.0.post0-5vtmz2psdiclmp2epsdra5xkp5uovjls/lib;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/fenics-2019.1.0.post0-5vtmz2psdiclmp2epsdra5xkp5uovjls/lib64;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/boost-1.78.0-nx5s6z3p34gpv64vvuqp7swnwfdntaut/lib;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/bzip2-1.0.8-xkjzrde3nkbooc2bzmnrmilmpzzgwej7/lib;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/zlib-1.2.11-gvgxby5bzvibxg3erswwk2ls3k2bk75v/lib;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/hdf5-1.12.1-w3eutpmeayuw7wy6jkr65wfc3ckx57tl/lib;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/numactl-2.0.14-a2tvh3s4yi4ec64wd2j2ccb7547tyv5t/lib;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/openmpi-4.1.2-go7cpollb6yqtli4ls7ekepld27gjmrn/lib;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/hwloc-2.7.0-j6o3zkke3wl3h7t6i7omhvgcev64mmgp/lib;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/libpciaccess-0.16-osqdkhx5i75d4wi5guguzo7msxpqprop/lib;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/libxml2-2.9.12-bapprct5umimszcz2e6wfkvdy242e3dq/lib;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/libiconv-1.16-kx3s445aw7gaqwohly2djwiixkjfsaax/lib;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/xz-5.2.5-46j2h52uc5tqsgpzcanhgxoa5pk4uxt6/lib;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/ncurses-6.2-64i65cdjfp6fky5q5ukitjouhmindatw/lib;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/libevent-2.1.12-x4lcbp6ww4u6fcdvbpztsqrjyg7hssrd/lib;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/openssl-1.1.1m-z7okbgpcphduxboe7us35omeamkqrgjw/lib;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/metis-5.1.0-bl5gkhkoomzpmb2ur4hazkgobzudztvv/lib;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/parmetis-4.0.3-qsnjbklcjlksbasstjz45f5l5mm6ckqb/lib;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/petsc-3.16.4-4f5q4tng4uuo3zuyzzjozeefdihdhomk/lib;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/hypre-2.24.0-4v5vulzit2yukgwysg6widj4tlgwf5za/lib;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/superlu-dist-7.2.0-2oyajbxiln7dhk3xonjexo4qyr7hjabo/lib;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/py-petsc4py-3.16.4-h4kqga2vjq2tynvu7cvxq2eqs3ye4sg5/lib;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/scotch-6.1.1-3f36y4c3sjav7yjp5q4bdapn4mwampqt/lib;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/slepc-3.16.2-tvqtn5jiytna6vvmn3ss3ssivzfmutrk/lib;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/suite-sparse-5.10.1-e35nsnrhal65ddrxqwwoaea24zyby4it/lib;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/gmp-6.2.1-odjxqmw3gj2kvfbgv2eqq2g674c5jzua/lib;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/mpfr-4.1.0-lwenoyerouv2kltxpcghysuoide2q742/lib;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/arpack-ng-3.8.0-veiekuubj36n2qc4ff6ps53pbl2gwq4f/lib64' '-DCMAKE_PREFIX_PATH:STRING=/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/suite-sparse-5.10.1-e35nsnrhal65ddrxqwwoaea24zyby4it;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/mpfr-4.1.0-lwenoyerouv2kltxpcghysuoide2q742;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/gmp-6.2.1-odjxqmw3gj2kvfbgv2eqq2g674c5jzua;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/slepc-3.16.2-tvqtn5jiytna6vvmn3ss3ssivzfmutrk;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/arpack-ng-3.8.0-veiekuubj36n2qc4ff6ps53pbl2gwq4f;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/scotch-6.1.1-3f36y4c3sjav7yjp5q4bdapn4mwampqt;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/py-pybind11-2.2.4-pwv5u25fbzwnmvkn4viynm2nnegvyrvb;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/py-pkgconfig-1.5.5-ccnf5unkkd5r4ewq6gl7xtvwmq5gfqru;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/py-petsc4py-3.16.4-h4kqga2vjq2tynvu7cvxq2eqs3ye4sg5;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/py-fenics-ffc-2019.1.0.post0-fnkbzdlnlou5zsbwxm7wh75rzlefolmn;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/py-fenics-ufl-2019.1.0-5nm5ydkiodi6sjk75vpaoltnmy7a3wzz;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/py-fenics-fiat-2019.1.0-pohtai2efr625ace3fj6rq4eey3xbdmd;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/py-fenics-dijitso-2019.1.0-3qdlfvvjnqenlmiydrbns4cone4e3ehv;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/py-setuptools-59.4.0-br4kpjswcrzifcoaggtxuzdzkvcycpxc;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/py-wheel-0.37.0-flwy53hetxav6vvmgd6knufrnnl4fmqz;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/py-pip-21.3.1-mezcopyowqasct55uo5vfzwmmch2dxwx;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/petsc-3.16.4-4f5q4tng4uuo3zuyzzjozeefdihdhomk;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/superlu-dist-7.2.0-2oyajbxiln7dhk3xonjexo4qyr7hjabo;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/python-3.9.10-7pzex3625orgu3geo5svghldylapzhev;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/hypre-2.24.0-4v5vulzit2yukgwysg6widj4tlgwf5za;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/intel-oneapi-mkl-2022.0.2-txiyhh5apoln77jpnfp7kxy26ncsohbs;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/intel-oneapi-tbb-2021.5.1-3gpnjog6motx362c5pugk4grlua7onac;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/parmetis-4.0.3-qsnjbklcjlksbasstjz45f5l5mm6ckqb;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/metis-5.1.0-bl5gkhkoomzpmb2ur4hazkgobzudztvv;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/hdf5-1.12.1-w3eutpmeayuw7wy6jkr65wfc3ckx57tl;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/openmpi-4.1.2-go7cpollb6yqtli4ls7ekepld27gjmrn;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/libevent-2.1.12-x4lcbp6ww4u6fcdvbpztsqrjyg7hssrd;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/hwloc-2.7.0-j6o3zkke3wl3h7t6i7omhvgcev64mmgp;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/libxml2-2.9.12-bapprct5umimszcz2e6wfkvdy242e3dq;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/xz-5.2.5-46j2h52uc5tqsgpzcanhgxoa5pk4uxt6;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/libpciaccess-0.16-osqdkhx5i75d4wi5guguzo7msxpqprop;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/numactl-2.0.14-a2tvh3s4yi4ec64wd2j2ccb7547tyv5t;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/eigen-3.4.0-epv7qu4jc4b7hplmkl7iyc5cgmzyz3fy;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/cmake-3.22.2-h4shd63a6q3i4t5sny6vmlda347cuee3;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/openssl-1.1.1m-z7okbgpcphduxboe7us35omeamkqrgjw;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/ncurses-6.2-64i65cdjfp6fky5q5ukitjouhmindatw;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/pkgconf-1.8.0-qykyaubgwcm2wfbodf3v7sjanlomozve;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/boost-1.78.0-nx5s6z3p34gpv64vvuqp7swnwfdntaut;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/zlib-1.2.11-gvgxby5bzvibxg3erswwk2ls3k2bk75v;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/bzip2-1.0.8-xkjzrde3nkbooc2bzmnrmilmpzzgwej7;/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/libiconv-1.16-kx3s445aw7gaqwohly2djwiixkjfsaax' '-DBUILD_SHARED_LIBS:BOOL=ON' '-DDOLFIN_SKIP_BUILD_TESTS:BOOL=ON' '-DDOLFIN_ENABLE_OPENMP:BOOL=ON' '-DDOLFIN_ENABLE_CHOLMOD:BOOL=ON' '-DDOLFIN_ENABLE_HDF5:BOOL=ON' '-DHDF5_NO_FIND_PACKAGE_CONFIG_FILE:BOOL=ON' '-DDOLFIN_ENABLE_MPI:BOOL=ON' '-DDOLFIN_ENABLE_PARMETIS:BOOL=ON' '-DDOLFIN_ENABLE_PETSC:BOOL=ON' '-DDOLFIN_ENABLE_PETSC4PY:BOOL=ON' '-DDOLFIN_ENABLE_PYTHON:BOOL=ON' '-DDOLFIN_ENABLE_QT:BOOL=OFF' '-DDOLFIN_ENABLE_SCOTCH:BOOL=ON' '-DDOLFIN_ENABLE_SLEPC:BOOL=ON' '-DDOLFIN_ENABLE_SLEPC4PY:BOOL=ON' '-DDOLFIN_ENABLE_DOCS:BOOL=OFF' '-DDOLFIN_ENABLE_SPHINX:BOOL=OFF' '-DDOLFIN_ENABLE_TRILINOS:BOOL=OFF' '-DDOLFIN_ENABLE_UMFPACK:BOOL=ON' '-DDOLFIN_ENABLE_VTK:BOOL=OFF' '-DDOLFIN_ENABLE_ZLIB:BOOL=OFF' '-DPYTHON_EXECUTABLE:STRING=/share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/python-3.9.10-7pzex3625orgu3geo5svghldylapzhev/bin/python3.9' '/tmp/root/spack-stage/spack-stage-fenics-2019.1.0.post0-5vtmz2psdiclmp2epsdra5xkp5uovjls/spack-src'\r\n\r\n1 error found in build log:\r\n     165    extract written to /tmp/root/spack-stage/spack-stage-fenics-2019.1.0.post0-5vtmz2psdiclmp2epsdra5xkp5uovjls/spack-src/demo/documented/nonmatching-interpolation/cpp/main.cpp\r\n     166    extract written to /tmp/root/spack-stage/spack-stage-fenics-2019.1.0.post0-5vtmz2psdiclmp2epsdra5xkp5uovjls/spack-src/demo/documented/poisson/cpp/Poisson.ufl\r\n     167    extract written to /tmp/root/spack-stage/spack-stage-fenics-2019.1.0.post0-5vtmz2psdiclmp2epsdra5xkp5uovjls/spack-src/demo/documented/poisson/cpp/main.cpp\r\n     168    --\r\n     169    -- Generating form files in demo, test and bench directories. May take some time...\r\n     170    -- ----------------------------------------------------------------------------------------\r\n  >> 171    CMake Error at CMakeLists.txt:626 (message):\r\n     172      Generation of form files failed:\r\n     173    \r\n     174      Compiling 2 forms in demo/undocumented/advection-diffusion/cpp...\r\n     175    \r\n     176      ffc -l dolfin -s -O -r auto AdvectionDiffusion.ufl\r\n     177    \r\n\r\nSee build log for details:\r\n  /tmp/root/spack-stage/spack-stage-fenics-2019.1.0.post0-5vtmz2psdiclmp2epsdra5xkp5uovjls/spack-build-out.txt\r\n\r\n</pre></details>\r\n\r\n<details><summary>Extract of spack-build-out.txt</summary><pre>\r\n... \r\n /share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/python-3.9.10-7pzex3625orgu3geo5svghldylapzhev/bin/python3.9:\r\n  symbol lookup error:\r\n  /share/softs/spack/opt/spack/linux-centos7-x86_64/gcc-9.3.1/intel-oneapi-mkl-2022.0.2-txiyhh5apoln77jpnfp7kxy26ncsohbs/mkl/2022.0.2/lib/intel64/libmkl_intel_thread.so.2:\r\n  undefined symbol: omp_get_num_procs\r\n\r\n\r\n\r\n-- Configuring incomplete, errors occurred!\r\n\r\n</pre></details>\r\n\r\n### Information on your system\r\n\r\n* CentOS Linux release 7.9.2009 (Core)\r\n* Architecture: x86_64\r\n\r\n* **Spack:** 0.17.1-1164-cab0e4cb24\r\n* **Python:** 3.6.8\r\n* **Platform:** linux-centos7-skylake_avx512\r\n* **Concretizer:** clingo\r\n\r\n_Packages.yaml_\r\n`packages:\r\n  lustre:\r\n    externals:\r\n    - spec: lustre@2.12.6_ddn58\r\n      prefix: /usr\r\n  openmpi:\r\n    externals:\r\n    - spec: \"openmpi@4.1.2%gcc@4.8.5+pmi+lustre schedulers=slurm\"\r\n      prefix: /share/softs/mpi/openmpi-4.1.2\r\n  slurm:\r\n    externals:\r\n    - spec: slurm@21.08.5\r\n      prefix: /usr\r\n  all:\r\n    compiler: [gcc, intel, pgi, clang, xl, nag, fj, aocc]\r\n    providers:\r\n      D: [ldc]\r\n      awk: [gawk]\r\n      blas: [intel-oneapi-mkl, openblas, amdblis]\r\n      daal: [intel-oneapi-daal]\r\n      elf: [elfutils]\r\n      fftw-api: [fftw, amdfftw]\r\n      gl: [mesa+opengl, mesa18, opengl]\r\n      glx: [mesa+glx, mesa18+glx, opengl]\r\n      glu: [mesa-glu, openglu]\r\n      golang: [gcc]\r\n      iconv: [libiconv]\r\n      ipp: [intel-oneapi-ipp]\r\n      java: [openjdk, jdk, ibm-java]\r\n      jpeg: [libjpeg-turbo, libjpeg]\r\n      lapack: [intel-oneapi-mkl, openblas, amdlibflame]\r\n      mariadb-client: [mariadb-c-client, mariadb]\r\n      mkl: [intel-oneapi-mkl]\r\n      mpe: [mpe2]\r\n      mpi: [openmpi, intel-oneapi-mpi]\r\n      mysql-client: [mysql, mariadb-c-client]\r\n      opencl: [pocl]\r\n      osmesa: [mesa+osmesa, mesa18+osmesa]\r\n      pil: [py-pillow]\r\n      pkgconfig: [pkgconf, pkg-config]\r\n      rpc: [libtirpc]\r\n      scalapack: [intel-oneapi-mkl, netlib-scalapack, amdscalapack]\r\n      sycl: [hipsycl]\r\n      szip: [libszip, libaec]\r\n      tbb: [intel-oneapi-tbb]\r\n      unwind: [libunwind]\r\n      yacc: [bison, byacc]\r\n      flame: [libflame, amdlibflame]\r\n      uuid: [util-linux-uuid, libuuid]\r\n      ziglang: [zig]\r\n    permissions:\r\n      read: world\r\n      write: user\r\n`\r\n\r\n### Additional information\r\n\r\n[spack-build-env.txt](https://github.com/spack/spack/files/8098781/spack-build-env.txt)\r\n[spack-build-out.txt](https://github.com/spack/spack/files/8098783/spack-build-out.txt)\r\n\r\n\r\n### General information\r\n\r\n- [X] I have run `spack debug report` and reported the version of Spack/Python/Platform\r\n- [X] I have run `spack maintainers <name-of-the-package>` and **@mentioned** any maintainers\r\n- [x] I have uploaded the build log and environment files\r\n- [X] I have searched the issues of this repo and believe this is not a duplicate",
    "user": "VirtualEmbryo",
    "url": "https://api.github.com/repos/spack/spack/issues/29078",
    "updated_at": "2022-02-18 16:44:45",
    "created_at": "2022-02-18 16:37:59",
    "closed_at": "None",
    "state": "open",
    "title": "Installation issue: fenics - libmkl_intel_thread.so.2:   undefined symbol: omp_get_num_procs",
    "number": 29078,
    "milestone": null,
    "labels": [
        "build-error"
    ],
    "id": 1143374258,
    "html_url": "https://github.com/spack/spack/issues/29078",
    "assignees": [],
    "comments": 0
}